{"createdAt":"2025-09-29T17:51:40.425Z","updatedAt":"2025-09-29T19:54:30.076Z","id":"NQxCZfZhS4DtZDSe","name":"Backup - GitHub","active":false,"isArchived":false,"nodes":[{"parameters":{"content":"## Define e formata data/hora\nEsses nós são responsáveis por definir a data e hora atuais no formato dd-MM-yyyy/H:mm. A data e a hora são usadas para compor as mensagens de commit no GitHub, por exemplo: backup-12-07-2023/14:18.","height":288,"width":608,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2112,176],"id":"f9bcb2fb-0b44-40ce-ae27-ea70b4e63ef3","name":"Sticky Note"},{"parameters":{"options":{}},"id":"ec595d8c-7ba4-46e8-ab78-08d0a04c49ae","name":"Seta data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-2048,320]},{"parameters":{"operation":"formatDate","date":"={{ $json.currentDate }}","format":"custom","customFormat":"dd-MM-yyyy/H:mm","options":{}},"id":"490bf65e-2ea7-4a19-8025-6850d927c14c","name":"Formata a data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1856,320]},{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"commitDate","value":"={{ $json.formattedDate }}"}]},"options":{}},"id":"54a9021e-cceb-4390-a025-45ce857d42db","name":"Seta a data de commit","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1648,320]},{"parameters":{"content":"## Fazer uma lista de arquivos existentes\nRetorna uma lista de arquivos existentes (backups) no repositório do GitHub. Os dados retornados por esses nós são usados pelo nó \"IF\" (mais adiante no fluxo) para verificar se os arquivos de backup devem ser criados ou atualizados.","height":288,"width":592,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-1440,176],"typeVersion":1,"id":"c8f4f5a7-f7e3-420b-9662-847e584e7c04","name":"Sticky Note1"},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"list","owner":{"__rl":true,"value":"={{ $('Infos Básicas').item.json.owner }}","mode":"name"},"repository":{"__rl":true,"value":"={{ $('Infos Básicas').item.json.repository }}","mode":"name"}},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[-1328,320],"id":"219a709a-b996-4bf3-a8d1-61b5f79dcc3e","name":"Lista de arquivos","webhookId":"a6d49a05-5928-4d3c-80d2-93a2a896490f","credentials":{"githubOAuth2Api":{"id":"260nE6yM2M6aN3IA","name":"GitHub - Taysa"}}},{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-2448,320],"id":"5669d402-6a3c-4e94-a945-2bf539d9f978","name":"Schedule Trigger"},{"parameters":{"content":"## Recuperar workflows\nObtém todos os workflows da sua instância do n8n.\n","height":288,"width":544},"type":"n8n-nodes-base.stickyNote","position":[-816,176],"typeVersion":1,"id":"98096f56-c3c5-4221-8f8f-56f52b2e91de","name":"Sticky Note2"},{"parameters":{"filters":{},"requestOptions":{}},"id":"9ac9ab4e-1b50-40d5-86b4-873ebea80725","name":"Recupera Workflows - N8N","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[-736,-96],"credentials":{"n8nApi":{"id":"y6IXIPdy2mck9iD2","name":"n8n account"}}},{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"}},"id":"ce9a6c88-2f58-4c6d-bfe2-9af84f447533","name":"Converte JSON para Binário","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[-512,320]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b1b3a3d2-e66f-46d5-bee4-9d3094ca7796","leftValue":"={{ $json.sha }}","rightValue":"={{ $binary.data.fileName }}","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[176,336],"id":"b3165d9a-aea4-47b3-a93e-b86af5ba40cd","name":"Verifica se o arquivo existe no repositório"},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"edit","owner":{"__rl":true,"value":"TaysaGuiral","mode":"name"},"repository":{"__rl":true,"value":"BackupTesteMia","mode":"list","cachedResultName":"BackupTesteMia","cachedResultUrl":"https://github.com/TaysaGuiral/BackupTesteMia"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Seta a data de commit'].json.commitDate }}"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[400,112],"id":"cfc3e994-3f98-4971-9b1e-38c63a515f5a","name":"Atualiza arquivo - GitHub","webhookId":"0e93e1c8-fe06-493b-bb49-143e10c9e876","credentials":{"githubOAuth2Api":{"id":"260nE6yM2M6aN3IA","name":"GitHub - Taysa"}}},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"TaysaGuiral","mode":"name"},"repository":{"__rl":true,"value":"BackupTesteMia","mode":"list","cachedResultName":"BackupTesteMia","cachedResultUrl":"https://github.com/TaysaGuiral/BackupTesteMia"},"filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Seta a data de commit'].json.commitDate }}"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[400,352],"id":"11192539-4676-46e3-8e62-197e1dd88ac2","name":"Cria/Sobe arquivo - GitHub","webhookId":"7130b789-579c-40ef-af12-fd772dea7042","credentials":{"githubOAuth2Api":{"id":"260nE6yM2M6aN3IA","name":"GitHub - Taysa"}}},{"parameters":{"assignments":{"assignments":[{"id":"578da120-f7a9-4f41-aff8-c4868604393d","name":"owner","value":"TaysaGuiral","type":"string"},{"id":"bac6f6c1-e3e2-43e7-9dc3-42363f525475","name":"repository","value":"BackupTesteMia","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-2240,320],"id":"8724ef17-3c30-42a0-ae94-c5404149101e","name":"Infos Básicas"},{"parameters":{"content":"## Enviar backup\nDivide os arquivos JSON em lotes de 1 e verifica se eles já foram enviados anteriormente para o repositório.\nSe sim (true), envia a nova versão do arquivo. Caso contrário (não / false), cria o arquivo no repositório.","height":608,"width":816,"color":4},"type":"n8n-nodes-base.stickyNote","position":[-224,-16],"typeVersion":1,"id":"db56c45e-ab70-4d20-85d9-0f43fcce9378","name":"Sticky Note3"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-144,320],"id":"ca6b6108-27c1-4fa3-bad7-2fd166308cbc","name":"Percorre a lista em itens individuais"},{"parameters":{"mode":"combine","advanced":true,"mergeByFields":{"values":[{"field1":"={{ $binary.data.fileName }}","field2":"={{ $json.name }}"}]},"joinMode":"keepEverything","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-480,656],"id":"b009d3e5-126a-4be0-ab0f-744521a20b13","name":"Merge"}],"connections":{"Seta data":{"main":[[{"node":"Formata a data","type":"main","index":0}]]},"Formata a data":{"main":[[{"node":"Seta a data de commit","type":"main","index":0}]]},"Seta a data de commit":{"main":[[{"node":"Lista de arquivos","type":"main","index":0},{"node":"Recupera Workflows - N8N","type":"main","index":0}]]},"Lista de arquivos":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Schedule Trigger":{"main":[[{"node":"Infos Básicas","type":"main","index":0}]]},"Recupera Workflows - N8N":{"main":[[{"node":"Converte JSON para Binário","type":"main","index":0}]]},"Converte JSON para Binário":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Verifica se o arquivo existe no repositório":{"main":[[{"node":"Atualiza arquivo - GitHub","type":"main","index":0}],[{"node":"Cria/Sobe arquivo - GitHub","type":"main","index":0}]]},"Atualiza arquivo - GitHub":{"main":[[{"node":"Percorre a lista em itens individuais","type":"main","index":0}]]},"Cria/Sobe arquivo - GitHub":{"main":[[{"node":"Percorre a lista em itens individuais","type":"main","index":0}]]},"Infos Básicas":{"main":[[{"node":"Seta data","type":"main","index":0}]]},"Percorre a lista em itens individuais":{"main":[[],[{"node":"Verifica se o arquivo existe no repositório","type":"main","index":0}]]},"Merge":{"main":[[{"node":"Percorre a lista em itens individuais","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"2f7a777b-7168-4611-ba2b-9ff1adbc7aab","triggerCount":0,"tags":[]}