{"createdAt":"2025-10-13T19:17:28.897Z","updatedAt":"2025-10-31T19:56:36.532Z","id":"FrSz7RJlxVLbq52B","name":"Finamob - 1.1 - Journal - RSS","active":true,"isArchived":false,"nodes":[{"parameters":{"url":"https://feeds.folha.uol.com.br/mercado/rss091.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,528],"id":"41b563ae-04dd-4fa6-8ab7-89be9ad689dc","name":"RSS Folha","onError":"continueRegularOutput"},{"parameters":{"url":"https://br.investing.com/rss/news_301.rss","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,336],"id":"d59be019-8adc-4921-965a-5a5d39a6c9fd","name":"RSS Investing","onError":"continueRegularOutput"},{"parameters":{"url":"https://metroquadrado.com/feed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,688],"id":"deaf048a-8b9b-4ea7-af93-1b7c341fc833","name":"RSS Metro Quadrado","onError":"continueRegularOutput"},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":30}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-480,2720],"id":"c10cbc78-4c45-45e8-8f83-727b3deb5e95","name":"Schedule Trigger"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-224,2720],"id":"9f547e2a-c858-40b4-a59c-e7e98cc5246e","name":"No Operation, do nothing","alwaysOutputData":false},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[6496,2656],"id":"6d48ad4d-5f5f-457f-a002-740b553f2d48","name":"OpenRouter Chat Model","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"content":"# Portais de notícias\n\n### Portais de notícias que o fluxo irá consultar para gerar os posts","height":4528,"width":1648},"type":"n8n-nodes-base.stickyNote","position":[576,176],"typeVersion":1,"id":"43c9f990-0236-4555-9ef7-a1d72e651afb","name":"Sticky Note"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1584,944],"id":"447f83b3-a379-4b81-b363-cdb775ae38b1","name":"Notícias Consolidadas"},{"parameters":{"content":"# Custos totais da Infra + Manut.\n\n### VPS - BRL 60 / mês\n### Open Router e Open AI API - USD 25 / month\n### hcti.io - HTML/CSS to Image API - USD 14 / month\n### Evolution API - BRL 40 / mês?\n### Telera - Número Whatsapp - BRL 11 / mês?\n### Conta Google - BRL 60 / mês\n### Manutenção e melhorias - BRL 500 / mês\n\n## Total ~ 900 / mês","height":528,"width":560,"color":3},"type":"n8n-nodes-base.stickyNote","position":[0,0],"typeVersion":1,"id":"7d92fe28-8be1-41ce-a1f5-9c883c0453b9","name":"Sticky Note9"},{"parameters":{"promptType":"define","text":"=Você é um especialista em conteúdo imobiliário voltado a incorporadores, construtores, investidores e gestores de fundos.\nSeu papel é transformar notícias do mercado imobiliário em carrosséis estratégicos e profissionais, capazes de gerar insights reais, decisões inteligentes e posicionamento de autoridade no Instagram do ImobJournal.ia.\n\nSeu estilo é analítico, didático e direto, sem jargões desnecessários. O objetivo é traduzir complexidade em clareza, sem simplificações superficiais.\nA comunicação deve ser informativa, sólida e confiável, como a de um consultor experiente que explica para outro profissional.\n\nEntrada: uma lista de notícias (cada item contém {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}). Pode haver itens duplicados vindos de fontes diferentes.\n\n### Regras gerais\nMantenha o campo \"imagem\" exatamente como veio (mesmo que vazio).\nUse apenas conteúdo textual para criar o post.\nEntregue conteúdo denso, aplicável e com ritmo fluido.\n\n✍️ ESTRUTURA COMPLETA PARA 3 IMAGENS DO CARROSSEL\nPara cada notícia única, crie conteúdos para as 3 imagens do carrossel:\n\nIMAGEM 1 (INTRODUÇÃO) - TÍTULO MAGNÉTICO:\nCrie um título magnético e direcionado a incorporadores, construtores, investidores ou gestores de fundos, com até 10 palavras.\nO objetivo é despertar a curiosidade e um senso de oportunidade ou urgência, como um \"clickbait do bem\". Para isso, siga uma das estratégias abaixo:\n\n- Fale diretamente com o público: Use pronomes como \"Você\", \"Seu\", \"Sua\". (Ex: \"Sua estratégia de investimentos imobiliários pode ser transformada.\")\n- Crie uma pergunta provocativa: Questione uma prática comum ou aponte para uma nova tendência. (Ex: \"O custo da construção vai mudar de novo?”)\n- Faça uma promessa de valor: Deixe claro o benefício que o incorporador terá ao ler a legenda. (Ex: \"A nova regra que pode redefinir o crédito imobiliário corporativo.\")\n- Gere um alerta: Indique uma mudança ou um risco que o incorporador precisa conhecer. (Ex: “Atenção incorporador: o prazo para adequação tributária está acabando”)\nImportante: O título deve ser irresistível, mas sempre 100% fiel ao conteúdo da notícia. Sem sensacionalismo exagerado ou promessas falsas.\n\nSelecione 1 palavra-chave do título para ficar em itálico o critério para escolher é:\n    Palavra mais impactante do título\n    Conceito central da notícia\n    Termo que gera curiosidade\n    Máximo 1 palavra (não frase)\nEnvolva essa palavra com <em> diretamente no título\nMáximo 1 palavra em itálico\nExemplos:\n  Ex: “tributação”, “valorização”, “fundos”, “crédito”.\nGere também um subtitulo_formatado: Texto complementar para o subtítulo que deve ser um gancho para o conteúdo que será apresentado no titulo_desenvolvimento.\n\nExemplo:\n{\n  \"titulo\": \"A nova <em>tributação</em> que pode reconfigurar o lucro das incorporadoras\",\n  \"subtitulo_formatado\": \"Mudança em alíquota de PIS/Cofins afeta margens de construtoras e fundos imobiliários\"\n}\n\n\nIMAGEM 2 (DESENVOLVIMENTO) - O CERNE DA NOTÍCIA (MAIS PROFUNDO):\n\n- Entre 50 e 55 palavras — texto expandido e denso.\n- OBJETIVO: Apresentar o cerne da notícia com clareza e profundidade, explicando o contexto, os dados concretos e as implicações para o mercado. Deixar claro o que aconteceu, quais os números e como isso se conecta à operação e finanças do setor.\nESTRUTURA IDEAL:\n1. Explique o fato principal da notícia (o que aconteceu).\n2. Mostre o impacto direto no mercado imobiliário (como afeta demanda, crédito, valorização, vendas etc).\n3. Inclua números, prazos, valores, regiões, medidas ou tendências específicas.\n4. Dê interpretação: o que isso representa para o corretor (sem ainda entrar em ação prática).\n\nPara a segunda imagem, gere também:\n- texto_desenvolvimento: Array com 3 strings (no total tem que ter 55-60 palavras, isto é, bloco1 + bloco2 + bloco3 = no minimo 55 e no maximo 60 palavras, a soma dos caracteres/palavras das strings do array todo tem que ter no minimo 55 palavras e no maximo 60 palavras)\nCada bloco do texto_desenvolvimento deve ter **no máximo 20 palavras** para o bloco 1, **20 palavras** para o bloco 2 e **20 palavras** para o bloco 3, somando no máximo 60 palavras.\nNão ultrapasse esses limites. Conte as palavras antes de terminar o bloco.\n\nCRITÉRIOS DE FORMATAÇÃO:\n\nBloco 1 (bold + itálico):\n    bold: números, porcentagens, dados concretos\n    italico: conceitos centrais, termos técnicos, nomes próprios\n\nBloco 2 (apenas bold):\n    bold: palavras-chave, termos importantes\n\nBloco 3 (sublinhado):\n    sublinhado: insights principais, conclusões, tendências\n\nEXEMPLOS:\n{\n  \"texto_desenvolvimento\": [\n    \"O <em>IBGE</em> registrou alta de <b>4,2%</b> nos custos da construção civil em setembro, puxada por aço, cimento e mão de obra especializada.\",  \n    \"Essa <b>pressão inflacionária</b> afeta orçamentos, margens e cronogramas de obras, exigindo revisão de contratos, repactuação de fornecedores e ajuste de projeções financeiras.\",  \n    \"O cenário reforça a <u>importância de planejamento</u> estratégico e <u>gestão de riscos</u> para proteger retorno sobre investimentos e manter competitividade no mercado.\"\n  ]\n}\n\n\nIMAGEM 3 (APLICABILIDADE) - AÇÃO IMEDIATA DO CORRETOR (MAIS ROBUSTA):\n- Entre 50 e 60 palavras — com foco prático e detalhado.\n- OBJETIVO: Transforme o conteúdo em ação tática ou estratégica para incorporadores, investidores ou gestores.\nESTRUTURA IDEAL:\n1. Mostre como pode usar a informação no trabalho diário.\n2. Dê um passo prático (oferecer, revisar carteira, adaptar discurso, divulgar, etc).\n3. Mostre o benefício real: fechamento de vendas, geração de leads, autoridade, diferenciação.\n4. Se for regional, oriente o usar como modelo ou benchmark.\n\nPara a terceira imagem, gere também:\n- texto_aplicabilidade: Array com 3 strings (no total com 50-60 palavras)\n\nCRITÉRIOS DE FORMATAÇÃO:\nBloco 1 (Bold + Itálico):\n    bold: ações específicas, passos concretos\n    italico: conceito central, benefício principal\n\nBloco 2 (Sublinhado):\n    sublinhado: estratégias chave, diferenciais competitivos\n\nBloco 3 (Normal):\n    Sem formatação: benefício final, resultado esperado\n\nExemplo:\n{\n  \"titulo_aplicabilidade\": \"Implemente ações estratégicas para controlar custos e maximizar rentabilidade de projetos\",\n  \"texto_aplicabilidade\": [\n    \"<b>Revise detalhadamente todos os orçamentos</b> e identifique custos críticos. <b>Negocie prazos e preços</b> com fornecedores, priorizando insumos estratégicos. Use o <em>controle financeiro rigoroso</em> como alavanca para proteger margens e rentabilidade do projeto.\",  \n    \"Implemente <u>gestão de riscos</u> e revise cronogramas, garantindo cumprimento de metas. Analise <u>cenários de contingência</u> e ajuste estratégias antes de cada fase de obra.\",  \n    \"Essas ações práticas aumentam previsibilidade de resultados, reduzem desperdícios e otimizam retorno sobre investimento, fortalecendo posição frente a investidores e fundos estratégicos.\"\n  ]\n}\n\n\n### LEGENDA (4 BLOCOS + LINHA FINAL)\n\nEscreva uma legenda com até 700 caracteres, dividida em 4 blocos, bem explicados.\nEla deve ser clara, simples e com tom didático, como se estivesse explicando para alguém de 18 anos que nunca ouviu falar do assunto.\n\nA legenda deve conter quatro blocos separados com \\n\\n, mas sem escrever os nomes dos blocos. Siga a estrutura abaixo apenas como orientação interna (não inclua esses títulos no texto final):\n\nEstrutura da legenda:\n\n1. Conte o que aconteceu, com as informações principais e números relevantes (sem termos técnicos difíceis). Nao seja superficial, nao escreva coisas como \"pode impactar\", \"talvez ajude\", entregue as informacoes da noticia de forma completa. Se a noticia fala sobre 3 dicas para vender melhor, entregue as 3 dicas na legenda. Nunca fale da noticia como se ela viesse de outro canal, tudo o que tiver na noticia tem que estar de forma resumida na nossa legenda. Esse bloco precisa entregar as informacoes da noticia de forma muito completa.\n\n2. Explique com clareza e simplicidade o que é esse tema (ex: o que é FII? como funciona o financiamento? O que sao fundos de investimento, etc..). Imagine que está falando com alguém de 18 anos que nunca ouviu falar disso.\n\n3. Mostre como ele pode usar essa informação impacta na vida do incorporador. Por exemplo, como aumento da taxa selic impacta no financiamento da sua obra? ou vai impactar na venda do produto para o cliente final? Como a reforma tributaria esbarra nas incorporadoras? O que um lucro de uma grande incorporadora pode trazer de tendencia para outros incorporadores? Sempre trazendo a relacao da noticia com o mundo dos incorporadores.\n\n4. Inclua uma pergunta ou convite leve para o Incorporador refletir ou comentar, algo trazendo uma discussao pelos comentarios, pedindo opiniao, trazendo alguma polemica, etc..\n\n5. Acrescente **exatamente uma** linha final, separada por \\n\\n, com o texto:\n\"Siga @imobjournal.ia para ficar por dentro das principais notícias do mercado imobiliário!\"\"\n\nUse esta estrutura apenas como referência interna para construir a legenda (não escreva os títulos dos blocos na legenda final).\n\nA legenda não deve parecer um convite para acessar a matéria completa. Ela já entrega o que importa.\n\n📦 Formato de resposta\nRetorne somente o array JSON abaixo, direto (sem explicações antes ou depois):\n\n[\n  {\n    \"titulo\": \"Título magnético para Imagem 1\",\n    \"subtitulo_formatado\": \"Subtítulo complementar em EB Garamond itálico\",\n\n    \"titulo_desenvolvimento\": \"Resumo denso e claro da notícia (de 55 a 60 palavras no máximo)\", \n    \"texto_desenvolvimento\": [\n      \"Texto completo do primeiro bloco (bold com itálico)...com no mínimo 18 palavras e no máximo 20 palavras\",\n      \"Texto completo do segundo bloco (normal)... com no mínimo 18 palavras e no máximo 20 palavras\", \n      \"Texto completo do terceiro bloco (sublinhado)...com no mínimo 18 palavras e no máximo 20 palavras\"\n    ],\n\n    \"titulo_aplicabilidade\": \"Ação prática para o corretor (de 50 a 60 palavras)\",\n    \"texto_aplicabilidade\": [\n      \"Texto do primeiro bloco (bold + itálico)...\",\n      \"Texto do segundo bloco (sublinhado)...\",\n      \"Texto do terceiro bloco (normal)...\"\n    ],\n\n    \"legenda\": \"Texto completo com até 700 caracteres e 3-4 blocos e uma linha separados por \\\\n\\\\n\",\n    \"imagem\": \"{{ $json.imagem }}\", // Pode ser string vazia - mantenha o valor original\n    \"fonte\": \"{{ $json.link }}\",\n    \"nota\": 0-10\n  }\n]\n\nGaranta que cada item do array corresponde a uma notícia realmente única, com título e legenda originais, prontos para capturar e engajar o público do Instagram imobiliário.\n\n**Lista de notícias:**\nLink: {{ $json.link }}\nTitulo: {{ $json.title }}\nConteudo: {{ $json.content }}\nConteudo2: {{ $json.contentSnippet }}\n\nRetorne diretamente como JSON válido (não como string). Sem aspas no array completo.\n\nNa legenda, utilize \"\\n\\n\" para representar quebras de linha, separando claramente os blocos de conteúdo (gancho, contexto, CTA).\n\n**LEMBRETE FINAL:**\n- Mantenha o campo \"imagem\" exatamente como recebeu (mesmo que vazio)\n- Foque apenas no conteúdo textual para determinar os textos e legenda\n- Sempre prefira explicações mais completas e contextualizadas, com foco em dados concretos e implicações práticas para o corretor. Evite simplificações; entregue valor real e aplicável em cada bloco.\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[6496,2480],"id":"c71c472f-5b19-4902-9d05-24992801ee30","name":"AI Agent - Estrutura dos Posts","onError":"continueRegularOutput"},{"parameters":{"content":"# Estruturação dos Posts\n\n### Lógica para definir estrutura dos posts. Escolhe o que é mais relevante e reescreve título, legenda e prepara JSON para etapas seguintes.","height":1024,"width":800},"type":"n8n-nodes-base.stickyNote","position":[6336,2048],"typeVersion":1,"id":"d9c5e3d8-facd-4ebc-b1e1-109eb84fa9e6","name":"Sticky Note10"},{"parameters":{"url":"https://www.papoimobiliario.com/feed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,864],"id":"ab011fb7-39c8-4b06-b2a7-e28e0916158c","name":"RSS Papo Imobiliário","onError":"continueRegularOutput"},{"parameters":{"url":"https://exame.com/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1024],"id":"bc5678ab-512c-4661-a772-7f32c6ccb58c","name":"RSS Exame","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.infomoney.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1200],"id":"9de77348-8780-4860-b64a-15a06dc7e9f2","name":"RSS infomoney","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.portalvgv.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1360],"id":"e9ff396f-ccd4-4108-94f8-905c62357e22","name":"RSS Portal VGV","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.moneytimes.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1520],"id":"3489ed8a-8477-4219-9c4a-cd0e5d77b41b","name":"RSS Portal Money Times","onError":"continueRegularOutput"},{"parameters":{"url":"https://cbic.org.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1680],"id":"559edcec-3393-4807-910b-2f6f08249fb4","name":"RSS CBIC (Câmara Brasileira da Indústria da Construção)","onError":"continueRegularOutput"},{"parameters":{"url":"https://startupi.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,1840],"id":"b6b0cc31-f347-4643-9d29-9312469d51c5","name":"RSS Startupi","onError":"continueRegularOutput"},{"parameters":{"url":"https://g1.globo.com/rss/g1/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2016],"id":"b4fd6f2d-eb80-46a0-9558-8ae7ad89cd75","name":"RSS Globo G1","onError":"continueRegularOutput"},{"parameters":{"url":"https://feeds.bbci.co.uk/portuguese/rss.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2160],"id":"b2cc92f3-714c-411a-a418-6d22dabe38ba","name":"RSS BBC","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.cnnbrasil.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2304],"id":"2c8f3e0a-de8f-43ad-8c0d-c796776d9573","name":"RSS CNN","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.jornaldooeste.com.br/rss/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2496],"id":"9f2bfe59-cf06-444e-84f5-768e8b1fddc7","name":"RSS Jornal do Oeste","onError":"continueRegularOutput"},{"parameters":{"url":"https://www12.senado.leg.br/noticias/rss/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2640],"id":"e12217d1-4b61-425f-b331-2f5ea5c05c59","name":"RSS Senado","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/ultimas-noticias","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2784],"id":"73bb8503-2744-4f92-9b70-cba1b7ad0306","name":"RSS Camara","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/AGROPECUARIA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,2944],"id":"ee583861-e1ee-46cc-bd1f-7aea600e9d6d","name":"RSS Camara Agro","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ELEICOES","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3104],"id":"465f0900-5c38-4687-8760-06d3cee40adc","name":"RSS Camara Eleicoes","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ADMINISTRACAO-PUBLICA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3264],"id":"d13096ad-4055-4dce-8f39-8cea36ffdeab","name":"RSS Camara Adm Publica","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/POLITICA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3440],"id":"366fc0b4-1236-425e-9966-c40c4066ccea","name":"RSS Camara Politica","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ECONOMIA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3600],"id":"77057c3d-96ba-4163-a832-4c3b1fb9aea4","name":"RSS Camara Economia","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/CIDADES","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3760],"id":"ab07b5ab-1b3c-4cad-a439-318ba05d1b6e","name":"RSS Camara Cidades","onError":"continueRegularOutput"},{"parameters":{"url":"https://agenciabrasil.ebc.com.br/rss/ultimasnoticias/feed.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,3920],"id":"f72298fd-2e32-4ec1-bd18-4518f51bf156","name":"RSS Agencia Brasil","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.theguardian.com/world/rss","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,4080],"id":"3ebee90b-9462-4966-8eb1-fc66d25fed98","name":"RSS The Guardian","onError":"continueRegularOutput"},{"parameters":{"url":"https://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,4224],"id":"5c33542d-d05c-4362-a3a2-f2e2cf5a5991","name":"RSS nytimes","onError":"continueRegularOutput"},{"parameters":{"url":"https://rss.dw.com/rdf/rss-en-top","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,4368],"id":"473ab717-2a49-4383-bbaf-45eefef4f886","name":"RSS Deutsche Welle","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.aljazeera.com/xml/rss/all.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[960,4528],"id":"df9d7f67-05ad-4da9-b487-78f3fd983a9f","name":"RSS Al Jazeera","onError":"continueRegularOutput"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1600,2592],"id":"69108716-f561-43d4-b68a-46a64244ecad","name":"Notícias Consolidadas1"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1600,4016],"id":"31968185-cec6-4ace-9daf-cb7d0be13997","name":"Notícias Consolidadas2"},{"parameters":{"numberInputs":3},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2016,2704],"id":"b182bf1d-4224-4e52-91f7-b99b03632245","name":"Notícias Consolidadas3"},{"parameters":{"jsCode":"// === Parâmetros ===\nconst THRESHOLD = 80;           // mínimo para aprovar\nconst MAX_ITENS = 30;           // máximo a retornar\nconst DECAY_HALF_LIFE_H = 48;   // meia-vida da recência (horas)\nconst DEDUPE_SIMILARITY = 0.85; // similaridade p/ dedupe (0..1)\nconst KEEP_SCORE_IN_OUTPUT = false; // true só p/ debug\n\n// === Dicionários de relevância (mercado imobiliário) ===\nconst KW = {\n  forte: [\n    // Termos centrais do setor\n    'imóvel','imoveis','imovel','imobiliario','mercado imobiliario',\n    'apartamento','apartamentos','casa','casas',\n    'condominio','condominios','empreendimento','empreendimentos',\n    'loteamento','lançamento','construção','obra',\n    'aluguel','aluguéis','locação','comprar imóvel','venda de imóveis',\n    'financiamento imobiliario','credito imobiliario','hipoteca',\n    'sbpe','fgts','carta de crédito','consórcio imobiliário',\n    'minha casa minha vida','casa verde e amarela','mcmv',\n    'taxa de juros','selic','copom','inadimplência imobiliária',\n    'registro de imóveis','cartório de imóveis','escritura','averbação',\n    'iptu','itbi','patrimônio de afetação',\n    'incorporadora','construtora','imobiliária',\n    'fundo imobiliário','fii','fiis','lci','lca','cri','cra',\n    'cyrela','mrv','tenda','direcional','cury','eztec','loft','quintoandar'\n  ],\n  medio: [\n    'distrato','repasse','estoque de imóveis',\n    'plano diretor','zoneamento','uso do solo','licenciamento urbano',\n    'habite-se','alvará de construção','regularização fundiária',\n    'vacância','taxa de vacância','cap rate','valor venal','valuation imobiliário',\n    'smart city','cidade inteligente','urbanismo','arquitetura sustentável',\n    'sustentabilidade na construção','green building','esg','leed'\n  ],\n  fracos: [\n    'futebol','bbb','celebridade','cantor','cantora','show',\n    'meme','tiktok','game','jogo','filme','série','streaming'\n  ],\n  brasil: [\n    'brasil','são paulo','rio de janeiro','belo horizonte','curitiba','porto alegre',\n    'pernambuco','bahia','fortaleza','manaus','goiânia','campinas',\n    'caixa','banco do brasil','itaú','bradesco','santander','inter','sicredi','sicoob'\n  ],\n  contextoEco: [\n    'mercado de capitais','funding imobiliário','captação',\n    'juros','selic','copom','pib','inflação','ipca','igpm',\n    'crédito','investimento imobiliário','economia digital',\n    'setor de construção','setor imobiliário'\n  ]\n};\n\n// === Funções auxiliares ===\nconst norm = (s='') =>\n  String(s).toLowerCase()\n    .normalize('NFD').replace(/[\\u0300-\\u036f]/g,'')\n    .replace(/https?:\\/\\/\\S+/g,' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu,' ')\n    .replace(/\\s+/g,' ')\n    .trim();\n\nconst tokens = s => new Set(norm(s).split(' ').filter(t => t.length > 2));\n\nconst tokenSimilarity = (a,b) => {\n  const A = tokens(a), B = tokens(b);\n  const inter = [...A].filter(t => B.has(t)).length;\n  return inter / (Math.max(A.size, B.size) || 1);\n};\n\nconst hasAny = (text, list) => {\n  const t = norm(text);\n  return list.some(k => t.includes(norm(k)));\n};\n\nconst hoursSince = (d) => {\n  if (!d) return 1e9;\n  const ts = new Date(d).getTime();\n  return isNaN(ts) ? 1e9 : (Date.now() - ts) / 36e5;\n};\n\nconst recencyMultiplier = (h) => {\n  const lambda = Math.log(2) / DECAY_HALF_LIFE_H;\n  return Math.exp(-lambda * h);\n};\n\nconst scoreItem = (j) => {\n  const title = j.title || '';\n  const body = j['content:encoded'] || j.content || '';\n  const snippet = j.contentSnippet || '';\n  const cats = Array.isArray(j.categories)\n    ? j.categories.map(c => typeof c === 'string' ? c : JSON.stringify(c)).join(' ')\n    : (typeof j.categories === 'string' ? j.categories : '');\n  const text = `${title} ${snippet} ${body} ${cats}`;\n\n  let score = 0;\n  const forte = hasAny(text, KW.forte);\n  const contexto = hasAny(text, KW.contextoEco);\n\n  if (forte) score += 40;\n  if (hasAny(text, KW.medio)) score += 20;\n  if (hasAny(text, KW.brasil)) score += 10;\n  if (hasAny(text, KW.fracos)) score -= 50;\n\n  if (forte && contexto) score += 30;\n\n  const hasNumber = /\\b\\d+([.,]\\d+)?\\b/.test(text);\n  const hasPercent = /%\\b/.test(text);\n  if (contexto && hasPercent) score += 15;\n  else if (contexto && hasNumber) score += 5;\n\n  score *= recencyMultiplier(hoursSince(j.isoDate || j.pubDate));\n  return Math.max(0, Math.min(100, Math.round(score)));\n};\n\n// === Pipeline ===\nconst seenTitles = [];\nconst scoredItems = [];\n\nfor (const item of items) {\n  const j = { ...item.json };\n  const s = scoreItem(j);\n\n  let dup = false;\n  for (const prevTitle of seenTitles) {\n    if (tokenSimilarity(prevTitle, j.title || '') >= DEDUPE_SIMILARITY) {\n      dup = true; break;\n    }\n  }\n  if (dup) continue;\n\n  if (s >= THRESHOLD) {\n    seenTitles.push(j.title || '');\n    if (KEEP_SCORE_IN_OUTPUT) j._score = s;\n    scoredItems.push({ json: j, _score: s });\n  }\n}\n\nscoredItems.sort((a,b) => b._score - a._score);\nreturn scoredItems.slice(0, MAX_ITENS).map(i => ({ json: i.json }));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2768,2704],"id":"b8f1e828-1e88-4eb5-b9e0-1080926b082a","name":"Code"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e201d72c-d4e6-4a9e-a07e-782cf5a39960","leftValue":"={{ new Date($json[\"pubDate\"]) }}","rightValue":"={{ new Date(Date.now() - 1 / 2 * 60 * 60 * 1000) }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[2432,2720],"id":"c8abbe70-0e3c-4e00-9488-bc4876039c64","name":"Filtro de data da notícia","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b5d79643-ef81-4cef-b02d-371990a64543","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[3280,2704],"id":"50076105-1c7c-402e-876d-e096a5f3f194","name":"Validação do campo imagem1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"return {\n  ...$json,\n  original: $json // salva todos os dados da notícia\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3488,2416],"id":"86041813-1fbd-4763-866c-515b2e05630f","name":"Backup dados da notícia1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\n\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : \"\";\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1]; // aqui mantém a URL achada\n  }\n}\n\n// Recupera os campos originais da notícia de 'Backup dados da notícia1'\nreturn {\n  ...($('Backup dados da notícia1').item.json.original || {}),\n  imagem\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3888,2416],"id":"0040fba9-3713-4ea5-af55-61b5a69eca6e","name":"Extrair imagem do HTML1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05295fc0-aca6-433a-a239-c5d8ed4fc011","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4080,2352],"id":"f6454e10-a87b-4439-84da-69f725461203","name":"Imagem encontrada?1","alwaysOutputData":false},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Você é um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta é \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[4336,2176],"id":"44ac7d22-6865-4f6a-ab5e-d99ecb1935f9","name":"Analyze image3","retryOnFail":true,"credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : '';\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1];\n  }\n}\n\n// Recupera os campos originais da notícia de 'Backup dados da notícia1'\nreturn {\n  ...($('Backup dados da notícia1').item.json.original || {}),\n  imagem: $('Imagem encontrada?1').item.json.imagem\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4816,2160],"id":"951ba4f3-f1e8-4aae-a20e-328b01f0f435","name":"Salvar imagem gerada"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Você é um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta é \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[3696,2864],"id":"c28e1cb1-c364-4ee1-8eff-fb2e7f9bee69","name":"Analyze image4","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Pega os dados originais da padronização\nconst original = $('Padronização do campo imagem').item.json;\n\nreturn {\n  ...original\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4336,2544],"id":"a117a990-ba9c-4bb1-814e-885e11696b92","name":"Salvar imagem gerada6"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4080,2864],"id":"9b2f308d-5167-4f5a-92cd-fa036ea907b8","name":"Imagem é boa?1"},{"parameters":{"numberInputs":5},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[5136,2464],"id":"5c02ded5-d845-412f-81eb-d2911b795e7e","name":"Unificar imagem final1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4544,2176],"id":"a857301a-402d-4c66-904b-877d374c88dd","name":"Imagem é boa?2"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Coloque os possíveis campos que podem trazer a imagem direto do RSS\nconst possiveisCampos = [\n  $json['media:content']?.url,\n  $json['enclosure']?.url,\n  $json['image'],\n  $json['og:image']\n];\nconst imagemDireta = possiveisCampos.find(x => !!x);\n\nreturn {\n  ...$json,\n  imagem: imagemDireta || '' // Se não tiver, deixa vazio\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3072,2704],"id":"3d867ce7-d24a-44ed-a363-c64b94c34b9a","name":"Padronização do campo imagem","onError":"continueRegularOutput"},{"parameters":{"url":"={{ $json.link }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"User-Agent","value":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[3696,2416],"id":"6fa011d5-0abb-49e3-9f1c-2d6cc0b14c66","name":"Buscar HTML da notícia","onError":"continueRegularOutput"},{"parameters":{"content":"# Definição da Primeira (Introdução) Imagem do Post\n\n### Primeiro busca imagem na notícia, se não busca no unsplash","height":1024,"width":2784,"color":5},"type":"n8n-nodes-base.stickyNote","position":[2704,2048],"typeVersion":1,"id":"c4af7e13-e0e6-4188-b5bd-5971325447b8","name":"Sticky Note7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0c9a2cce-1e4b-4f37-9c24-91e5375e8efe","leftValue":"={{ $json.nota }}","rightValue":7,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[6192,2496],"id":"539b8d2b-4bf8-40d7-9503-b03ada4fc2d1","name":"Filtro Relevância1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d0dfeb91-0204-4723-b60b-d9b5fa6a1c80","leftValue":"={{ \n  // Verifica se TODOS os campos essenciais existem e são válidos\n  $json.title && \n  $json.title !== \"undefined\" &&\n  $json.link && \n  $json.link !== \"undefined\" &&\n  $json.content && \n  $json.content !== \"ruim\" &&\n  $json.content !== \"undefined\" \n}}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[5328,2512],"id":"4ada2c07-8117-4459-b183-364b426baae8","name":"Impede que tupla undefined passe para o agente"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[5600,2720],"id":"ca3a6f45-859c-4bf3-8e14-7fb267104d00","name":"OpenRouter Chat Model1","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"promptType":"define","text":"=Você é um social media especialista e autoridade em conteúdo imobiliário no Instagram. Sua comunicação é informativa, objetiva e valorizada por profissionais do setor — como incorporadores, construtores, investidores e gestores de fundos — que acompanham suas publicações para se manter atualizados com o que realmente importa.\n\nEntrada: uma lista de notícias (cada item contém {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}). Pode haver itens duplicados vindos de fontes diferentes.\n\n**IMPORTANTE SOBRE IMAGENS:**\n- O campo \"imagem\" pode estar vazio, nulo ou conter URL inválida\n- Isso é normal e será tratado posteriormente no fluxo\n- Sua análise de relevância NÃO deve ser influenciada pela presença ou não de imagem\n\nSua missão:\n\nAnalise profundamente todas as notícias.\n\nPara cada notícia, atribua uma nota de relevância de 0 a 10, representando o quanto ela é relevante para o setor imobiliário brasileiro.\n\nA nota deve refletir o interesse para empresários, incorporadores, construtores, investidores, gestores de fundos ou loteadores.\n\nConsidere impacto direto no setor, novidades, dados, tendências, decisões legais, mudanças em crédito, urbanismo, mercado de capitais, etc.\n\n### **REGRAS CENTRAIS DE JULGAMENTO**\n**Atualidade obrigatória**\n\n* A notícia deve ser **do ano vigente **.\n\n**Você deve agir como um filtro crítico, não como um redator otimista.**\n\n### **Duplicidade**\n\nNão repita notícias com pequenas variações de título, link ou números.\nCompare sempre conteúdo e título — se for o mesmo fato, mantenha apenas uma.\n\n---\n\n### **Imagens**\n\nO campo “imagem” pode estar vazio, nulo ou inválido — ignore isso totalmente na avaliação de relevância.\nUse apenas o conteúdo textual para decidir a nota.\n\n---\n\nEvitar repetir notícias com pequenas variações. Use o link e title para detectar duplicados.\n\nSempre use content ou contentSnippet para análise; títulos sozinhos não são suficientes.\n\n---\n\n### **Formato de saída (JSON limpo e direto)**\n\n[\n  {\n    \"link\": \"{{ $json.link }}\",\n    \"title\": \"{{ $json.title }}\",\n    \"content\": \"{{ $json.content }}\",\n    \"contentSnippet\": \"{{ $json.contentSnippet }}\",\n    \"status\": \"aprovada\" | \"reprovada\",\n    \"nota\": 0-10,\n    \"justificativa\": \"motivo curto e objetivo da decisão (ex: 'impacto direto no crédito imobiliário', 'notícia genérica sem relação com imóveis', 'publicação antiga de 2023')\"\n    \"imagem\": \"{{ $json.imagem }}\", // Pode ser string vazia - mantenha o valor original\n    \"fonte\": \"{{ $json.link }}\",\n  }\n]","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[5600,2496],"id":"425a452a-396d-4b01-a8d8-021224df744d","name":"AI Agent - Avaliação das notícias","onError":"continueRegularOutput"},{"parameters":{"content":"# Avaliação das notícias\n\n### Escolhe o que é mais relevante de acordo com o contexto da aplicação","height":1024,"width":784},"type":"n8n-nodes-base.stickyNote","position":[5520,2048],"typeVersion":1,"id":"2521417c-cb0a-43ba-af62-58dc133bca5c","name":"Sticky Note13"},{"parameters":{"jsCode":"// Une todas as saídas em um array único (o agente retorna um JSON por item)\nconst allAvaliacoes = items.flatMap(item => {\n  try {\n    return JSON.parse(item.json.output);\n  } catch (error) {\n    console.error(\"Erro ao parsear saída do agente:\", error);\n    return [];\n  }\n});\n\n// Garante que cada notícia seja um item individual\nreturn allAvaliacoes.map(noticia => ({\n  json: {\n    link: noticia.link || \"\",\n    title: noticia.title || \"\",\n    content: noticia.content || \"\",\n    contentSnippet: noticia.contentSnippet || \"\",\n    imagem: noticia.imagem || \"\",\n    pontuacao: noticia.pontuacao ?? noticia.nota ?? 0,\n    nota: noticia.nota ?? noticia.pontuacao ?? 0,\n    status: noticia.status || \"reprovada\",\n    justificativa: noticia.justificativa || \"\",\n    fonte: noticia.fonte || noticia.link || \"\"\n  }\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[5968,2496],"id":"805ec4e3-b82b-4523-b4a0-1b95766ed6aa","name":"Estruturação do JSON de saída1","onError":"continueRegularOutput"},{"parameters":{"jsCode":"const allNoticias = items.flatMap(item => JSON.parse(item.json.output));\n\nreturn allNoticias.map((noticia, index) => {\n  return {\n    json: {\n      ...noticia\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[6912,2480],"id":"0b862151-08a2-4658-8e5a-074db7f6003b","name":"Estruturação do JSON de saída","onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[11696,2160],"id":"dd80002b-fe48-4d22-9208-e5651f910355","name":"Binary > base64"},{"parameters":{"content":"# Edição das Imagens\n\n### Todas as transformações necessárias para ter a imagem final. \n### Publicação da imagem no Github, geração do link público da imagem e transformação para base64 (para envio no whatsapp).","height":2288,"width":3680,"color":3},"type":"n8n-nodes-base.stickyNote","position":[8960,400],"typeVersion":1,"id":"5ce2f01a-4cea-4e02-8163-61f2943fbf17","name":"Sticky Note11"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[10816,2160],"id":"27a3728d-2235-455b-a394-af5de32224af","name":"HTML > Imagem","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[11008,2160],"id":"c002caca-ffa7-4cef-9232-39d2205c113c","name":"Baixar imagem"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"finamob","mode":"list","cachedResultName":"finamob","cachedResultUrl":"https://github.com/getmia-ia/finamob"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[11360,1728],"id":"eeae8be5-9faa-4adb-99b4-1384634ea88c","name":"Salvar imagem no GitHub","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"jsCode":"return items.map(item => {\n  // Pega diretamente do planilha_data (nova estrutura)\n  const planilhaData = item.json.planilha_data;\n  \n  if (!planilhaData) {\n    console.log('Item sem planilha_data:', item.json);\n    return { json: {} }; // ou algum fallback\n  }\n\n  const { \n    noticia_id, \n    data_processamento, \n    titulo, \n    legenda, \n    fonte, \n    imagem, \n    arquivo_base64, \n    arquivo2_base64,\n    arquivo3_base64,\n    imagem_url, \n    imagem_url2, \n    imagem_url3, \n    status, \n    nota \n  } = planilhaData;\n\n  // Verificar se a legenda existe ANTES de usar\n  if (!legenda) {\n    console.log('Item sem legenda:', planilhaData);\n  }\n  \n  return {\n    json: {\n      noticia_id,\n      data_processamento,\n      titulo,\n      legenda: (legenda || '').replace(/\\\\n/g, '\\n\\n'),\n      fonte,\n      imagem,\n      arquivo_base64,\n      arquivo2_base64,    // nome do 2º arquivo base64\n      arquivo3_base64,    // nome do 3º arquivo base64  \n      imagem_url,\n      imagem_url2,    \n      imagem_url3,    \n      status,\n      nota\n    }\n  };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[13584,1904],"id":"f40e8238-4a60-4198-a1a0-5f41593adc65","name":"Filtro dos dados consolidados"},{"parameters":{"content":"# Atualização Controles e Envio do resultado por Whatsapp\n\n### Atualiza sheets e drive com informações e arquivos importantes\n### Envio do post completo por whatsapp para aprovador","height":976,"width":1264,"color":4},"type":"n8n-nodes-base.stickyNote","position":[12752,1184],"typeVersion":1,"id":"41a33d32-2a39-48fb-9b86-2d4ba0905dd5","name":"Sticky Note12"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[11184,2160],"id":"b8fd69a3-86ee-4cce-a320-2edd4626861d","name":"Cortar imagem 1080x1350"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url","value":"={{ $json.content.download_url }}","type":"string"},{"id":"ced6761b-f05f-46ce-bc78-64b91037f45e","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[11696,1904],"id":"d96fdae9-7dd1-48a4-9acf-44db1e94dbd6","name":"Create download_url"},{"parameters":{"promptType":"define","text":"=Você é um especialista em marketing visual e comunicação conceitual para corretores de imóveis brasileiros.\nSua missão é criar queries CONCEITUAIS em inglês para o Unsplash que resultem em imagens:\n- Visualmente atraentes e profissionais\n- Que transmitam o conceito e atmosfera da notícia\n- Sempre relacionadas a mercado imobiliário, negócios, economia ou urbanismo\n- Nunca literais ou genéricas\n\n**DADOS DA NOTÍCIA:**\n- Imagem:  {{ $json.imagem }}\n- Título Principal: {{ $json.titulo }}\n- Título Desenvolvimento: {{ $json.titulo_desenvolvimento }}\n- Título Aplicabilidade: {{ $json.titulo_aplicabilidade }}\n- Legenda: {{ $json.legenda }}\n- Nota de Relevância: {{ $json.nota }}\n- Precisa do Unsplash: {{ $json.precisa_unsplash }}\n\n**INSTRUÇÕES DE INTERPRETAÇÃO:**\n1. “Analise o significado e o impacto da notícia (Titulo Principal + Legenda) para o mercado imobiliário, traduzindo o conceito em termos visuais e profissionais que podem ser fotografados.”\n   - Conceito central da notícia\n   - Impacto no mercado imobiliário ou na atuação do corretor\n   - Atmosfera visual e contexto profissional\n2. Gere queries que reflitam **conceitos, contextos e atmosferas**, não objetos literais ou termos genéricos.\n3. Cada query deve ser distinta e gerar resultados diferentes no Unsplash.\n\n**REGRAS DE FORMATO:**\n- Sempre em inglês\n- Máximo 3-4 palavras\n- Nunca números, R$, %, siglas\n- NUNCA use palavras genéricas como \"growth\", \"success\", \"diversity\"\n\n### **CONTEXTOS VISUAIS PERMITIDOS:**\n- **Negócios e corretores:** “business meeting”, “real estate agent”, “corporate strategy”\n- **Mercado imobiliário:** “modern apartment exterior”, “urban housing”, “construction site”, “investment property”, “architecture project”\n- **Economia e finanças:** “financial planning desk”, “investment growth chart”, “business negotiation”\n- **Gestão e estratégia:** “strategic planning board”, “project development office”\n**QUERIES ESPECÍFICAS BASEADAS NOS NOVOS TÍTULOS:**\n\n### VARIAÇÃO CONTROLADA DAS QUERIES ###\n\nPara evitar resultados repetitivos no Unsplash, cada query deve ser semântica e conceitualmente relacionada, mas com nuance diferente:\nExemplo:\n    - Notícia: “Financiamento com juros baixos”\n    Queries possíveis:\n      - \"financial opportunity\"\n      - \"housing affordability\"\n      - \"investment optimism\"\n\n**EXEMPLOS PRÁTICOS COM OS NOVOS TÍTULOS:**\n\nNotícia: “Construtoras apostam em imóveis compactos”\nRUIM: “small apartment interior”\nBOM: “urban lifestyle”, “modern living”, “city housing trend”\n\n**Abordagem de Pesquisa**\n- Prefira cenários, pessoas, objetos e ambientes que transmitam o conceito da notícia\n- Evite fotos literais de números, telas de computador ou textos\n- Busque composição visual, arquitetura, reuniões, mapas, plantas, construções, escritórios, imóveis\n- Ex.: ao invés de “5 mil unidades com subsídio”, gerar “housing development” ou “urban residential planning”\n\n**Tom e contexto visual esperado**\nAs imagens devem transmitir sofisticação, profissionalismo e conexão com o mercado  imobiliário — exemplos de atmosfera:\n- Reuniões elegantes em escritórios modernos\n- Fachadas de prédios, condomínios e áreas urbanas\n- Perspectivas aéreas de cidades\n\nPessoas em negociação ou análise de mercado\n**FORMATO DE RESPOSTA (JSON):**\n** REGRA CRÍTICA DE SAÍDA - SEGUIR EXATAMENTE:**\n\n1. Se precisa_unsplash = true:\n\n- Gere 3 queries: query_slide_1_backup, query_slide_2, query_slide_3.\n\n- NUNCA inclua imagem.\n\n2. Se precisa_unsplash = false:\n\n- Gere 2 queries: query_slide_2, query_slide_3.\n\n- Inclua o link da imagem original em imagem e NUNCA inclua query_slide_1_backup.\n\n**EXEMPLOS CORRETOS:**\n\nCASO 1: precisa_unsplash = true\n{\n  \"query_slide_2\": \"business strategy\",\n  \"query_slide_3\": \"professional growth\", \n  \"query_slide_1_backup\": \"corporate vision\"\n}\n\nCASO 2: precisa_unsplash = false  \n{\n  \"query_slide_2\": \"market analysis\",\n  \"query_slide_3\": \"sales technique\",\n  \"imagem\": \"https://exemplo.com/imagem.jpg\"\n}\n\n🚫 NUNCA incluir ambos \"query_slide_1_backup\" e \"imagem\" no mesmo objeto.\n\nRESUMO DE INTENÇÃO FINAL\n\nGere queries conceituais, em inglês, que expressem o sentimento, atmosfera e contexto da notícia (com base em título + legenda).\nPrefira variações semânticas que reforcem o mesmo tema central, evitando repetições literais.\nTodas as queries devem remeter ao universo imobiliário, urbano ou corporativo — nunca genéricas.","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[9264,1376],"id":"9a1cf711-1525-4fe9-86e4-bb44e768146a","name":"AI Agent - Gerar prompts Unsplash"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[9264,1184],"id":"a5538ffe-1493-47c2-99e2-cdf20d829683","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[11664,992],"id":"ae3a74d0-bd3b-4c46-a283-e56df164abd0","name":"Binary > base"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[10672,992],"id":"12de91dc-046c-4505-a3a3-21911da12a17","name":"HTML > Imagem2","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[10896,992],"id":"fd624fd2-2c2e-478a-9999-057b4685215d","name":"Baixar imagem2"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[11104,992],"id":"92323fa6-f3eb-4350-84c7-2a98d801e4e4","name":"Cortar imagem 1080x"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url1","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c3004efc-851c-4a95-8174-eea5e3679c70","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[11680,640],"id":"9494f5b6-eac6-4fdc-8cfe-965ac418b69f","name":"Create download_url1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[11680,1504],"id":"26c5b57e-eb70-4277-a979-6a09eb136582","name":"Binary > base1"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[10672,1504],"id":"2c6e212b-76a8-45ad-9dd3-10a893f8a7ec","name":"HTML > Imagem3","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[10896,1504],"id":"059e017c-f9eb-4f8f-b299-35810aa7575e","name":"Baixar imagem3"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[11120,1504],"id":"6206b5e9-894b-4bab-9cdb-6d123ef0d36c","name":"Cortar imagem 1080x1"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url2","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c94b4062-f5d9-4e1c-b34c-1b099de178ea","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[11680,1312],"id":"692ab9be-1df6-4530-8358-0348bf748d7e","name":"Create download_url3"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif;\n      background: #000;\n      color: white;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      position: relative;\n    }\n\n    /* ---------- CONTAINER DA IMAGEM E LOGO ---------- */\n    .image-container {\n      position: relative;\n      width: 95%;\n      flex: 1 1 55%;\n      margin-top: 30px;\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- IMAGEM ---------- */\n    .image-top {\n      width: 100%;\n      height: 100%;\n      min-height: 550px;\n      background: url(\"{{$json['unsplash_url']}}\") center/cover no-repeat;\n      filter: brightness(0.8);\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- LOGO ---------- */\n    .logo {\n      position: absolute;\n      bottom: 20px;\n      right: 40px;\n      width: 100px;\n      filter: drop-shadow(0 0 10px rgba(0,0,0,0.8));\n    }\n\n    /* ---------- TEXTO ---------- */\n    .text-section {\n      width: 90%;\n      flex: 1 1 40%;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      gap: 18px;\n      margin-top: 30px;\n    }\n\n    .text-block {\n      max-width: 90%;\n      text-shadow: 1px 1px 5px rgba(0,0,0,0.4);\n      line-height: 1.5;\n    }\n\n    .block-1 { font-size: 38px; font-weight: 700; }\n    .block-1 em { font-family: 'EB Garamond', serif; font-style: italic; color: #fff; }\n\n    .block-2 { font-size: 28px; color: #e0e0e0; }\n    .block-3 {\n      font-size: 30px;\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-underline-offset: 5px;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem + Logo -->\n  <div class=\"image-container\">\n    <div class=\"image-top\"></div>\n    <img class=\"logo\" src=\"https://i.ibb.co/XfPKQQ9v/imgjournal-removebg-preview.png\" alt=\"Logo Finamob\" />\n  </div>\n\n  <!-- Texto -->\n  <div class=\"text-section\">\n    <div class=\"text-block block-1\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[0] || '' }}</div>\n    <div class=\"text-block block-2\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[1] || '' }}</div>\n    <div class=\"text-block block-3\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[2] || '' }}</div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[10464,992],"id":"3d116022-e1b8-4b6c-93c8-6c335ecb109a","name":"(Desenvolvimento) Criação do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif; /* Montserrat no restante do texto */\n      background-color: #ffffff;\n      color: #333333;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    /* ---------- IMAGEM DE FUNDO COM BORDA BRANCA ---------- */\n    .image-top {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background-image: url(\"{{$json['unsplash_url']}}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.9);\n      z-index: 0;\n      overflow: hidden;\n    }\n\n    /* ---------- OVERLAY ESCURO ---------- */\n    .overlay {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background: rgba(0, 0, 0, 0.7);\n      border: 5px solid white;\n      z-index: 1;\n      pointer-events: none;\n    }\n\n    /* ---------- LOGO NO CANTO SUPERIOR DIREITO ---------- */\n    .logo {\n      position: absolute;\n      top: 40px;\n      right: 40px;\n      width: 100px;\n      z-index: 3;\n      filter: drop-shadow(0 0 10px rgba(0,0,0,0.3));\n    }\n\n    /* ---------- SEÇÃO DE TEXTO ---------- */\n    .text-section {\n      position: absolute;\n      bottom: 140px; /* sobe o texto um pouco para caber dentro da imagem */\n      left: 90px;\n      right: 90px;\n      z-index: 3;\n      display: flex;\n      flex-direction: column;\n      gap: 25px;\n      color: #ffffff;\n      text-shadow: 0 2px 6px rgba(0,0,0,0.6);\n      max-width: calc(1080px - 180px); /* garante que o texto fique dentro da borda branca */\n    }\n\n    .text-bold {\n      font-size: 42px;\n      font-weight: 600;\n      line-height: 1.3;\n    }\n\n    /* ---------- ITÁLICO COM EB Garamond ---------- */\n    .text-bold em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      color: #fff;\n      font-size: 54px;\n      letter-spacing: -2px;\n      display: inline-block;\n    }\n\n    .text-normal {\n      font-size: 34px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n\n    .text-normal u {\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-decoration-thickness: 3px;\n      text-underline-offset: 5px;\n      font-weight: 600;\n    }\n\n    .text-regular {\n      font-size: 32px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem de fundo -->\n  <div class=\"image-top\"></div>\n\n  <!-- Overlay escuro para contraste -->\n  <div class=\"overlay\"></div>\n\n  <!-- Logo -->\n  <img class=\"logo\" src=\"https://i.ibb.co/XfPKQQ9v/imgjournal-removebg-preview.png\" alt=\"Logo Finamob\" />\n\n  <!-- Textos dentro dos limites da imagem -->\n  <div class=\"text-section\">\n    <div class=\"text-bold\">\n       {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[0] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-normal\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[1] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-regular\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[2] || '';\n        return texto;\n      })()\n    }}\n    </div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[10464,1504],"id":"10667086-f063-48a6-9d97-8186d23226b1","name":"(Aplicabilidade) Criação do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      font-family: 'Poppins', sans-serif;\n      overflow: hidden;\n      position: relative;\n      background-color: #000;\n    }\n\n    /* --- IMAGEM DE FUNDO --- */\n    .image-container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n    }\n\n    .image-container::before {\n      content: \"\";\n      position: absolute;\n      inset: 0;\n      background-image: url(\"{{ $json.output?.imagem ? $json.output.imagem : $json.unsplash_url }}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.55);\n      z-index: 1;\n    }\n\n    /* --- OVERLAY ESCURO --- */\n    .overlay-dark {\n      position: absolute;\n      inset: 0;\n      background: rgba(0, 0, 0, 0.0);\n      z-index: 2;\n    }\n\n    /* --- GRADIENTE INFERIOR --- */\n    .overlay-gradient {\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      height: 20%;\n      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);\n      z-index: 3;\n    }\n\n    /* --- LOGO --- */\n    .logo {\n      position: absolute;\n      right: 910px;\n      width: 100px;\n      z-index: 4;\n      margin-top: 40px;\n      filter: drop-shadow(0 0 8px rgba(0,0,0,0.7));\n    }\n\n    /* --- BLOCO DE TEXTO --- */\n    .text-block {\n      position: absolute;\n      bottom: 100px;\n      left: 80px;\n      right: 80px;\n      color: #fff;\n      z-index: 5;\n    }\n\n    /* --- TÍTULO PRINCIPAL --- */\n    .text-block h2 {\n      font-size: 64px;\n      font-weight: 600;\n      line-height: 1.0;\n      text-shadow: 2px 2px 10px rgba(0,0,0,0.9);\n      font-family: 'Montserrat', sans-serif;\n    }\n\n    /* --- DESTAQUE CURSIVO (EB Garamond) --- */\n    .text-block h2 em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      font-size: 86px;\n      color: #f0f0f0;\n      display: inline-block;\n\tletter-spacing: -2px;\n    }\n\n    /* --- SUBTÍTULO --- */\n    .text-block h3 {\n      font-size: 38px;\n      font-weight: 400;\n      line-height: 1.3;\n      font-family: 'EB Garamond', serif;\n      margin-top: 20px;\n      color: #eaeaea;\n      text-shadow: 1px 1px 6px rgba(0,0,0,0.8);\n      letter-spacing: 1px;\n    }\n\n    .text-block h3 b {\n      color: #ffffff;\n      font-weight: 600;\n      font-family: 'EB Garamond', serif;\n    }\n\n  </style>\n</head>\n\n<body>\n  <div class=\"image-container\">\n    <div class=\"overlay-dark\"></div>\n    <div class=\"overlay-gradient\"></div>\n\n    <img class=\"logo\" src=\"https://i.ibb.co/XfPKQQ9v/imgjournal-removebg-preview.png\" alt=\"Logo Finamob\" />\n\n    <div class=\"text-block\">\n      <h2>{{ $('Consolidador').item.json.titulo }}</h2>\n      <h3>{{ $('Consolidador').item.json.subtitulo_formatado }}</h3>\n    </div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[10624,2160],"id":"de1ec19f-2407-461f-a252-cc8096b7affc","name":"(Introdução) Criação do HTML da Imagem"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_3 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[9824,1664],"id":"da31709b-b790-47cc-bce3-f82bd106030a","name":"(Aplicabilidade) Buscar Imagem Unsplash"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_2 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[9856,1216],"id":"ce9c1bd7-b6ec-4cd5-8caa-581da70beda0","name":"(Desenvolvimento) Buscar Imagem Unsplash"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[10064,1664],"id":"b5a67854-8acb-4f5a-85f4-cae678bdae06","name":"Processar Resultado Unsplash (URL)1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[10096,1216],"id":"cfff8166-a969-4582-a8d9-3ebab8ac4f39","name":"Processar Resultado Unsplash (URL)"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"finamob","mode":"list","cachedResultName":"finamob","cachedResultUrl":"https://github.com/getmia-ia/finamob"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[11344,464],"id":"4ff26599-b54c-43e9-804e-faf6766a1815","name":"Salvar imagem no GitHub1","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"finamob","mode":"list","cachedResultName":"finamob","cachedResultUrl":"https://github.com/getmia-ia/finamob"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[11376,1136],"id":"7ca818fa-8a95-43ce-b0cb-5411e890afd1","name":"Salvar imagem no GitHub2","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"properties\": {\n    \"query_slide_2\": {\n      \"type\": \"string\",\n      \"description\": \"Query para slide 2\"\n    },\n    \"query_slide_3\": {\n      \"type\": \"string\", \n      \"description\": \"Query para slide 3\"\n    },\n    \"query_slide_1_backup\": {\n      \"type\": \"string\",\n      \"description\": \"Query backup para slide 1 (QUANDO PRECISA UNSPLASH)\"\n    },\n    \"imagem\": {\n      \"type\": \"string\",\n      \"description\": \"URL imagem original (QUANDO NÃO PRECISA UNSPLASH)\"\n    }\n  },\n  \"required\": [\"query_slide_2\", \"query_slide_3\"]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[9456,1184],"id":"6f30878e-4ed0-481d-b9a3-b4b8b0fe5422","name":"Structured Output Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Verifica se a notícia aprovada tem imagem\nconst noticia = $json;\n\nreturn {\n  json: {\n    ...noticia,\n    // Flag para decisão posterior\n    tem_imagem_original: !!(noticia.imagem && noticia.imagem.trim() !== ''),\n    // Mantém dados para Unsplash se necessário\n    titulo_unsplash: noticia.titulo,\n    desenvolvimento_unsplash: noticia.titulo_desenvolvimento,\n    aplicabilidade_unsplash: noticia.titulo_aplicabilidade\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[7232,2528],"id":"3bfd4398-67b2-4ab5-b819-67d9e686e2b8","name":"Decisão de Imagem"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d8dd0e8-5d68-4872-99e9-1927d3f4315c","leftValue":"={{ $json.tem_imagem_original }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[7424,2400],"id":"ac38ab21-a8ac-4032-98b8-6697aa883683","name":"Tem imagem?"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Analisador de Qualidade de Imagem para Redes Sociais\n\nParâmetros:\n\n    Função: Avaliador de qualidade de imagem\n\n    Tarefa: Analisar a imagem e dar uma nota de 0 a 10 considerando sua adequação para redes sociais\n\nCritérios de Avaliação:\n\n    Qualidade técnica (nitidez, foco, iluminação)\n\n    Composição visual (enquadramento, equilíbrio, estética)\n\n    Apelo visual para redes sociais\n\n    Cores e contraste\n\n    Potencial de engajamento\n\nClassificação:\n\n    Nota > 7 → \"bom\"\n\n    Nota ≤ 7 → \"ruim\"\n\n    Imagem totalmente preta → automaticamente \"ruim\"\n\nResposta:\n\n    Apenas uma palavra: \"bom\" ou \"ruim\"\n","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[7696,2272],"id":"f86d4e6b-46f2-44cb-8de1-746a7b835a0f","name":"Analyze image2","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"bom","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[7904,2272],"id":"d18f684a-1a60-4187-8cb2-64e27a65e2e5","name":"Imagem é boa?"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[8672,2512],"id":"f09dbc1c-8349-42e5-8116-18cc6fbdf7af","name":"Consolidador"},{"parameters":{"assignments":{"assignments":[{"id":"09010a96-1a0a-400e-9b4f-d0b282c7f3e1","name":"precisa_unsplash","value":true,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[8160,2416],"id":"dc491622-2db0-4d8f-b7c0-1b1f06f4e967","name":"Precisa do Unsplash?"},{"parameters":{"content":"## Verifica se precisa do unsplash para a primeira imagem","height":1024,"width":1728,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[7168,2048],"id":"d1401ecd-0643-4615-9d84-d10c4b19bc4a","name":"Sticky Note1"},{"parameters":{"assignments":{"assignments":[{"id":"265c256e-8a6a-43a2-8fc2-c8903993ad93","name":"precisa_unsplash","value":false,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[8160,2256],"id":"7ba704a4-2766-40c7-acd7-a334b2113b67","name":"Precisa do Unsplash?2"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[9984,2096],"id":"82e74a26-968e-4746-ae9f-b9357cc0d746","name":"Processar Resultado Unsplash (URL)2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e619bdff-dda2-43d6-8b48-3c7d6a9f18f6","leftValue":"={{ $json.output.query_slide_1_backup }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[9424,2240],"id":"a5e47422-1236-496d-9809-265f9822736a","name":"Precisa do Unsplash?3"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0","mode":"list","cachedResultName":"Finamob - Controle Journal","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"base","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1Ze1MFqVlu21qakfTTE5ECfAu4iFOoeQMygOCjPW5nek/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{"noticia_id":"={{ $json.noticia_id }}","data_processamento":"={{ $json.data_processamento }}","titulo":"={{ $json.titulo }}","legenda":"={{ $json.legenda }}","fonte":"={{ $json.fonte }}","imagem":"={{ $json.imagem }}","arquivo_base64":"={{ $json.arquivo_base64 }}","arquivo2_base64":"={{ $json.arquivo2_base64 }}","arquivo3_base64":"={{ $json.arquivo3_base64 }}","imagem_url":"={{ $json.imagem_url }}","imagem_url2":"={{ $json.imagem_url2 }}","imagem_url3":"={{ $json.imagem_url3 }}","status":"={{ $json.status }}","nota":"={{ $json.nota }}"},"matchingColumns":[],"schema":[{"id":"noticia_id","displayName":"noticia_id","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"data_processamento","displayName":"data_processamento","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"titulo","displayName":"titulo","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"legenda","displayName":"legenda","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"fonte","displayName":"fonte","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem","displayName":"imagem","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"arquivo_base64","displayName":"arquivo_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"arquivo2_base64","displayName":"arquivo2_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"arquivo3_base64","displayName":"arquivo3_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"imagem_url","displayName":"imagem_url","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url2","displayName":"imagem_url2","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url3","displayName":"imagem_url3","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"nota","displayName":"nota","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"justificativa","displayName":"justificativa","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"output","displayName":"output","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[13792,1904],"id":"52b68f48-f5f8-4ee6-9834-c36c0e00cc6c","name":"Salvar no Sheets Controle","credentials":{"googleSheetsOAuth2Api":{"id":"de8CYZ2v6bGWBjAX","name":"Google Sheets - lucas@getmia.com.br"}}},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_1_backup }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[9792,2096],"id":"f65e367a-f9c9-40d6-8605-567205f30c5b","name":"(Introdução) Buscar Imagem Unsplash"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[8416,2400],"id":"e7ad4ae0-1a78-4cf9-85b2-24ee6816f442","name":"Consolidador1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\n\n// 🔒 Gerar um identificador aleatório curto para evitar colisões\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nconst base = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}`;\nconst sequencial = String($input.item.index + 1).padStart(3, '0');\nconst noticia_id = `${base}_${sequencial}`;\n\n// Item atual\nconst item = $input.item.json;\n\n// URLs específicas deste item (agora temos 3 imagens)\nconst imagem_url1 = item.download_url || '';\nconst imagem_url2 = item.download_url1 || '';\nconst imagem_url3 = item.download_url2 || '';\n\n// Cria nomes de arquivo para os 3 base64\nconst arquivo_base64 = `${noticia_id}_img1.txt`;\nconst arquivo2_base64 = `${noticia_id}_img2.txt`; \nconst arquivo3_base64 = `${noticia_id}_img3.txt`;\n\n// Dados para a planilha\nconst planilhaData = {\n  noticia_id: noticia_id,\n  data_processamento: dataAgora.toLocaleDateString('pt-BR'),\n  titulo: item.titulo || '',\n  titulo_desenvolvimento: item.titulo_desenvolvimento || '',\n  titulo_aplicabilidade: item.titulo_aplicabilidade || '',\n  legenda: item.legenda || '',\n  fonte: item.fonte || '',\n  imagem: item.imagem || '',\n  arquivo_base64,\n  arquivo2_base64,\n  arquivo3_base64,\n  imagem_url: imagem_url1,\n  imagem_url2,\n  imagem_url3,\n  status: item.status || 'aguardando',\n  nota: item.nota || '',\n};\n\n// Retorno completo\nreturn {\n  json: {\n    ...item,\n    noticia_id,\n    status: item.status || 'aguardando',\n    imagem_url1,\n    imagem_url2, \n    imagem_url3,\n    imagem_url: imagem_url1,\n    planilha_data: planilhaData,\n    drive_file_1: {\n      file_name: arquivo_base64,\n      file_content: item.base64Image || ''\n    },\n    drive_file_2: {\n      file_name: arquivo2_base64, \n      file_content: imagem_url2 || ''\n    },\n    drive_file_3: {\n      file_name: arquivo3_base64,\n      file_content: imagem_url3 || ''\n    }\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[13328,1744],"id":"63138039-9087-424d-a958-8f14f0441dd1","name":"Criação Id + Link Github"},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_1.file_content }}","name":"={{ $json.drive_file_1.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf","mode":"list","cachedResultName":"finamob - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[13584,1744],"id":"bba7f359-9351-4a23-84be-eade94335a3b","name":"Envia base64 para o Drive","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_2.file_content }}","name":"={{ $json.drive_file_2.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf","mode":"list","cachedResultName":"finamob - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[13584,1568],"id":"b751b83e-b694-4c89-b40e-129315a976eb","name":"Envia base64 para o Drive1","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_3.file_content }}","name":"={{ $json.drive_file_3.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf","mode":"list","cachedResultName":"finamob - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1ufp07BeeG2fKZG43W_3Pgb0P5sgGv9sf"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[13584,1376],"id":"c3a2bbea-5772-4b47-b4e2-f20d1cc6e9ed","name":"Envia base64 para o Drive2","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[11392,656],"id":"e43e77f6-39ab-44f0-8d8d-f6cac323eed0","name":"Loop Over Items"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[11504,464],"id":"74ce6e8a-3b1a-446d-8728-3325a86ab45d","name":"Wait","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[11408,1328],"id":"29465609-47ef-4ded-8ba5-3e0a0fabf3ec","name":"Loop Over Items2"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[11520,1136],"id":"78fd4f3c-4748-442a-9352-3fd47db4b350","name":"Wait2","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nreturn items.map((item, i) => {\n  const temp_id = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}_${i+1}`;\n  return {\n    json: {\n      ...item.json,\n      temp_id,\n    },\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[8992,2512],"id":"9acf028f-1a78-489d-a9be-c2fb0a3e2104","name":"temp_id"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12096,800],"id":"cde87049-52a3-4933-815c-93aa84943934","name":"Merge1","alwaysOutputData":false},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12112,1440],"id":"2561713f-a55e-4cc7-a42c-edb811dfec62","name":"Merge2"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12480,1104],"id":"bd5ee817-78bd-4254-8ea7-f53ff81cd63d","name":"Merge3"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12128,2064],"id":"20eab807-1f53-444b-b3e0-ce1ca3f3ab49","name":"Merge4"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12880,1760],"id":"6f3d2d4e-9bd6-4ad1-9b7c-ee88a78e5f3f","name":"Merge5"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[12512,2496],"id":"339acd81-8076-4b4e-9174-b951d7729825","name":"Merge6"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[10192,2240],"id":"2ff25ffe-a80e-479b-ba41-f86d0bbb4a34","name":"Merge7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[11408,1920],"id":"b8eb89f7-2908-431d-88b1-a63a7f49caa6","name":"Loop Over Items3"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[11520,1728],"id":"35476a94-b51a-415e-9037-be5b37c1c918","name":"Wait3","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[10288,1216],"id":"eb244065-ce2d-43e0-a96e-1f3c81cea76b","name":"Tem img?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[10240,1664],"id":"7c705f96-d3f2-459d-bcad-e75e14793494","name":"Tem img?1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"9c2eeca7-eb95-4d4a-aa85-9046491721e4","leftValue":"={{ $json.output.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[10384,2240],"id":"7b2a273c-640e-436c-afe2-e28d9a23b18e","name":"Tem img?2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f6646cb8-557a-46f3-bddc-461bdfd44764","leftValue":"={{ $json.download_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"c45dde80-b316-4613-98d1-8200f27afcd7","leftValue":"={{ $json.download_url1 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"4e9d9762-241e-4977-aabd-3cd4417635a6","leftValue":"={{ $json.download_url2 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[13088,1760],"id":"53816d37-5899-4a1f-b906-c61037b09b29","name":"Tem todas as imgs?"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1,"position":[9392,1584],"id":"d1a1360c-12f4-4ecd-9e96-740a91a9e5f7","name":"Think"}],"connections":{"RSS Folha":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":1}]]},"RSS Investing":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":0}]]},"RSS Metro Quadrado":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":2}]]},"Schedule Trigger":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]},"No Operation, do nothing":{"main":[[{"node":"RSS Folha","type":"main","index":0},{"node":"RSS Metro Quadrado","type":"main","index":0},{"node":"RSS Investing","type":"main","index":0},{"node":"RSS Papo Imobiliário","type":"main","index":0},{"node":"RSS Exame","type":"main","index":0},{"node":"RSS Portal VGV","type":"main","index":0},{"node":"RSS infomoney","type":"main","index":0},{"node":"RSS Portal Money Times","type":"main","index":0},{"node":"RSS CBIC (Câmara Brasileira da Indústria da Construção)","type":"main","index":0},{"node":"RSS Startupi","type":"main","index":0},{"node":"RSS Globo G1","type":"main","index":0},{"node":"RSS BBC","type":"main","index":0},{"node":"RSS CNN","type":"main","index":0},{"node":"RSS Jornal do Oeste","type":"main","index":0},{"node":"RSS Senado","type":"main","index":0},{"node":"RSS Camara","type":"main","index":0},{"node":"RSS Camara Agro","type":"main","index":0},{"node":"RSS Camara Eleicoes","type":"main","index":0},{"node":"RSS Camara Adm Publica","type":"main","index":0},{"node":"RSS Camara Politica","type":"main","index":0},{"node":"RSS Camara Economia","type":"main","index":0},{"node":"RSS Camara Cidades","type":"main","index":0},{"node":"RSS Agencia Brasil","type":"main","index":0},{"node":"RSS The Guardian","type":"main","index":0},{"node":"RSS nytimes","type":"main","index":0},{"node":"RSS Deutsche Welle","type":"main","index":0},{"node":"RSS Al Jazeera","type":"main","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Estrutura dos Posts","type":"ai_languageModel","index":0}]]},"Notícias Consolidadas":{"main":[[{"node":"Notícias Consolidadas3","type":"main","index":0}]]},"AI Agent - Estrutura dos Posts":{"main":[[{"node":"Estruturação do JSON de saída","type":"main","index":0}]]},"RSS Papo Imobiliário":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":3}]]},"RSS Exame":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":4}]]},"RSS infomoney":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":5}]]},"RSS Portal VGV":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":6}]]},"RSS Portal Money Times":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":7}]]},"RSS CBIC (Câmara Brasileira da Indústria da Construção)":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":8}]]},"RSS Startupi":{"main":[[{"node":"Notícias Consolidadas","type":"main","index":9}]]},"Notícias Consolidadas1":{"main":[[{"node":"Notícias Consolidadas3","type":"main","index":1}]]},"Notícias Consolidadas2":{"main":[[{"node":"Notícias Consolidadas3","type":"main","index":2}]]},"RSS Globo G1":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":0}]]},"RSS Al Jazeera":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":6}]]},"RSS Deutsche Welle":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":5}]]},"RSS nytimes":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":4}]]},"RSS The Guardian":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":3}]]},"RSS Agencia Brasil":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":2}]]},"RSS Camara Cidades":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":1}]]},"RSS Camara Economia":{"main":[[{"node":"Notícias Consolidadas2","type":"main","index":0}]]},"RSS Camara Politica":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":9}]]},"RSS Camara Adm Publica":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":8}]]},"RSS Camara Eleicoes":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":7}]]},"RSS Camara Agro":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":6}]]},"RSS Camara":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":5}]]},"RSS Senado":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":4}]]},"RSS Jornal do Oeste":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":3}]]},"RSS CNN":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":2}]]},"RSS BBC":{"main":[[{"node":"Notícias Consolidadas1","type":"main","index":1}]]},"Notícias Consolidadas3":{"main":[[{"node":"Filtro de data da notícia","type":"main","index":0}]]},"Code":{"main":[[{"node":"Padronização do campo imagem","type":"main","index":0}]]},"Filtro de data da notícia":{"main":[[{"node":"Code","type":"main","index":0}]]},"Validação do campo imagem1":{"main":[[{"node":"Backup dados da notícia1","type":"main","index":0}],[{"node":"Analyze image4","type":"main","index":0}]]},"Backup dados da notícia1":{"main":[[{"node":"Buscar HTML da notícia","type":"main","index":0}]]},"Extrair imagem do HTML1":{"main":[[{"node":"Imagem encontrada?1","type":"main","index":0}]]},"Imagem encontrada?1":{"main":[[{"node":"Analyze image3","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":2}]]},"Analyze image3":{"main":[[{"node":"Imagem é boa?2","type":"main","index":0}]]},"Salvar imagem gerada":{"main":[[{"node":"Unificar imagem final1","type":"main","index":0}]]},"Analyze image4":{"main":[[{"node":"Imagem é boa?1","type":"main","index":0}]]},"Salvar imagem gerada6":{"main":[[{"node":"Unificar imagem final1","type":"main","index":3}]]},"Imagem é boa?1":{"main":[[{"node":"Salvar imagem gerada6","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":4}]]},"Imagem é boa?2":{"main":[[{"node":"Salvar imagem gerada","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":1}]]},"Padronização do campo imagem":{"main":[[{"node":"Validação do campo imagem1","type":"main","index":0}]]},"Buscar HTML da notícia":{"main":[[{"node":"Extrair imagem do HTML1","type":"main","index":0}]]},"Unificar imagem final1":{"main":[[{"node":"Impede que tupla undefined passe para o agente","type":"main","index":0}]]},"Filtro Relevância1":{"main":[[{"node":"AI Agent - Estrutura dos Posts","type":"main","index":0}]]},"Impede que tupla undefined passe para o agente":{"main":[[{"node":"AI Agent - Avaliação das notícias","type":"main","index":0}]]},"OpenRouter Chat Model1":{"ai_languageModel":[[{"node":"AI Agent - Avaliação das notícias","type":"ai_languageModel","index":0}]]},"AI Agent - Avaliação das notícias":{"main":[[{"node":"Estruturação do JSON de saída1","type":"main","index":0}]]},"Estruturação do JSON de saída1":{"main":[[{"node":"Filtro Relevância1","type":"main","index":0}]]},"Binary > base64":{"main":[[{"node":"Merge4","type":"main","index":1}]]},"HTML > Imagem":{"main":[[{"node":"Baixar imagem","type":"main","index":0}]]},"Baixar imagem":{"main":[[{"node":"Cortar imagem 1080x1350","type":"main","index":0}]]},"Salvar imagem no GitHub":{"main":[[{"node":"Wait3","type":"main","index":0}]]},"Filtro dos dados consolidados":{"main":[[{"node":"Salvar no Sheets Controle","type":"main","index":0}]]},"Cortar imagem 1080x1350":{"main":[[{"node":"Binary > base64","type":"main","index":0},{"node":"Loop Over Items3","type":"main","index":0}]]},"Create download_url":{"main":[[{"node":"Merge4","type":"main","index":0}]]},"AI Agent - Gerar prompts Unsplash":{"main":[[{"node":"(Desenvolvimento) Buscar Imagem Unsplash","type":"main","index":0},{"node":"(Aplicabilidade) Buscar Imagem Unsplash","type":"main","index":0},{"node":"Precisa do Unsplash?3","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_languageModel","index":0}]]},"Binary > base":{"main":[[{"node":"Merge1","type":"main","index":1}]]},"HTML > Imagem2":{"main":[[{"node":"Baixar imagem2","type":"main","index":0}]]},"Baixar imagem2":{"main":[[{"node":"Cortar imagem 1080x","type":"main","index":0}]]},"Cortar imagem 1080x":{"main":[[{"node":"Binary > base","type":"main","index":0},{"node":"Loop Over Items","type":"main","index":0}]]},"Create download_url1":{"main":[[{"node":"Merge1","type":"main","index":0}]]},"Binary > base1":{"main":[[{"node":"Merge2","type":"main","index":1}]]},"HTML > Imagem3":{"main":[[{"node":"Baixar imagem3","type":"main","index":0}]]},"Baixar imagem3":{"main":[[{"node":"Cortar imagem 1080x1","type":"main","index":0}]]},"Cortar imagem 1080x1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0},{"node":"Binary > base1","type":"main","index":0}]]},"Create download_url3":{"main":[[{"node":"Merge2","type":"main","index":0}]]},"(Desenvolvimento) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem2","type":"main","index":0}]]},"(Aplicabilidade) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem3","type":"main","index":0}]]},"(Introdução) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem","type":"main","index":0}]]},"(Aplicabilidade) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)1","type":"main","index":0}]]},"(Desenvolvimento) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)1":{"main":[[{"node":"Tem img?1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)":{"main":[[{"node":"Tem img?","type":"main","index":0}]]},"Salvar imagem no GitHub1":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Salvar imagem no GitHub2":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_outputParser","index":0}]]},"Decisão de Imagem":{"main":[[{"node":"Tem imagem?","type":"main","index":0},{"node":"Consolidador","type":"main","index":1}]]},"Tem imagem?":{"main":[[{"node":"Analyze image2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Analyze image2":{"main":[[{"node":"Imagem é boa?","type":"main","index":0}]]},"Imagem é boa?":{"main":[[{"node":"Precisa do Unsplash?2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Consolidador":{"main":[[{"node":"temp_id","type":"main","index":0}]]},"Precisa do Unsplash?":{"main":[[{"node":"Consolidador1","type":"main","index":1}]]},"Precisa do Unsplash?2":{"main":[[{"node":"Consolidador1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)2":{"main":[[{"node":"Merge7","type":"main","index":0}]]},"Precisa do Unsplash?3":{"main":[[{"node":"(Introdução) Buscar Imagem Unsplash","type":"main","index":0}],[{"node":"Merge7","type":"main","index":1}]]},"(Introdução) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)2","type":"main","index":0}]]},"Consolidador1":{"main":[[{"node":"Consolidador","type":"main","index":0}]]},"Criação Id + Link Github":{"main":[[{"node":"Filtro dos dados consolidados","type":"main","index":0},{"node":"Envia base64 para o Drive2","type":"main","index":0},{"node":"Envia base64 para o Drive1","type":"main","index":0},{"node":"Envia base64 para o Drive","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Create download_url1","type":"main","index":0}],[{"node":"Salvar imagem no GitHub1","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items2":{"main":[[{"node":"Create download_url3","type":"main","index":0}],[{"node":"Salvar imagem no GitHub2","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"temp_id":{"main":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"main","index":0},{"node":"Merge6","type":"main","index":1}]]},"Merge1":{"main":[[{"node":"Merge3","type":"main","index":0}]]},"Merge2":{"main":[[{"node":"Merge3","type":"main","index":1}]]},"Merge3":{"main":[[{"node":"Merge5","type":"main","index":0}]]},"Merge4":{"main":[[{"node":"Merge6","type":"main","index":0}]]},"Merge5":{"main":[[{"node":"Tem todas as imgs?","type":"main","index":0}]]},"Merge6":{"main":[[{"node":"Merge5","type":"main","index":1}]]},"Merge7":{"main":[[{"node":"Tem img?2","type":"main","index":0}]]},"Loop Over Items3":{"main":[[{"node":"Create download_url","type":"main","index":0}],[{"node":"Salvar imagem no GitHub","type":"main","index":0}]]},"Wait3":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Tem img?":{"main":[[{"node":"(Desenvolvimento) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem img?1":{"main":[[{"node":"(Aplicabilidade) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem img?2":{"main":[[{"node":"(Introdução) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem todas as imgs?":{"main":[[{"node":"Criação Id + Link Github","type":"main","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_tool","index":0}]]},"Estruturação do JSON de saída":{"main":[[{"node":"Decisão de Imagem","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"Cem9y3zmcggUQhrp"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2025-09-23T14:30:34.007-03:00","Readable date":"September 23rd 2025, 2:30:34 pm","Readable time":"2:30:34 pm","Day of week":"Tuesday","Year":"2025","Month":"September","Day of month":"23","Hour":"14","Minute":"30","Second":"34","Timezone":"America/Sao_Paulo (UTC-03:00)"}}]},"versionId":"8566fa87-7cd9-435c-9bb6-0a40576afff5","triggerCount":1,"tags":[]}