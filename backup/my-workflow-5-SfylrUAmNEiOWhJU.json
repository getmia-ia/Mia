{"createdAt":"2025-09-29T20:00:37.346Z","updatedAt":"2025-10-31T21:18:10.800Z","id":"SfylrUAmNEiOWhJU","name":"My workflow 5","active":false,"isArchived":false,"nodes":[{"parameters":{"content":"## Define e formata data/hora\nEsses nós são responsáveis por definir a data e hora atuais no formato dd-MM-yyyy/H:mm. A data e a hora são usadas para compor as mensagens de commit no GitHub, por exemplo: backup-12-07-2023/14:18.","height":288,"width":608,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1888,192],"id":"5be11a41-7f0c-45d2-a05f-3d7550b6f066","name":"Sticky Note"},{"parameters":{"options":{}},"id":"6e434dc5-f309-4020-97a3-9bac2ca8b29c","name":"Seta data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1824,336]},{"parameters":{"operation":"formatDate","date":"={{ $json.currentDate }}","format":"custom","customFormat":"dd-MM-yyyy/H:mm","options":{}},"id":"1ac64d9d-22d0-4100-8d73-33b04d554133","name":"Formata a data","type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-1632,336]},{"parameters":{"content":"## Fazer uma lista de arquivos existentes\nRetorna uma lista de arquivos existentes (backups) no repositório do GitHub. Os dados retornados por esses nós são usados pelo nó \"IF\" (mais adiante no fluxo) para verificar se os arquivos de backup devem ser criados ou atualizados.","height":288,"width":592,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-1216,192],"typeVersion":1,"id":"4ec723e7-e10c-4409-be7a-beba0b9524d3","name":"Sticky Note1"},{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-2048,336],"id":"6c101679-469f-45f6-a5a6-47434b87d1e5","name":"Schedule Trigger"},{"parameters":{"content":"## Recuperar workflows\nObtém todos os workflows da sua instância do n8n.\n","height":288,"width":544},"type":"n8n-nodes-base.stickyNote","position":[-592,192],"typeVersion":1,"id":"031e4722-2373-4f98-87a1-57c8245a4823","name":"Sticky Note2"},{"parameters":{"filters":{},"requestOptions":{}},"id":"88d801c0-d4ba-466e-9515-44d62271cd05","name":"Recupera Workflows - N8N","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[-496,336],"credentials":{"n8nApi":{"id":"y6IXIPdy2mck9iD2","name":"n8n account"}}},{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"}},"id":"a1ccf78a-fe58-4595-91a2-2946a0edf8bc","name":"Converte JSON para Binário","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[-288,336]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b1b3a3d2-e66f-46d5-bee4-9d3094ca7796","leftValue":"={{ $node['Combinar nomes de arquivos - GitHub'].json.name.toString() }}","rightValue":"={{ $binary.data.fileName }}","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[352,352],"id":"517230f1-bf36-4bf6-b5a6-8818a239665f","name":"Verifica se o arquivo existe no repositório"},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"edit","owner":{"__rl":true,"value":"=getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"=backup/{{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Seta a data de commit'].json.commitDate }}"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[608,96],"id":"b2bfcca8-92fa-4d3f-afb7-8a25e15c752a","name":"Atualiza arquivo - GitHub","webhookId":"0e93e1c8-fe06-493b-bb49-143e10c9e876","credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"=backup/{{ $binary.data.fileName }}","binaryData":true,"commitMessage":"=backup-{{ $node['Seta a data de commit'].json.commitDate }}"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[608,416],"id":"00224bf8-9a26-4203-aa22-29b7d214a410","name":"Cria/Sobe arquivo - GitHub","webhookId":"7130b789-579c-40ef-af12-fd772dea7042","credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"content":"## Enviar backup\nDivide os arquivos JSON em lotes de 1 e verifica se eles já foram enviados anteriormente para o repositório.\nSe sim (true), envia a nova versão do arquivo. Caso contrário (não / false), cria o arquivo no repositório.","height":608,"width":816,"color":4},"type":"n8n-nodes-base.stickyNote","position":[0,0],"typeVersion":1,"id":"6ab43b95-6e3e-4094-9cd1-27574eb72464","name":"Sticky Note3"},{"parameters":{"operation":"aggregateItems","fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"name"}]},"options":{}},"id":"ec68bdbe-8701-4950-a613-6c7fd488beb4","name":"Combinar nomes de arquivos 1- GitHub","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[-832,-64],"disabled":true},{"parameters":{"fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"name"}]},"options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[-816,336],"id":"53e9a02c-1b19-4828-96fe-9d01ba0e02f8","name":"Combinar nomes de arquivos - GitHub"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[64,336],"id":"04765fd0-a636-416c-83e4-8b48ee734695","name":"Loop Over Items"},{"parameters":{"authentication":"oAuth2","resource":"file","operation":"list","owner":{"__rl":true,"value":"getmia-ia","mode":"list","cachedResultName":"getmia-ia","cachedResultUrl":"https://github.com/getmia-ia"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"backup/"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[-1072,336],"id":"689fd26a-72a0-4bfc-82df-041df5afc611","name":"Lista de Arquivos","webhookId":"95d44b39-1838-4a53-a8dc-357bb8889321","credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"assignments":{"assignments":[{"id":"d59157ba-ded2-4037-a06b-80a884e1af49","name":"commitDate","value":"={{ $json.formattedDate }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1424,336],"id":"99c417d6-71b1-47e9-954b-3e061b7f7cae","name":"Seta a data de commit"}],"connections":{"Seta data":{"main":[[{"node":"Formata a data","type":"main","index":0}]]},"Formata a data":{"main":[[{"node":"Seta a data de commit","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Seta data","type":"main","index":0}]]},"Recupera Workflows - N8N":{"main":[[{"node":"Converte JSON para Binário","type":"main","index":0}]]},"Converte JSON para Binário":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Verifica se o arquivo existe no repositório":{"main":[[{"node":"Atualiza arquivo - GitHub","type":"main","index":0}],[{"node":"Cria/Sobe arquivo - GitHub","type":"main","index":0}]]},"Atualiza arquivo - GitHub":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Cria/Sobe arquivo - GitHub":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Combinar nomes de arquivos 1- GitHub":{"main":[[]]},"Combinar nomes de arquivos - GitHub":{"main":[[{"node":"Recupera Workflows - N8N","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Verifica se o arquivo existe no repositório","type":"main","index":0}]]},"Lista de Arquivos":{"main":[[{"node":"Combinar nomes de arquivos - GitHub","type":"main","index":0}]]},"Seta a data de commit":{"main":[[{"node":"Lista de Arquivos","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"19bb51eb-c534-40d2-b6d7-99fb3e548b45","triggerCount":0,"tags":[]}