{"createdAt":"2025-09-03T19:11:45.899Z","updatedAt":"2025-09-29T20:11:39.126Z","id":"U9kToHwVORLgbL7H","name":"2.3 - BMS - Calculadora de Beneficios","active":false,"isArchived":true,"nodes":[{"parameters":{},"id":"3239efbf-86b1-42a8-91d3-91eeaff1cfa9","name":"Executa Workflow","type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1,"position":[16,-16]},{"parameters":{"assignments":{"assignments":[{"id":"81416485-6e75-43e6-ab2f-6d2d9130f12c","name":"response","value":"={{ $json.output }}","type":"string"}]},"options":{}},"id":"1ea98500-678d-4d46-87c1-6bddc8e5d32b","name":"Resposta Positiva","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[896,-16]},{"parameters":{"promptType":"define","text":"=Você é uma Calculadora de Benefícios Previdenciários especializada nas regras do INSS (CLT padrão).\n\nInputs recebidos:\n\nIdade (anos): {{ $json.idade }}\n\nSexo: {{ $json.sexo }}\n\nTempo total de contribuição (anos + meses): {{ $json.tempoContribuicao }}\n\nSalário médio de contribuição (últimos salários ou média): {{ $json.salarioMedio }}\n\nTarefas a executar:\n\nVerificar elegibilidade para aposentadoria:\n\nHomens: idade mínima de 65 anos + pelo menos 35 anos de contribuição.\n\nMulheres: idade mínima de 62 anos + pelo menos 30 anos de contribuição.\n\nSe os requisitos ainda não forem cumpridos, calcule quanto tempo falta (em anos e meses) para atingir o requisito mais restritivo.\n\nCalcular o Salário de Benefício (SB):\n\nSB = média de todos os salários de contribuição informados (já vem no input como salarioMedio).\n\nAplicar fórmula da aposentadoria (regra geral pós-reforma):\n\nValor inicial = 60% do SB.\n\nAcrescentar +2% por ano de contribuição que ultrapassar:\n\n20 anos (homens)\n\n15 anos (mulheres)\n\nAplicar o teto do INSS:\n\nO benefício nunca pode ultrapassar o teto previdenciário vigente.\n\nPara referência, considere o teto de R$ 7.786,02 (ano 2025).\n\nGerar logs explicativos:\n\nMostrar passo a passo o raciocínio usado, incluindo:\n\nIdade e tempo de contribuição.\n\nPercentual aplicado (60% + adicional).\n\nSalário médio informado.\n\nAplicação do teto (se houve).\n\nOutput esperado:\n\nSempre retorne em formato JSON estruturado com os campos:\n\n{\n  \"tipoBeneficio\": \"Aposentadoria por Idade e Tempo de Contribuição\",\n  \"valorEstimado\": 0,\n  \"tempoRestante\": \"X anos e Y meses\",\n  \"logs\": [\n    \"Idade atual: ...\",\n    \"Tempo de contribuição: ...\",\n    \"Regra aplicada: 60% + 2% por ano acima de ...\",\n    \"Salário médio considerado: ...\",\n    \"Teto do INSS aplicado: ...\"\n  ]\n}\n\n\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[464,-16],"id":"0359006b-d05b-40a7-8d0e-b891f1dbcc95","name":"AI Agent"},{"parameters":{"model":"openai/gpt-4o-mini","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[464,192],"id":"7aef3286-762e-48c1-b08e-f737a9ebf477","name":"OpenRouter Chat Model","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"jsCode":"// Pega o campo \"query\" como string\nconst raw = $json.query;\n\n// Converte a string em objeto JSON\nconst input = JSON.parse(raw);\n\n// Normaliza os dados\nreturn [{\n  json: {\n    idade: Number(input.idade),\n    sexo: input.sexo,\n    tempoContribuicao: Number(input.tempo_contribuicao),\n    salarioMedio: Number(input.salario_medio)\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[240,-16],"id":"5ac58c1d-7ec5-4eaf-a4a8-476b272fbb56","name":"Code"},{"parameters":{"height":960,"width":1168},"type":"n8n-nodes-base.stickyNote","position":[-64,-496],"typeVersion":1,"id":"bf52866e-da09-4ea3-94ed-5545802dd982","name":"Sticky Note"}],"connections":{"Executa Workflow":{"main":[[{"node":"Code","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"Resposta Positiva","type":"main","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Code":{"main":[[{"node":"AI Agent","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"GbORhS24Rzw7hHlt"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"d9777daa-8888-4b29-98b5-b622616492cd","triggerCount":0,"tags":[]}