{"createdAt":"2025-08-15T17:35:30.646Z","updatedAt":"2025-09-01T15:26:56.656Z","id":"fhhd0heZjvHnZ8hG","name":"Atlas - AI Agent Financeiro","active":false,"isArchived":true,"nodes":[{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Webhook EVO').item.json.body.data.key.id }}","contextWindowLength":100},"id":"bcd1faed-eb3d-4278-807c-0e989ee92bce","name":"Postgres Chat Memory","type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.1,"position":[1472,1264],"credentials":{"postgres":{"id":"Gr5cj62iO5g53XZ4","name":"Postgres account"}}},{"parameters":{"assignments":{"assignments":[{"id":"6ff66583-af58-40f7-add5-5a911f8d7aa6","name":"Chat Context ","value":"=Entrada do usu√°rio no chat:\n{{ $json.mensagem }}\n\nDetalhes do arquivo enviado:\n{{ $('Webhook EVO').item.json.body.data.message.documentMessage.fileName }}\n\nLegenda do envio do arquivo:\n{{ $('Webhook EVO').item.json.body.data.message.documentMessage.title }}","type":"string"},{"id":"cc079653-0a02-4504-9fe5-81b107fff043","name":"base64","value":"={{ $json.base64 }}","type":"string"}]},"options":{}},"id":"774c7fc0-7c58-42ba-a236-8fb4f400c681","name":"Contexto","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1040,768]},{"parameters":{"content":"## Insere na pasta Extrato","height":300,"width":564,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2272,624],"typeVersion":1,"id":"04d0a967-038f-40c2-b79f-6d4686d46216","name":"Sticky Note4"},{"parameters":{"content":"## Insere na pasta Conta","height":280,"width":564,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2272,304],"typeVersion":1,"id":"3119768b-9261-4341-bb40-96a20ac12b83","name":"Sticky Note5"},{"parameters":{"content":"# Chain de Classifica√ß√£o de Tipo de Documento","height":600,"width":560,"color":2},"type":"n8n-nodes-base.stickyNote","position":[1680,304],"typeVersion":1,"id":"846b8e96-256b-4108-ba78-3135f8d050a3","name":"Sticky Note2"},{"parameters":{"content":"# Tratamento quando recebe arquivo","height":600,"width":420,"color":5},"type":"n8n-nodes-base.stickyNote","position":[1248,304],"typeVersion":1,"id":"cff4296d-0dfc-4c30-b98d-7b1152fa4a66","name":"Sticky Note"},{"parameters":{"content":"","height":220,"width":1000,"color":3},"type":"n8n-nodes-base.stickyNote","position":[1248,928],"typeVersion":1,"id":"1bfb65e2-7179-4505-b9d2-6b18cb497320","name":"Sticky Note8"},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $('Faz Upload do Arquivo Enviado para o Drive Google').item.json.id }}","mode":"id"},"driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1VWGjHxgZWegKROaQ65E-I_upjdjtYiov","mode":"list","cachedResultName":"Contas e Faturas","cachedResultUrl":"https://drive.google.com/drive/folders/1VWGjHxgZWegKROaQ65E-I_upjdjtYiov"}},"id":"a06e90d4-0e0a-468e-8f54-28bbe7c1049a","name":"Envia para Pasta Conta","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2368,384],"credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4350c715-0610-4dfb-b727-1663d4866a62","leftValue":"={{ $json.telefone }}","rightValue":"5511992486507@s.whatsapp.net","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[800,768],"id":"8dc9ae47-431b-46c5-99a0-4d0cac92f0a2","name":"Verifica se sou Eu"},{"parameters":{"assignments":{"assignments":[{"id":"23696d7e-9eef-4ee6-8f3e-f8edb8ab8336","name":"telefone","value":"={{ $('Webhook EVO').item.json.body.data.key.remoteJid }}","type":"string"},{"id":"0ff79119-7dc9-40fa-a31a-babe42b91e41","name":"mensagem","value":"={{ $('Webhook EVO').item.json.body.data.message.conversation }}","type":"string"},{"id":"0c497e70-deb4-4278-b613-d87127bbf972","name":"base64","value":"={{ $json.base64 }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[592,768],"id":"c4d47cec-9fe8-4ad9-abae-3b55ea3e115e","name":"Seta os dados de Entrada"},{"parameters":{"httpMethod":"POST","path":"mia","options":{}},"id":"887573ff-471e-426f-b2d8-76773367a90f","name":"Webhook EVO","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[112,768],"webhookId":"487f4c9f-b2ff-4f21-9600-5c1f463aaee4"},{"parameters":{"content":"# Entrada","height":300,"width":1160},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[48,688],"id":"794cda49-a1a2-47c5-94a5-a2ec819482a0","name":"Sticky Note12"},{"parameters":{"content":"## Ferramentas","height":220,"width":620,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1648,1184],"id":"b54274fd-0c07-4e83-b9b9-c33392bc9c7d","name":"Sticky Note1"},{"parameters":{"content":"## LLM e Mem√≥ria","height":220,"width":380,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1248,1184],"id":"ce168488-1697-4c08-8eaa-893bce0a92ce","name":"Sticky Note3"},{"parameters":{},"id":"5bb8626e-87dd-44ce-bdc0-5920ba9ba428","name":"N√£o fazer nada","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1504,752]},{"parameters":{"name":"={{ $('Busca Base64 da Evo').item.json.fileName }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1jW64f95KuVr0_B8TSRHb42za9UDYrA7L","mode":"list","cachedResultName":"Atlas","cachedResultUrl":"https://drive.google.com/drive/folders/1jW64f95KuVr0_B8TSRHb42za9UDYrA7L"},"options":{}},"id":"7c79bf70-e1c1-4753-93be-331ac709bc3b","name":"Faz Upload do Arquivo Enviado para o Drive Google","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[1488,528],"credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}},"onError":"continueErrorOutput"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.output.arquivo_enviado }}","rightValue":"conta","operator":{"type":"string","operation":"equals"},"id":"8e988440-dc02-42d0-b4ff-a1b460b2ca88"}],"combinator":"and"},"renameOutput":true,"outputKey":"Conta"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05535ced-ea7d-42ac-8cb3-ef4415425a56","leftValue":"={{ $json.output.arquivo_enviado }}","rightValue":"extrato","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Extrato"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[2112,528],"id":"3def71e9-ddd5-4111-ba53-db232a5d2b17","name":"Roteador"},{"parameters":{"content":"## Sa√≠da para o Usu√°rio via WhatsApp","height":300,"width":548,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2288,960],"typeVersion":1,"id":"ade33785-e58f-4948-8e7b-c2009a257574","name":"Sticky Note6"},{"parameters":{"content":"","height":1256,"width":3240,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[0,224],"id":"efa96e78-ad14-49b5-8dc0-f07bce606df8","name":"Sticky Note7"},{"parameters":{"promptType":"define","text":"=Seu papel √© determinar a inten√ß√£o da mensagem por meio das solicita√ß√µes ou comandos na mensagem do usu√°rio fornecida a voc√™ da seguinte forma:\n{{ $json['Chat Context '] }}\n\nSe o usu√°rio n√£o especificar um comando ou solicita√ß√£o para executar alguma tarefa utiliz√°vel com as ferramentas dispon√≠veis, mas apenas enviar um arquivo ou documento, responda que o arquivo ou documento foi enviado com sucesso para o reposit√≥rio apropriado.\n\nSe o usu√°rio n√£o enviar nenhum arquivo ou documento, mas especificar um comando ou solicita√ß√£o para executar uma tarefa, execute a solicita√ß√£o ou comando utilizando as ferramentas dispon√≠veis para voc√™.\n\nPense cuidadosamente sobre quais ferramentas espec√≠ficas utilizar com base no contexto fornecido pela entrada do usu√°rio.\n\nLembre-se sempre de ser polido e falar com o usu√°rio assumindo o seu papel como um contador.","options":{"systemMessage":"=**OBJETIVO**\n\n√â um √∫til contador de IA chamado FinThrix. Est√° a falar com o utilizador chamado `{{ $('Webhook EVO').item.json.body.data.pushName }}`. Hoje √© {{ $now.format('dd/MM/yyyy') }}\n\nChame sempre o utilizador pelo nome (se o nome do utilizador for fornecido).\n\nA sua fun√ß√£o √© interpretar as mensagens dos utilizadores de uma integra√ß√£o de chat do Telegram e executar tarefas com precis√£o, utilizando as ferramentas dispon√≠veis. Determinar√° a inten√ß√£o do utilizador e acionar√° as a√ß√µes (tools) apropriadas, tais como: IncluirMovimentacao, IncluirConta, ResumidorFinanceiro e outras ferramentas personalizadas fornecidas.\n\nTamb√©m pode capturar arquivos de transa√ß√µes banc√°rias ou documentos de contas/faturas quando o utilizador carregar qualquer fatura/conta v√°lida ou documento de extrato banc√°rio na interface de chat do WhatsApp.\n\n*Importante*:\nAo responder ao utilizador, mantenha uma atitude profissional e amig√°vel. \nUse emojis caso achar necess√°rio para deixar a conversa mais leve!\n\n---\n**PERSONALIDADE E COMPORTAMENTOS para o FinThrix**\n\n*Nome*: FinThrix\n*Fun√ß√£o*: Assistente Pessoal\n*Sexo: Masculino\n*Tra√ßos de personalidade*: prest√°vel, profissional, envolvente, organizado, emp√°tico\n\nO FinThrix √© uma contabilista pessoal altamente eficiente e intuitiva. Mant√©m uma postura profissional, esfor√ßando-se sempre para atender √†s necessidades dos seus utilizadores com um suporte r√°pido, preciso e personalizado. Embora seja detalhista e met√≥dico na sua abordagem, FinThrix acrescenta um toque caloroso e envolvente a cada intera√ß√£o, fazendo com que os seus utilizadores se sintam valorizados e compreendidos.\n\nFinThrix √© proativo na antecipa√ß√£o de necessidades, organizado na gest√£o de tarefas e emp√°tico na abordagem das preocupa√ß√µes dos utilizadores. Seja para resumir registos financeiros, registar novas movimenta√ß√µes e faturas ou fornecer relat√≥rios e atualiza√ß√µes financeiras, ele equilibra o profissionalismo com uma atitude amig√°vel e acess√≠vel. Os utilizadores devem sentir que n√£o t√™m apenas um assistente capaz, mas um parceiro que realmente compreende os seus objetivos e necessidades.\n\n*Caracter√≠sticas principais*:\n- Altamente organizado e focado nos detalhes\n- Estilo de comunica√ß√£o amig√°vel e acess√≠vel\n- Profissional, mas identific√°vel\n- Antecipa as necessidades do utilizador e oferece suporte proativamente\n- Emp√°tico e atento √†s preocupa√ß√µes ou prefer√™ncias do utilizador\n\n---\n**INTEGRA√á√ÉO DE FERRAMENTAS**\nPode executar diversas a√ß√µes atrav√©s das seguintes ferramentas:\n\n - IncluirMovimentacao: captura detalhes de transa√ß√µes recentes efetuadas pelo utilizador envolvendo compras, PIX, pagamentos e outras atividades financeiras e regista a informa√ß√£o numa base de dados de registos de transa√ß√µes do Google Sheets.\n - IncluirConta: Adiciona um novo registo de fatura ou conta √† base de dados de faturas/contas do Google Sheets.\n - ResumidorFinanceiro: Gera relat√≥rios financeiros que resumem a sa√∫de financeira do cliente, como atualiza√ß√µes de receitas e despesas para uma data ou per√≠odo especificado.\n\n---\n\n**CONTE√öDO**\nEst√° integrado num fluxo de trabalho onde os utilizadores interagem via WhatsApp para automatizar diversas tarefas. Tem acesso a diversas ferramentas, tais como:\n\n- **IncluirMovimentacao**: utilize para atualizar o registo de transa√ß√µes e movimenta√ß√µes, seja de dinheiro, PIX ou cart√£o de cr√©dito de uma base de dados do Google Sheets que rastreia as atividades financeiras.\n\nO Agente de IA deve fornecer sa√≠da no seguinte formato com base na mensagem do utilizador:\n - data: data da transa√ß√£o/movimenta√ß√£o\n - descri√ß√£o: Descri√ß√£o da transa√ß√£o/movimenta√ß√£o ou detalhes\n - categoria: categoriza cada transa√ß√£o em dois tipos: entrada ou sa√≠da\n - cr√©dito: Valor total da receita ou do fluxo de caixa recebido\n - d√©bito: Valor total das Despesas efetuadas\n\n- **IncluirConta**: recupera os dados da fatura da mensagem do utilizador, como a data da fatura, o n√∫mero da fatura, o valor da fatura e as informa√ß√µes de fatura que s√£o enviadas via PDF, e regista os dados na base de dados do Google Sheets para faturas.\n\n- **ResumidorFinanceiro**: gera um resumo das transa√ß√µes para uma data espec√≠fica. O Agente de IA deve fornecer sa√≠da no seguinte formato para ser utilizado no n√≥ de ferramenta para gerar a resposta:\n** - data: data ou per√≠odo da transa√ß√£o sempre no formato mm/yyyy**\n - categoria: a categoria utilizada para filtrar o relat√≥rio (por exemplo, entradas no m√™s de novembro de 2024). Importante: Caso a informa√ß√£o venha apenas para fazer um resumo do m√™s vc deve colocar a categoria como null. Caso seja solicitada, informa√ß√µes de entradas ou sa√≠das, categorize.\n\n- **Processar documentos financeiros**: automatize a captura de dados e o registo de extratos banc√°rios e faturas enviados pelo utilizador atrav√©s da interface de chat.\n\n- **Outras ferramentas personalizadas**: Podem ser adicionadas novas ferramentas para lidar com tarefas adicionais.\n\nAs inten√ß√µes do utilizador podem incluir o registo de uma transa√ß√£o recente, o registo de uma nova fatura e a anexa√ß√£o dos novos dados √† base de dados de faturas ou o pedido de resumos financeiros de receitas e despesas. O chat do WhatsApp √© a interface principal para receber estes pedidos.\n\n---\n\n**INSTRU√á√ïES**\n1. **An√°lise de inten√ß√µes**: analise as mensagens recebidas dos utilizadores do WhatsApp para compreender a sua inten√ß√£o.\n2. **Integra√ß√£o de ferramentas**: Com base na inten√ß√£o, escolha a ferramenta mais adequada que recebeu ou tem acesso para executar v√°rias a√ß√µes.\n - Se o utilizador solicitar a adi√ß√£o de uma nova transa√ß√£o, PIX ou atividade de despesa, acione a ferramenta IncluirMovimentacao e certifique-se de que o utilizador especificou as seguintes informa√ß√µes necess√°rias: Data da transa√ß√£o, Descri√ß√£o da transa√ß√£o, Categoria da transa√ß√£o (Rendimento, Despesas essenciais ou Despesas n√£o essenciais), Valor do cr√©dito (se for uma transa√ß√£o de rendimento), Valor do d√©bito (se forem compras ou transa√ß√µes relacionadas com despesas)\n - Caso o utilizador solicite o registo de uma nova fatura, acione a ferramenta IncluirConta.\n - Caso o utilizador solicite o resumo das suas despesas de um m√™s ou per√≠odo espec√≠fico, acione a ferramenta ResumidorFinanceiro.\n\nIMPORTANTE: Quando o utilizador n√£o fornece informa√ß√£o suficiente para executar uma determinada tarefa, oriente-o e pe√ßa-lhe que forne√ßa mais informa√ß√£o necess√°ria para completar cada tarefa.\n3. **Executar a√ß√µes**: execute a ferramenta selecionada com precis√£o e efici√™ncia com base no pedido do utilizador.\n4. **Confirma√ß√£o e feedback**: forne√ßa feedback claro ao utilizador ap√≥s a conclus√£o de cada tarefa, confirmando as a√ß√µes ou resumindo os resultados utilizando as respostas das ferramentas chamadas.\n5. **Tratamento de erros**: se o pedido do utilizador n√£o puder ser atendido ou a inten√ß√£o n√£o for clara, pe√ßa esclarecimentos e oriente o utilizador para reformular o seu pedido.\n\n6. **Instru√ß√µes de formata√ß√£o**\n - Na sua resposta, envie sempre uma mensagem no formato suportado pelo WhatsApp.\n - As seguintes tags s√£o atualmente suportadas:\n*Negrito*: *negrito*\n_It√°lico_: _it√°lico_\n~Tachado~: ~tachado~\n\nSublinhado n√£o √© suportado no WhatsApp.\nSpoiler n√£o √© suportado no WhatsApp.\nHTML n√£o √© suportado.\n\nExemplo combinado de formata√ß√£o:\n*negrito _it√°lico negrito ~it√°lico negrito tachado~_ negrito*\n\nLink direto (sem texto personalizado):\nhttps://www.exemplo.com\n\nC√≥digo em linha:\n`c√≥digo de largura fixa`\n\nBloco de c√≥digo:\nObserva√ß√µes:\n- Qualquer c√≥digo que voc√™ queira mostrar deve ser enviado entre tr√™s crases (\\`\\`\\`) para aparecer formatado.\n- No WhatsApp, n√£o √© poss√≠vel usar tags HTML como <b>, <i>, <s> etc.\n- Use apenas *asteriscos*, _underscores_, ~tils~ e crases \\` para formata√ß√µes b√°sicas.\n- Sempre substitua os caracteres especiais (<, >, &) pelas vers√µes literais se quiser mostr√°-los como texto.\n\n---\n\n**REQUISITOS DE SA√çDA**\n- Executar tarefas solicitadas pelo utilizador com as ferramentas adequadas, concluindo as a√ß√µes com efici√™ncia.\n- Forne√ßa resumos concisos ou confirma√ß√µes ao utilizador atrav√©s do WhatsApp.\n- Se alguma tarefa n√£o for bem-sucedida, forne√ßa uma mensagem de erro √∫til e acion√°vel.\n- Garanta que o hist√≥rico de chat √© registado e armazenado no armazenamento de mem√≥ria dispon√≠vel que lhe √© fornecido\n\n---\n\n**EXEMPLOS**\n\n1. **Mensagem do utilizador**: \"carregue este documento para mim.\"\n **A√ß√µes**:\n - Inten√ß√£o: Carregar um documento ou um arquivo\n - Ferramenta:\n - Sa√≠da: √â enviada uma confirma√ß√£o ao utilizador de que o arquivo ou documento foi carregado para a pasta correta.\n\n2. **Mensagem do utilizador**: \"Fiz uma compra de 3 donuts que me custaram 25,00 reais esta manh√£. Podem registar esta transa√ß√£o para mim?.\"\n **A√ß√µes**:\n- Envia nesse formato: \n\n{\n\"data_transacao\": \"01/05/2024\",\n\"transacao\": \"Almo√ßo\",\n\"categoria\": \"sa√≠da\",\n\"entrada\": 0,\n\"saida\": 25\n}\n\n- Quando informado: gasto, perda, prejuizo ou negativos, envio de PIX, passei o cart√£o de cr√©dito, paguei uma conta ou um boleto adicione como saida\n- Quando informado: ganho, lucro, recebimentos, adicione como entrada\n- Inten√ß√£o: Registar nova transa√ß√£o de despesa.\n - Ferramenta: IncluirMovimentacao.\n - Sa√≠da: √â enviada uma confirma√ß√£o ao utilizador de que a compra recente de donuts foi adicionada ao registo da transa√ß√£o.\n\n3. **Mensagem do utilizador**: \"Adicione esta fatura ao nosso registo com os seguintes dados: a data da fatura √© 1 de outubro de 2024, o n√∫mero da fatura √© 123456, no valor de 500,00 reais e faturada √† Synthrop AI\"\n **A√ß√µes**:\n - Inten√ß√£o: Adicionar um novo registo de fatura.\n - Ferramenta: IncluirConta.\n - Sa√≠da: √â enviada uma confirma√ß√£o ao utilizador de que foi adicionada uma nova fatura.\n\n4. **Mensagem do utilizador**: \"Quanto gastei no m√™s passado?\"\n **A√ß√µes**:\n- Envia nesse formato: \n\n{\n  \"data\": \"01/2024\",\n  \"categoria\": \"sa√≠da\"\n}\n - Inten√ß√£o: Resumir as Despesas.\n - Ferramenta: ResumidorFinanceiro.\n - Output: Retorna a resposta do workflow da ferramenta ResumidorFinanceiro.\nImportante: Caso a informa√ß√£o venha apenas para fazer um resumo do m√™s vc deve colocar a categoria como null.Caso seja informado se seja informa√ß√µes de entradas ou sa√≠das, categorize.","returnIntermediateSteps":true}},"id":"c7fef024-b954-4c68-aeba-79fae7eb9092","name":"ü§ñ FinThrixüí∞üìä","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[1568,960]},{"parameters":{"promptType":"define","text":"={{ $('Seta os dados de Entrada').item.json.mensagem }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"Seu papel √© identificar a inten√ß√£o do usu√°rio com base em duas categorias:  atualizar_fatura: Se o usu√°rio explicitamente indicar que deseja enviar um documento de conta ou fatura na mensagem ou intera√ß√£o atual do chat, ou se o nome do arquivo do documento contiver 'conta' ou 'fatura'. atualiza_extrato_bancario: Se o usu√°rio explicitamente indicar que deseja enviar um documento de extrato banc√°rio na mensagem ou intera√ß√£o atual do chat, ou se o nome do arquivo do documento contiver 'extrato bancario'."},{"type":"HumanMessagePromptTemplate","message":"=Identifique a inten√ß√£o usando as seguintes informa√ß√µes recebidas do usu√°rio:\n\nMensagem do usu√°rio no chat: {{ $('Seta os dados de Entrada').item.json.mensagem }}\nNome do arquivo: {{ $json.name }}\nLegenda do envio do arquivo: {{ $('Webhook EVO').item.json.body.data.message.documentMessage.title }}\n\nLembre-se que quando vier uma fatura, boleto conta, vc deve assumir que √© uma conta.\nE quando vier algo como extrato vc deve assumir que √© um extrato banc√°rio"}]}},"id":"ea61fb2d-d205-45ae-b3a8-5bf95f2aac3d","name":"üìëIdentificador ü§ë","type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.4,"position":[1760,528]},{"parameters":{"name":"IncluirMovimentacao","description":"Chame essa tool para atualizar a planilha do google sheets com todas as entradas e sa√≠das, gastos ou ganhos, perdas ou lucros. ","workflowId":{"__rl":true,"value":"VWYBVCOEKEHdip9c","mode":"list","cachedResultName":"Atlas - Incluir Movimentacao"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n\t\"data_transacao\": {\n\t\t\"type\": \"date\"\n    },\n   \"transacao\": {\n       \"type\": \"string\"\n    },\n   \"categoria\": {\n       \"type\": \"string\"\n    },\n    \"entrada\": {\n      \"type\": \"number\"\n    },\n    \"saida\": {\n      \"type\": \"number\"\n    }\n  }\n}"},"id":"79a5b2ee-f7ca-45b6-a35b-549f9aabebbf","name":"IncluiMovimentacao","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[1840,1264]},{"parameters":{"name":"IncluirConta","description":"Chame esta ferramenta para registrar uma conta e atualizar um banco de dados do Google Sheets chamado Contas.\n\n","workflowId":{"__rl":true,"value":"GLhnHn7hiEHBXJkF","mode":"list","cachedResultName":"Atlas - Incluir Conta"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n\t\"data_fatura\": {\n\t\t\"type\": \"date\"\n    },\n    \"numero_fatura\": {\n        \"type\": \"number\"\n    },\n    \"valor_total\": {\n        \"type\": \"number\"\n    },\n    \"destinatario\": {\n        \"type\": \"string\"\n    }\n  }\n}"},"id":"582fc17f-7ad9-4649-b72d-e69ab112150a","name":"IncluiConta","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[1984,1264]},{"parameters":{"name":"ResumidorFinanceiro","description":"Chame esta ferramenta para gerar um relat√≥rio ou resumo das informa√ß√µes financeiras a partir de um banco de dados do Google Sheets com registros de transa√ß√µes.\n\nutilize apenas o formato mm/yyyy","workflowId":{"__rl":true,"value":"dsGeC8drTp6f0ofV","mode":"list","cachedResultName":"Atlas - Resumidor Financeiro"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n  \"data\": \"02/2024\",\n  \"categoria\": \"Sa√≠da\"\n}\n}"},"id":"eff7a40d-63e2-451f-8369-20fe6f8df07d","name":"ResumidorFinanceiro","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[2128,1264]},{"parameters":{"resource":"messages-api","instanceName":"pessoal-lucas","remoteJid":"={{ $('Seta os dados de Entrada').first().json.telefone }}","messageText":"={{ $json.output }}","options_message":{"linkPreview":false}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[2448,1072],"id":"76714cf4-b94c-4ed1-a36d-6b0dfff3ba2f","name":"Envia mensagem no WhatsApp","credentials":{"evolutionApi":{"id":"PmCvi1sxg0kx1JwA","name":"Evolution - pessoal-lucas"}}},{"parameters":{"resource":"messages-api","instanceName":"pessoal-lucas","remoteJid":"={{ $('Seta os dados de Entrada').first().json.telefone }}","messageText":"={{ $json.response }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[2992,560],"id":"acfdf82f-e71f-42e1-949b-660dc0b3fd0d","name":"Informa Retorno via WhatsApp","credentials":{"evolutionApi":{"id":"PmCvi1sxg0kx1JwA","name":"Evolution - pessoal-lucas"}}},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $('Faz Upload do Arquivo Enviado para o Drive Google').item.json.id }}","mode":"id"},"driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1royHdLlx2pLrzjXVCslwPP_CeTkcgjLv","mode":"list","cachedResultName":"Extratos","cachedResultUrl":"https://drive.google.com/drive/folders/1royHdLlx2pLrzjXVCslwPP_CeTkcgjLv"}},"id":"5005b7d3-01be-440d-8c2e-320a13d11d39","name":"Envia para Pasta Extratos","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2368,720],"credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"assignments":{"assignments":[{"id":"adeaacb1-54f2-48db-b107-5bf2a55da53a","name":"response","value":"Arquivo enviado para a pasta üóÇÔ∏è de Contas e Faturas no Google Drive","type":"string"}]},"options":{}},"id":"3c52a079-f8d1-4229-945a-f4e85ede3188","name":"Seta Mensagem de Retorno","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2592,384]},{"parameters":{"assignments":{"assignments":[{"id":"29b48128-1e96-4ce3-9979-d9c1a7e442cf","name":"response","value":"Arquivo enviado para a pasta üóÇÔ∏è de Extratos no Google Drive.","type":"string"}]},"options":{}},"id":"5e5e2e05-8cc2-4e15-b1bc-bfbcebb73735","name":"Seta Mensagem de Retorno1","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2608,720]},{"parameters":{"schemaType":"manual","inputSchema":"{\n    \"type\": \"object\",\n    \"properties\": {\n        \"arquivo_enviado\": {\n            \"type\": \"string\",\n            \"enum\": [\"conta\", \"extrato\"]\n        }\n    }\n}\n"},"id":"026e6f5b-af22-4c0a-9e9f-380d0eba65a5","name":"Estrutura do Retorno","type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[1952,720]},{"parameters":{},"id":"31def848-326e-4c8a-a32c-b94d15d2eb3a","name":"Calculadora","type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[1680,1264]},{"parameters":{"method":"POST","url":"={{ $json.body.server_url }}/chat/getBase64FromMediaMessage/{{ $json.body.instance }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $json.body.apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.body.data.key.id }}\"\n    }\n  }\n} ","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[352,768],"id":"286d186a-44c9-4811-b553-9557d8497c75","name":"Busca Base64 da Evo","onError":"continueRegularOutput"},{"parameters":{"operation":"toBinary","sourceProperty":"base64","binaryPropertyName":"=data","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1312,528],"id":"d5969847-d841-4627-af80-1bf4221fd102","name":"Convert to File","onError":"continueRegularOutput"},{"parameters":{"model":"openai/gpt-4o-mini","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1312,1264],"id":"2586c1b2-3146-40c1-9604-2cdb6ddacbc9","name":"GPT-4o","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"operation":"executeQuery","query":"DELETE FROM N8N_CHAT_HISTORIES","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[864,432],"id":"f0f463af-e262-4030-8f0c-ed58853b55ad","name":"Limpa - chat_histories","disabled":true},{"parameters":{"content":"## Limpa hist√≥ricos","height":300,"width":320,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[784,320],"id":"3a337599-2313-40d9-b3b8-417488bf8752","name":"Sticky Note10"},{"parameters":{"model":"openai/gpt-4o-mini","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1760,720],"id":"c9c42398-a9c9-46e5-8013-1802452b6c37","name":"OpenRouter Chat Model","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}}],"connections":{"Postgres Chat Memory":{"ai_memory":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_memory","index":0}]]},"Contexto":{"main":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"main","index":0},{"node":"Convert to File","type":"main","index":0}]]},"Envia para Pasta Conta":{"main":[[{"node":"Seta Mensagem de Retorno","type":"main","index":0}]]},"Verifica se sou Eu":{"main":[[{"node":"Contexto","type":"main","index":0}]]},"Seta os dados de Entrada":{"main":[[{"node":"Verifica se sou Eu","type":"main","index":0}]]},"Webhook EVO":{"main":[[{"node":"Busca Base64 da Evo","type":"main","index":0}]]},"Faz Upload do Arquivo Enviado para o Drive Google":{"main":[[{"node":"üìëIdentificador ü§ë","type":"main","index":0}],[{"node":"N√£o fazer nada","type":"main","index":0}]]},"Roteador":{"main":[[{"node":"Envia para Pasta Conta","type":"main","index":0}],[{"node":"Envia para Pasta Extratos","type":"main","index":0}]]},"ü§ñ FinThrixüí∞üìä":{"main":[[{"node":"Envia mensagem no WhatsApp","type":"main","index":0}]]},"üìëIdentificador ü§ë":{"main":[[{"node":"Roteador","type":"main","index":0}]]},"IncluiMovimentacao":{"ai_tool":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_tool","index":0}]]},"IncluiConta":{"ai_tool":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_tool","index":0}]]},"ResumidorFinanceiro":{"ai_tool":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_tool","index":0}]]},"Envia para Pasta Extratos":{"main":[[{"node":"Seta Mensagem de Retorno1","type":"main","index":0}]]},"Seta Mensagem de Retorno":{"main":[[{"node":"Informa Retorno via WhatsApp","type":"main","index":0}]]},"Seta Mensagem de Retorno1":{"main":[[{"node":"Informa Retorno via WhatsApp","type":"main","index":0}]]},"Estrutura do Retorno":{"ai_outputParser":[[{"node":"üìëIdentificador ü§ë","type":"ai_outputParser","index":0}]]},"Calculadora":{"ai_tool":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_tool","index":0}]]},"Busca Base64 da Evo":{"main":[[{"node":"Seta os dados de Entrada","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Faz Upload do Arquivo Enviado para o Drive Google","type":"main","index":0}]]},"GPT-4o":{"ai_languageModel":[[{"node":"ü§ñ FinThrixüí∞üìä","type":"ai_languageModel","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"üìëIdentificador ü§ë","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"8029ce7f-17ac-42d3-b44d-cdef82e9fd7f","triggerCount":1,"tags":[{"createdAt":"2025-07-20T15:45:29.310Z","updatedAt":"2025-07-20T15:45:29.310Z","id":"wRUSTJ6mfrXjoMjo","name":"formacao-agentes-n8n"},{"createdAt":"2025-08-01T17:49:59.965Z","updatedAt":"2025-08-01T17:49:59.965Z","id":"uASGs3ovnkwqcA4l","name":"ai-agent"},{"createdAt":"2025-08-15T17:34:00.496Z","updatedAt":"2025-08-15T17:34:00.496Z","id":"EDmxLCNqtgvn9jdw","name":"finthrix"},{"createdAt":"2025-08-15T17:34:53.452Z","updatedAt":"2025-08-15T17:34:53.452Z","id":"Y1g65Dys0Cbd8w57","name":"google-drive"},{"createdAt":"2025-08-15T17:35:07.463Z","updatedAt":"2025-08-15T17:35:07.463Z","id":"ETX6EOgdRzrKGJLW","name":"open-router"},{"createdAt":"2025-08-15T17:35:24.404Z","updatedAt":"2025-08-15T17:35:24.404Z","id":"K2g0lfyMpNJTPNIh","name":"postgres"},{"createdAt":"2025-08-15T17:35:24.405Z","updatedAt":"2025-08-15T17:35:24.405Z","id":"zVYDTsum20GGDoCQ","name":"evolution-api"}]}