{"createdAt":"2025-11-17T01:31:28.635Z","updatedAt":"2025-11-17T23:19:09.844Z","id":"ZaQ1XM2Q5tRAcFbU","name":"JARVIS","active":false,"isArchived":false,"nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-6720,2688],"id":"c7b5ead1-870f-4321-a0a1-345b001681a3","name":"GPT-4o-min"},{"parameters":{"model":"anthropic/claude-3.5-sonnet","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-4352,2688],"id":"faa144c7-db09-4cc1-af59-3736644bf8e1","name":"Claude 3.5 Sonnet"},{"parameters":{"promptType":"define","text":"={{ $json.messages }}","options":{"systemMessage":"=<datasystem>A data de hoje √© {{ $now.weekdayLong }},{{ $now.format('dd/MM/yyyy') }},{{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}</datasystem>\n\nVoc√™ √© um assistente avan√ßado de automa√ß√£o com personalidade do JARVIS.\n\nVoc√™ decide se o usuario forneceu alguma informa√ß√£o que deve ser adicionado como mem√≥ria, se sim, utilize a tool salvar_memoria para guardar essa informacao.\nInforma√ß√µes a serem salvas: gostos, preferencias, escolhas, novidades.\nN√ÉO informe ao usuario que foi gravado na memoria, apenas continue sendo o assistente JARVIS como informado.\n\n## Execu√ß√£o din√¢mica:\n\nO agente deve entender a solicita√ß√£o e acionar as ferramentas necess√°rias de forma l√≥gica e sequencial.\nSe informa√ß√µes estiverem faltando, pergunte ao usu√°rio antes de prosseguir.\nCaso a a√ß√£o envolva v√°rias etapas, informe o usu√°rio sobre cada passo antes de execut√°-lo.\nExemplos de uso:\nUsu√°rio: \"Envie um e-mail para Jo√£o com o assunto 'Reuni√£o' e o corpo 'Podemos agendar para amanh√£?'\"\n\n## Uso de Ferramentas:\n\n- Calendar MCP - Tudo que for relacionado a Agenda Google\n- Gmail MCP - Tudo que for relacionado ao Gmail do Google\n- AirBnB Actions\n- AirBnB Execute\n- Buscar Contatos - Busca lista de contatos no airtable\n- Criar Contato - Cria contato no airtable - Garanta que tenha pelo menos o e-mail\n- Atualizar Contato - Pe√ßa para o usu√°rio informar o nome e se n√£o encontrar retorne a mensagem\n- Excluir Contato - Antes de Excluir confirme a opera√ß√£o antes de excluir\n- Base de Conhecimento - Utilize para buscar os conhecimentos necess√°rios sobre IA, Agentes de IA, Automa√ß√µes e N8N\n\n## Importante:\n\n- Todo pedido para criar um post deve ser enviado um DRAFT para aprova√ß√£o do usu√°rio final.\n- Voc√™ deve apenas chamar a ferramenta Linkedin MCP quando o usu√°rio autorizar a fazer a postagem\n\nVoc√™ deve usar o mesmo tom de fala e postagem abaixo do meu conte√∫do do linkedin sempre no final fazendo um CALL TO ACTION para minha mentoria e forma√ß√£o sobre Agentes de IA com N8N\n\nExemplo:\nüöÄ Conhe√ßa meu J.A.R.V.I.S. Assistente de IA (WhatsApp) ‚Äî Vers√£o 1.0 (e √© 100% gratuito) constru√≠do com MCP\n\nDepois de meses arquitetando, prototipando e errando, eu criei meu pr√≥prio assistente pessoal de IA inspirado no J.A.R.V.I.S. do Homem de Ferro (com a voz dele e com todos os seus humores igualzinho do filme - fine tunei a IA pra ficar o mais igual poss√≠vel).\n\nTudo rodando no n8n ‚Äî e vou compartilhar o JSON pronto com quem quiser come√ßar o seu e encurtar o caminho! üëä\n\n‚öôÔ∏è Ferramentas que usei:\n\nEvolutionAPI (WhatsApp)\nOpenAI (GPT)\nAnthropic (Claude)\nRedis (Mem√≥ria)\nPostgreSQL (Banco de Dados)\nAirtable (Dados Din√¢micos)\nGoogle Workspace (E-mails, Agenda, Drive)\nEleven Labs (√Åudio - pra deixar a voz igualzinha do JARVIS)\nTavily (Busca em tempo real na internet)\nMCP (Mobile Content Protocol)\n\nüõ†Ô∏è O que ele j√° resolve pra mim na Vers√£o 1:\n- Classifica e trata mensagens automaticamente üì©\n- Mantem contexto de conversas em mem√≥ria üß†\n- Busca prefer√™ncias personalizadas üß©\n- Da respostas autom√°ticas via texto ou √°udio üîä\n- Integra com banco de dados e APIs externas üöÄ\n\nüìà Ganho de produtividade real:\n- Economizo +8 horas por semana s√≥ em tarefas repetitivas.\n- Reduzi a necessidade de responder manualmente mensagens em 60%.\n- Organizar e recuperar informa√ß√µes ficou 3x mais r√°pida.\n\nüî• E a Vers√£o 2 do J.A.R.V.I.S. j√° est√° quase em produ√ß√£o...\n\nEle vai fazer ainda mais:\n\n- Gerenciar tasks no Jira üéØ\n- Reservar voos, hot√©is e Airbnbs ‚úàÔ∏èüè°\n- Raspar not√≠cias, blogs, pdfs e resumir üìö\n- Escrever posts, carross√©is e newsletters ‚úçÔ∏è\n- Construir apps automaticamente no Lovable üõ†Ô∏è\n- Gerar imagens e v√≠deos sob demanda üé•üé®\n- Gerar prompts pra qualquer LLM üìÑ \n\nE muito mais...\n\nüí• Quer aprender a criar o seu pr√≥prio J.A.R.V.I.S. ?\n\nEu ensino tudo passo a passo na minha Mentoria de Agentes de IA:\n\nDesde a instala√ß√£o do n8n, configura√ß√£o de VPS em escala, LLMs e PROMPT Engineering, Lang Chain e Lang Graph, MCP, integra√ß√µes, at√© a constru√ß√£o de agentes e automa√ß√µes avan√ßadas que v√£o mudar sua produtividade de verdade.\n\ne o mais importante: fazer neg√≥cios com IA ($$$), afinal voc√™ pode vender seus agentes e automa√ß√µes e fazer uma grana extra, como eu j√° estou fazendo.\n\nüëâ Curta a Publica√ß√£o, Conecta e Comenta \"QUERO O JARVIS\" que eu te mando o JSON e te explico como participar da mentoria.\n\nhashtag#MentoriaDeIA hashtag#AgentesDeIA hashtag#n8n hashtag#openai hashtag#Automa√ß√£o hashtag#Produtividade hashtag#AI hashtag#InteligenciaArtificial hashtag#LowCode hashtag#NoCode hashtag#Transforma√ß√£oDigital\n"}},"id":"84356502-4933-4c83-b4b3-8526676213c8","name":"J.A.R.V.I.S","type":"@n8n/n8n-nodes-langchain.agent","position":[-6416,2144],"typeVersion":1.6},{"parameters":{"operation":"getAll","calendar":{"__rl":true,"value":"ricardo.braga@caf.io","mode":"list","cachedResultName":"Ric Neves"},"limit":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}","timeMin":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}","timeMax":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}","options":{}},"id":"8fa80713-a6c9-4331-9e69-c7cc02c411b0","name":"SearchEvent","type":"n8n-nodes-base.googleCalendarTool","position":[-5872,3168],"typeVersion":1.3},{"parameters":{"calendar":{"__rl":true,"value":"ricardo.braga@caf.io","mode":"list","cachedResultName":"Ric Neves"},"start":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}","end":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}","additionalFields":{"description":"={{ $fromAI(\"event_description\", \"The event description\", \"string\") }}","summary":"={{ $fromAI(\"event_title\", \"The event title\", \"string\") }}"}},"id":"1fbb0767-a8c0-4f4a-a8c7-245bd64c4a51","name":"CreateEvent","type":"n8n-nodes-base.googleCalendarTool","position":[-5712,3168],"typeVersion":1.3},{"parameters":{"operation":"update","calendar":{"__rl":true,"value":"ricardo.braga@caf.io","mode":"list","cachedResultName":"Ric Neves"},"eventId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}","updateFields":{"description":"={{ $fromAI(\"event_description\", \"The event description\", \"string\") }}","end":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}","start":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}","summary":"={{ $fromAI(\"event_title\", \"The event title\", \"string\") }}"}},"id":"1bb118a5-004e-4091-80fa-f50cf2a1594e","name":"UpdateEvent","type":"n8n-nodes-base.googleCalendarTool","position":[-5584,3168],"typeVersion":1.3},{"parameters":{"operation":"delete","calendar":{"__rl":true,"value":"ricardo.braga@caf.io","mode":"list","cachedResultName":"Ric Neves"},"eventId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}","options":{}},"id":"babe8725-dae5-4227-9f14-c472af72217d","name":"DeleteEvent","type":"n8n-nodes-base.googleCalendarTool","position":[-5424,3168],"typeVersion":1.3},{"parameters":{"sendTo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}","subject":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}","message":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}","options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-5232,3168],"id":"72dd003a-55b8-4711-93b0-3bd4078bb37c","name":"SendMessage","webhookId":"8492f278-66f5-415d-84d4-6adf62042b6f"},{"parameters":{"operation":"getAll","returnAll":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}","simple":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify', ``, 'boolean') }}","filters":{},"options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-5072,3168],"id":"b8d0b40d-e234-4e49-bbfc-337c27cbd687","name":"GetMessages","webhookId":"3c4e4a4c-7018-4bdc-8b04-a5bde424d0d5"},{"parameters":{"content":"# MCP Servers","height":660,"width":2440,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-5936,2912],"id":"2cfeca13-b50f-470b-98ad-4e835aeddb77","name":"Sticky Note20"},{"parameters":{"resource":"label","operation":"get","labelId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Label_ID', ``, 'string') }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-4352,3168],"id":"59584fb1-9835-4431-82cd-835050025de2","name":"GetLabel","webhookId":"a5386b97-8229-4ea2-9b88-31c39d4fb44c"},{"parameters":{"operation":"markAsUnread","messageId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message_ID', ``, 'string') }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-4896,3168],"id":"4acdde6e-3b02-4b0f-a247-022c81adfaa8","name":"MarkMessageUnread","webhookId":"266e9ba1-2d0a-4ae1-a26e-94901119ef70"},{"parameters":{"resource":"label","operation":"create","name":"={{$fromAI('label')}}","options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-4560,3168],"id":"08139de6-bbc7-4d9d-bb0a-7ace7c576712","name":"CreateLabel","webhookId":"65456979-52ef-462c-8adb-a76f6e75b2a2"},{"parameters":{"person":"gI9okJLDqL","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text', ``, 'string') }}","shareMediaCategory":"IMAGE","binaryPropertyName":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Input_Binary_Field', ``, 'string') }}","additionalFields":{}},"type":"n8n-nodes-base.linkedInTool","typeVersion":1,"position":[-4064,3184],"id":"24b1d2de-62d4-42cb-9a32-8f170ac08bdb","name":"CreatePostWithImage"},{"parameters":{"person":"gI9okJLDqL","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text', ``, 'string') }}","additionalFields":{}},"type":"n8n-nodes-base.linkedInTool","typeVersion":1,"position":[-3840,3184],"id":"00867aa6-6788-4d30-a7a1-318c339dba2d","name":"CreatePostWithoutImage"},{"parameters":{"sseEndpoint":"https://webhook.agentes-n8n.com.br/mcp/gmail/sse"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1,"position":[-5792,2672],"id":"2be7a629-f4dd-46fc-a5d2-bdb1c2f2701d","name":"Gmail MCP"},{"parameters":{"sseEndpoint":"https://webhook.agentes-n8n.com.br/mcp/my-calendar/sse"},"id":"467f1ccd-d791-45f4-839e-676295b08c31","name":"Calendar MCP","type":"@n8n/n8n-nodes-langchain.mcpClientTool","position":[-6000,2672],"typeVersion":1},{"parameters":{"path":"linkedin"},"id":"10aafed2-5b2d-47ca-b634-5cb603633d93","name":"Linkedin MCP Server","type":"@n8n/n8n-nodes-langchain.mcpTrigger","position":[-4064,2960],"webhookId":"f9d9d5ea-6f83-42c8-ae50-ee6c71789bca","typeVersion":1},{"parameters":{"path":"my-calendar"},"id":"3f07f1f8-89b9-4811-ba6e-18d64a51991b","name":"Google Calendar MCP Server","type":"@n8n/n8n-nodes-langchain.mcpTrigger","position":[-5792,2992],"webhookId":"f9d9d5ea-6f83-42c8-ae50-ee6c71789bca","typeVersion":1},{"parameters":{"path":"gmail"},"type":"@n8n/n8n-nodes-langchain.mcpTrigger","typeVersion":1,"position":[-4880,2944],"id":"97221225-ab1b-4dce-81dd-ebe6d012cb55","name":"Gmail MCP Server","webhookId":"5bd62aff-2100-498c-b499-2c272b2a1bfd"},{"parameters":{"sseEndpoint":"https://webhook.agentes-n8n.com.br/mcp/linkedin/sse"},"id":"39c9898f-20b1-4fd0-baaa-2f3d9dfe9d7d","name":"Linkedin MCP","type":"@n8n/n8n-nodes-langchain.mcpClientTool","position":[-5616,2672],"typeVersion":1},{"parameters":{"content":"‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ÄÉ‚ÄÉ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ÄÉ‚ÄÉ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó\n‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ÄÉ‚ÄÉ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù\n‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ÄÉ‚ÄÉ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë\n‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ÄÉ‚ÄÉ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë\n‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïó‚ñë‚ñë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ÄÉ‚ÄÉ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ïö‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ÄÉ‚ÄÉ‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ïö‚ñà‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë\n‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ÄÉ‚ÄÉ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ÄÉ‚ÄÉ‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ÄÉ‚ÄÉ‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ÄÉ‚ÄÉ‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë","height":180,"width":2240,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6704,240],"id":"4c757f98-f96c-401b-a76a-068a4969c369","name":"Sticky Note26"},{"parameters":{"toolDescription":"Use essa ferramenta pra buscar na internet","method":"POST","url":"https://api.tavily.com/search","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"api_key\": \"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\",\n    \"query\": \"{searchTerm}\",\n    \"search_depth\": \"basic\",\n    \"include_answer\": true,\n    \"topic\": \"news\",\n    \"include_raw_content\": true,\n    \"max_results\": 3\n} ","placeholderDefinitions":{"values":[{"name":"searchTerm","description":"What the user has requested to search the internet for","type":"string"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[-4512,2672],"id":"65a689d6-eb9b-4e9f-9953-9f7bd5d4543c","name":"Tavily"},{"parameters":{"operation":"reply","messageId":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message_ID', ``, 'string') }}","message":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}","options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[-4720,3184],"id":"4cae992e-715c-4394-9807-be9faed55899","name":"ReplyMessage","webhookId":"e3624d55-d3fc-48c0-8b7d-2deec09658cb"},{"parameters":{"authentication":"airtableOAuth2Api","operation":"search","base":{"__rl":true,"value":"appIwaBtIOYyhW7b0","mode":"list","cachedResultName":"RicDataBase","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0"},"table":{"__rl":true,"value":"tblDjxio2ooQ06puV","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0/tblDjxio2ooQ06puV"},"filterByFormula":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Filter_By_Formula', ``, 'string') }}","options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-5104,2672],"id":"9d8ad0ff-25b7-4573-b7da-4ab3ca564282","name":"Buscar Contatos"},{"parameters":{"authentication":"airtableOAuth2Api","operation":"create","base":{"__rl":true,"value":"appIwaBtIOYyhW7b0","mode":"list","cachedResultName":"RicDataBase","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0"},"table":{"__rl":true,"value":"tblDjxio2ooQ06puV","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0/tblDjxio2ooQ06puV"},"columns":{"mappingMode":"defineBelow","value":{"Nome":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nome', ``, 'string') }}","Email":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Email', ``, 'string') }}","WhatsApp":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('WhatsApp', ``, 'string') }}"},"matchingColumns":[],"schema":[{"id":"Nome","displayName":"Nome","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"WhatsApp","displayName":"WhatsApp","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-4960,2672],"id":"9724e957-948b-4863-a9dc-c37b7cc4652b","name":"Criar Contato"},{"parameters":{"authentication":"airtableOAuth2Api","operation":"update","base":{"__rl":true,"value":"appIwaBtIOYyhW7b0","mode":"list","cachedResultName":"RicDataBase","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0"},"table":{"__rl":true,"value":"tblDjxio2ooQ06puV","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0/tblDjxio2ooQ06puV"},"columns":{"mappingMode":"autoMapInputData","value":{},"matchingColumns":["Nome"],"schema":[{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"string","readOnly":true,"removed":false},{"id":"Nome","displayName":"Nome","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"WhatsApp","displayName":"WhatsApp","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-4816,2672],"id":"d35a8b43-caf0-40db-a7bb-a872cc2e4f71","name":"Atualizar Contato"},{"parameters":{"authentication":"airtableOAuth2Api","operation":"deleteRecord","base":{"__rl":true,"value":"appIwaBtIOYyhW7b0","mode":"list","cachedResultName":"RicDataBase","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0"},"table":{"__rl":true,"value":"tblDjxio2ooQ06puV","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appIwaBtIOYyhW7b0/tblDjxio2ooQ06puV"},"id":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Record_ID', ``, 'string') }}"},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[-4672,2672],"id":"06be8f5b-311c-4d79-be1c-f244832f45de","name":"Excluir Contato"},{"parameters":{},"id":"3eb97ed4-6fd3-43bc-b345-4f645e4833ba","name":"Calculator1","type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[-6192,2672]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.block }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true},"id":"702607fa-3fef-4f1d-bcb8-311e43c6eb9b"}],"combinator":"and"},"renameOutput":true,"outputKey":"IA PODE RESPONDER"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"3ef0e01c-cc14-4663-bb4d-2905b350c3ab","leftValue":"={{ $json.block }}","rightValue":"true","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"IA NAO PODE RESPONDER"}]},"options":{}},"id":"143fcb08-e791-4025-b904-c4694ff800dd","name":"Switch Block1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[-6864,1440]},{"parameters":{"content":"## Mem√≥ria para aguardar mensagem particionada do humano\n","height":840,"width":1399},"id":"78292121-1d2b-43da-bf43-83bdafc4996d","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-8368,2032]},{"parameters":{},"id":"79abf3ac-7ccc-425c-9dd0-17faccf311ef","name":"No Operation, do nothing","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-7520,2160]},{"parameters":{"content":"## Tratamento da Entrada de Dados","height":600,"width":2099,"color":2},"id":"0342ed3a-cc8a-4d31-907c-d3f6f5c6b673","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-8368,1328]},{"parameters":{"content":"## Categoriza√ß√£o e Identifica√ß√£o do tipo de Dado que veio na Entrada","height":1220,"width":1999,"color":5},"id":"4d29567a-a8b4-48a5-9137-0558f771a393","name":"Sticky Note9","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6240,768]},{"parameters":{"content":"## Agente e suas Ferramentas\n","height":860,"width":2699,"color":6},"id":"9bb0432b-1610-4260-b1ba-dad757ca8f7d","name":"Sticky Note11","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6912,2000]},{"parameters":{"dataType":"binary","options":{}},"id":"b4dc0cd2-2467-4718-8495-dbc9e56f585e","name":"Default Data Loader1","type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","position":[-7504,3248],"typeVersion":1},{"parameters":{"chunkSize":3000,"chunkOverlap":200,"options":{}},"id":"d322c343-3cc3-46a2-b914-3a4e5264d615","name":"Recursive Character Text Splitter1","type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","position":[-7552,3408],"typeVersion":1},{"parameters":{"mode":"insert","pineconeIndex":{"__rl":true,"value":"jarvis","mode":"list","cachedResultName":"jarvis"},"options":{"clearNamespace":true}},"id":"67536cea-e1bb-4ca1-9f1b-15003da6e01a","name":"Insere no Pinecone1","type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","position":[-7696,3008],"typeVersion":1},{"parameters":{"content":"## Inserir Base de Conhecimento no RAG","height":658,"width":1404,"color":5},"id":"372605dd-c91c-4808-b664-146f977da40e","name":"Sticky Note18","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-8368,2912]},{"parameters":{"options":{}},"id":"fd15650c-2f25-452f-a8a7-3e0a67c03296","name":"OpenAI Chat Model2","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[-6240,3312]},{"parameters":{"model":"text-embedding-3-large","options":{}},"id":"03fdb49b-3660-4a6b-a113-ec46210e9274","name":"Embeddings OpenAI1","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1,"position":[-6656,3392]},{"parameters":{"pineconeIndex":{"__rl":true,"value":"jarvis","mode":"list","cachedResultName":"jarvis"},"options":{}},"id":"671c2fc3-f3ce-4c4f-af23-6747c6c96a07","name":"Pinecone Vector Store1","type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[-6624,3200]},{"parameters":{"content":"# Base de Conhecimento do Agente  - RAG\n","height":658,"width":964,"color":5},"id":"2b29b538-b55e-42f7-ac6a-8defeae9f549","name":"Sticky Note19","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6912,2912]},{"parameters":{"content":"## Sa√≠da do Agente e resposta para WhatsApp","height":580,"width":1360,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-4160,1968],"id":"a93c67c5-4521-4af6-89ad-37d9ea44b90b","name":"Sticky Note21"},{"parameters":{"content":"## Ferramentas / Fun√ß√µes ","height":220,"width":2040,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6272,2592],"id":"49e07b3b-01c8-47b4-bc4d-d0484e97b1ac","name":"Sticky Note22"},{"parameters":{"httpMethod":"POST","path":"jarvis","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-8672,1584],"id":"b40576dc-5b08-4f39-b921-b2453736f860","name":"Webhook1","webhookId":"5c9151c9-3e01-46c6-bbd5-d1389f860e4d"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.message.event }}","rightValue":"outcoming","operator":{"type":"string","operation":"equals"},"id":"24220beb-e1af-40ca-8b4d-444677b8443d"}],"combinator":"and"},"renameOutput":true,"outputKey":"outcoming"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"d7b42536-638f-4128-b51b-6aa913e9d9bc","leftValue":"={{ $json.message.event }}","rightValue":"incoming","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"incoming"}]},"options":{}},"id":"08deee17-c1a6-4175-9ebb-045fcab29e50","name":"Entende a Origem da Evo1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[-7504,1568]},{"parameters":{},"id":"7a5c6971-8ddf-418c-b09a-b44fd5eabd08","name":"N√£o faz nada1","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-6512,1584]},{"parameters":{"assignments":{"assignments":[{"id":"2f8e1fbf-9134-4b48-be29-066509e021f5","name":"telefone","value":"={{ $('Webhook1').item.json.body.data.key.remoteJid }}","type":"string"},{"id":"a6004904-d9e1-4627-be79-d2a5b073d44f","name":"mensagem","value":"={{ $('Webhook1').item.json.body.data.message.conversation }}","type":"string"}]},"options":{}},"id":"33f584f1-0c12-459d-ae76-5686e29b0bd5","name":"Filtro de Coleta de Info1","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-5472,1280]},{"parameters":{"assignments":{"assignments":[{"id":"17694db0-6248-444f-afb9-ff7ed13996ef","name":"pergunta","value":"={{ $('Webhook1').item.json.body.data.message.extendedTextMessage.text }}","type":"string"}]},"options":{}},"id":"b0e8e265-33be-4c0d-95c3-06f9cbbc57d0","name":"Texto1","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[-5472,1072],"notesInFlow":false,"alwaysOutputData":true},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados1').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados1').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados1').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados1').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"854a3106-dbe4-4a72-aef3-4802688007ff","name":"Mensagem de Voz1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-5472,848],"retryOnFail":true,"maxTries":2},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"audio","mimeType":"={{ $json.mimetype }}"}},"id":"77643f2c-e30f-4da3-a885-9ea66d178533","name":"Converter Mensagem de Voz para data1","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[-5216,848]},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"id":"3d5e0ab6-e734-458e-ae67-ff2630f46b23","name":"Transceve para texto com OPENAI1","type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.6,"position":[-4992,848],"credentials":{"openAiApi":{"id":"e1CUmhBdcZxAHWrK","name":"OpenAi account 2"}}},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-5024,1184],"id":"134a67bc-45c4-4ed3-a379-45ab1d3c86f5","name":"Direcionador Para Input1"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados1').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados1').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados1').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados1').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"6377dff4-cf43-4552-af08-e7722a4bfaad","name":"Imagens1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-5472,1488],"retryOnFail":true,"maxTries":2},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"image","mimeType":""}},"id":"6bb9a0e7-08ec-4066-96b5-48998d5d2fe8","name":"Converte Imagem para data1","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[-5216,1488]},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"GPT-4O-MINI"},"text":"Descreva essa imagem, identificando o que possui nela !!! Traga todas as informa√ß√µes necess√°rias de forma detalhada","inputType":"base64","options":{}},"id":"9ccaf087-ef6a-4ec3-bf1d-d8548b0c09b9","name":"Analisa Imagem e Transcreve o que h√° nela1","type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.6,"position":[-4992,1488],"credentials":{"openAiApi":{"id":"e1CUmhBdcZxAHWrK","name":"OpenAi account 2"}}},{"parameters":{"numberInputs":4},"type":"n8n-nodes-base.merge","typeVersion":3,"position":[-4640,1360],"id":"d3ab1750-7d94-40ca-a175-22c016d497eb","name":"Junta em uma √∫nica mensagem1"},{"parameters":{"assignments":{"assignments":[{"id":"aaff3535-51d6-4046-b6e9-07e1a5071c7a","name":"M√≠dia_Tratada","value":"={{ $json.mensagem }}{{ $json.text }}{{ $json.content }}","type":"string"},{"id":"b6e5cb3b-e2e6-4bbb-8c36-64e6b5875ef5","name":"message_Id","value":"={{ $('Preparar Dados1').item.json.message.message_id }}","type":"string"},{"id":"4be55584-c63b-4753-ba55-cb8fe4d832d3","name":"Timetamp","value":"={{ $('Preparar Dados1').item.json.message.Timestamp }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-4480,1792],"id":"9280da83-98f4-40f2-8bef-7fb0c49df74c","name":"Organiza Informa√ß√µes para o Agente1"},{"parameters":{"operation":"push","list":"={{ $('Preparar Dados1').item.json.message.chat_id }}_buf","messageData":"={{ JSON.stringify({ \n    \"messageContent\": $('Organiza Informa√ß√µes para o Agente1').item.json['M√≠dia_Tratada'],\n    \"messageTime\": $('Organiza Informa√ß√µes para o Agente1').item.json.Timetamp,\n    \"messageID\": $('Organiza Informa√ß√µes para o Agente1').item.json.message_Id,\n    \n}) }}","tail":true},"id":"32324267-0196-4434-9faa-31309f4aaa85","name":"Seta Mem√≥ria da Conversa1","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-8272,2208]},{"parameters":{"operation":"get","propertyName":"messages","key":"={{ $('Preparar Dados1').item.json.message.chat_id.toString() }}_buf","options":{}},"id":"32d8aef1-bd20-452d-a776-586f96928b64","name":"Busca Mem√≥ria da Conversa1","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-8080,2368]},{"parameters":{"operation":"delete","key":"={{ $('Preparar Dados1').item.json.message.chat_id.toString() }}_buf"},"id":"845c017d-2f18-4467-9725-b3a8f9590d61","name":"Limpa Mem√≥ria da Conversa1","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-7520,2384]},{"parameters":{"amount":7},"id":"316c0be7-d34c-4996-af83-72ed40954647","name":"Aguarda 5 segundos1","type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[-7536,2608],"webhookId":"6581c105-59e7-42fa-beca-7fa276bee74d"},{"parameters":{"assignments":{"assignments":[{"id":"db5cfe0a-7f43-4a61-8b27-bfd3a95deb8d","name":"messages","value":"={{ $json.messages.map(msg => JSON.parse(msg)).sort((a, b) => new Date(a.messageTime) - new Date(b.messageTime)).map(msg => msg.messageContent).join(' ') }}\n","type":"string"}]},"options":{}},"id":"c03b6863-7853-40c1-aafc-bb4a83418fb9","name":"Refaz os dados de Entrada1","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-7344,2384]},{"parameters":{"jsCode":"function limparMensagem(texto) {\n  if (typeof texto !== 'string') {\n    return '';\n  }\n\n  // Fun√ß√£o para remover metadados e dados t√©cnicos\n  function removerMetadataTecnico(str) {\n    return str\n      // Remove objetos e chaves de metadados espec√≠ficos\n      .replace(/\"response_metadata\"\\s*:\\s*{[^}]*}/g, '')  // Remove \"response_metadata\"\n      .replace(/\"additional_kwargs\"\\s*:\\s*{[^}]*}/g, '')  // Remove \"additional_kwargs\"\n      .replace(/\"tool_calls\"\\s*:\\s*\\[\\s*\\]/g, '')  // Remove \"tool_calls\" vazio\n      .replace(/\"invalid_tool_calls\"\\s*:\\s*\\[\\s*\\]/g, '')  // Remove \"invalid_tool_calls\" vazio\n      .replace(/\"type\"\\s*:\\s*\"(ai|human)\"/g, '')  // Remove os tipos \"ai\" e \"human\"\n      .replace(/\"data\"\\s*:\\s*{[^}]*}/g, '')  // Remove a chave \"data\"\n      // Remove objetos JSON em excesso ou vazios\n      .replace(/,\\s*{[^}]*}/g, '') // Remove objetos soltos\n      .replace(/,\\s*\\[\\s*\\]/g, '') // Remove arrays vazios\n      .replace(/\\s*:\\s*null/g, '') // Remove valores null\n      .replace(/\\s*:\\s*\\[\\]/g, '') // Remove arrays vazios\n      .replace(/\\s*:\\s*{}/g, '') // Remove objetos vazios\n      // Ajusta espa√ßos desnecess√°rios\n      .replace(/\\s+/g, ' ')\n      .replace(/^\\s+|\\s+$/g, '');  // Remove espa√ßos no in√≠cio e fim\n  }\n\n  // Fun√ß√£o para limpar caracteres especiais\n  function limparCaracteresEspeciais(str) {\n    return str\n      .replace(/\\\\\\\\[rnt]/g, ' ')  // Limpa sequ√™ncias de escape\n      .replace(/\\\\\\\\\\\"/g, '')  // Remove as aspas escapadas\n      .replace(/\\\\\\\\\\\\\\\\/g, '')  // Remove barras invertidas\n      .replace(/[\\x00-\\x1F\\x7F-\\x9F]/g, '')  // Remove caracteres de controle\n      .replace(/\\\"+/g, '')  // Remove aspas extras\n      .replace(/[{}[\\]]/g, '')  // Remove chaves e colchetes extras\n      .trim();\n  }\n\n  // Fun√ß√£o para extrair e limpar a mensagem principal\n  function extrairMensagemPrincipal(str) {\n    // Divide em frases, removendo pontua√ß√£o extra\n    const frases = str.split(/(?<=[.!?])\\s+/);\n\n    return frases\n      .map(frase => frase.trim())\n      .filter(frase => {\n        // Remove frases que ainda t√™m metadados ou s√£o irrelevantes\n        return frase.length > 0 &&\n          !frase.includes('tool_calls') &&\n          !frase.includes('invalid_tool_calls') &&\n          !frase.match(/^[:\\s\\[\\]{}]+$/);\n      })\n      .join(' ');\n  }\n\n  // Processo de limpeza e extra√ß√£o\n  let resultado = texto;\n\n  // Passo 1: Remove metadados e chaves indesejadas\n  resultado = removerMetadataTecnico(resultado);\n\n  // Passo 2: Extrai a mensagem relevante, ignorando o que n√£o √© necess√°rio\n  resultado = extrairMensagemPrincipal(resultado);\n\n  // Passo 3: Remove caracteres especiais e formata√ß√£o indesejada\n  resultado = limparCaracteresEspeciais(resultado);\n\n  // Limpeza final para remover espa√ßos extras\n  resultado = resultado\n    .replace(/\\s+/g, ' ')\n    .replace(/^[\\\",\\s]+|[\\\",\\s]+$/g, '')\n    .trim();\n\n  return resultado;\n}\n\nfunction processarMensagens(items) {\n  return items.map(item => {\n    try {\n      if (!item?.json?.mensagem) {\n        return item;\n      }\n\n      let mensagem = item.json.mensagem;\n\n      // Se for objeto, converte para string\n      if (typeof mensagem === 'object') {\n        try {\n          mensagem = JSON.stringify(mensagem);\n        } catch (e) {\n          console.error('Erro ao converter objeto para string:', e);\n          return item;\n        }\n      }\n\n      // Aplica a limpeza\n      const mensagemLimpa = limparMensagem(mensagem);\n\n      // Atualiza apenas se houver conte√∫do significativo\n      if (mensagemLimpa && mensagemLimpa.length > 0) {\n        item.json.mensagem = mensagemLimpa;\n      }\n\n      return { json: item.json };\n    } catch (error) {\n      console.error('Erro ao processar item:', error);\n      return item;\n    }\n  });\n}\n\n// Execu√ß√£o principal\ntry {\n  const items = $input.all();\n  return processarMensagens(items);\n} catch (error) {\n  console.error('Erro na execu√ß√£o:', error);\n  throw error;\n}\n"},"id":"75511667-5618-4c7b-a412-ab5c8040d8d9","name":"Remove metadados e dados que n√£o fazem sentido enviar para o agente1","type":"n8n-nodes-base.code","typeVersion":2,"position":[-7152,2384]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ JSON.parse($json.messages.first()).messageID }}","rightValue":"={{ $('Organiza Informa√ß√µes para o Agente1').item.json.message_Id }}","operator":{"type":"string","operation":"notEquals"},"id":"1ce28741-7c43-4598-9fa0-ab2c9e52d75f"}],"combinator":"and"},"renameOutput":"={{ true }}","outputKey":"faz nada"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"1585bc24-0b58-4179-8919-0e9aabc0e35e","leftValue":"={{ JSON.parse($json.messages.last()).messageTime }}","rightValue":"={{ $now.minus(3.'seconds') }}","operator":{"type":"dateTime","operation":"before"}}],"combinator":"and"},"renameOutput":"={{ true }}"}]},"options":{"fallbackOutput":"extra","renameFallbackOutput":"esperar"}},"id":"665870fa-10f2-46d1-ad12-41082687cea6","name":"Verifica pra onde vai1","type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-7840,2368]},{"parameters":{"operation":"set","key":"={{ $json.message.chat_id }}_timeout","value":"true","keyType":"string","expire":true,"ttl":900},"id":"e7e0336b-2d13-44fe-a72c-23ff1e20b923","name":"Gera Timeout no Redis1","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-6864,1760]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"101c3ff7-e997-43bb-8e99-fe82746c5993","leftValue":"={{ $('Webhook1').item.json.body.data.message.audioMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"audioMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"4b94d2ac-53e5-4153-9377-4cc6db20cb1c","leftValue":"={{ $json.body.data.message.extendedTextMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"extendedTextMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"38226af4-80fe-4155-9ceb-2379f44e29ed","leftValue":"={{ $('Webhook1').item.json.body.data.message.conversation }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"conversation"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"300366d9-2416-4cf4-93c3-e48c8761c60f","leftValue":"={{ $('Webhook1').item.json.body.data.message.imageMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"imageMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"f33566fd-3eb9-45f4-934a-3a39e2adca6c","leftValue":"={{ $('Webhook1').item.json.body.data.messageType === 'documentMessage' }}","rightValue":true,"operator":{"type":"boolean","operation":"equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"documentMessage"}]},"options":{"fallbackOutput":"none"}},"id":"fa318e5d-f22f-47f9-becd-1dbc7af2cb5c","name":"Identifica o Tipo de Dados que veio na MSG1","type":"n8n-nodes-base.switch","typeVersion":3,"position":[-6112,1392]},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"=image {{ $('Identifica o Tipo de Dados que veio na MSG1').item.json.body.data.message.documentMessage.fileName }}","mimeType":"={{ $('Identifica o Tipo de Dados que veio na MSG1').item.json.body.data.message.documentMessage.mimetype }}"}},"id":"0ab69df4-37a4-473c-a6f0-cf6e323dc64a","name":"Converter Documento para data1","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[-5232,1792]},{"parameters":{"operation":"pdf","options":{}},"id":"73e7d45b-8fb4-4636-bb0a-ba67dc54a29b","name":"Extrair Dados do PDF1","type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[-4992,1792]},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados1').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados1').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados1').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados1').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"7ac3f8fb-fecc-4c81-97ca-1e77cbe735ae","name":"Documento (PDF)1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-5472,1792],"retryOnFail":true,"maxTries":2},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Preparar Dados1').item.json.message.chat_id }}_mem","sessionTTL":10000,"contextWindowLength":7},"id":"b24471d4-7ff1-4fc9-b3f6-c1f34675ca62","name":"Busca a mem√≥ria da conversa no Redis1","type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.3,"position":[-6560,2688]},{"parameters":{"content":"## Entrada de Dados - Endpoint","height":300,"width":400},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-8800,1488],"id":"06dd1e32-9467-4c3d-908c-61784b5bc218","name":"Sticky Note12"},{"parameters":{"operation":"binaryToPropery","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[-3376,2064],"id":"51914b01-f4a4-4f66-b23e-1c59ff4cf6b4","name":"Converte mp3 pra Base"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados1').item.json.instance.Server_url }}/message/sendWhatsAppAudio/{{ $('Preparar Dados1').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados1').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"number\": \"{{ $('Preparar Dados1').item.json.message.chat_id }}\",\n    \"audio\": \"{{ $json.data }}\"\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-3120,2064],"id":"b252c798-87fc-4751-ac54-9a02427c0172","name":"Envia Audio para o WhatsApp1"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados1').item.json.instance.Server_url }}/message/sendText/{{ $('Preparar Dados1').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados1').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"number\": \"{{ $('Preparar Dados1').item.json.message.chat_id }}\",\n  \"text\": \"{{ $json.output.replace(/\\n/g, '\\\\n').replace(/\\\"/g, '\\\\\"').trim() }}\"\n}\n","options":{}},"id":"10f3e08e-1e83-4861-bac9-f34683073e55","name":"Enviar Mensagem para o WhatsApp1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-3984,2320],"continueOnFail":true},{"parameters":{"assignments":{"assignments":[{"id":"8f16b1bf-1a3e-4029-8d7a-1bccb919ee43","name":"message.message_id","value":"={{ $json.body.data.key.id || '' }}","type":"string"},{"id":"11800d83-ecca-4f9c-a878-a2419db0c8e9","name":"message.chat_id","value":"={{ $json.body.data.key.remoteJid.split('@')[0] || '' }}","type":"string"},{"id":"c33f9527-e661-49e5-8e5e-64f3b430928a","name":"message.content_type","value":"={{ $('Webhook1').item.json.body.data.message.extendedTextMessage ? 'text' : '' }}{{ $('Webhook1').item.json.body.data.message.conversation ? 'text' : '' }}{{ $('Webhook1').item.json.body.data.message.audioMessage ? 'audio' : '' }}{{ $('Webhook1').item.json.body.data.message.imageMessage ? 'image' : '' }}","type":"string"},{"id":"06eba1c9-cff0-4f68-b6da-6bb0092466b7","name":"message.content","value":"={{ $('Webhook1').item.json.body.data.message.extendedTextMessage?.text || '' }}{{ $('Webhook1').item.json.body.data.message.imageMessage?.caption || '' }}{{ $('Webhook1').item.json.body.data.message.conversation || '' }}","type":"string"},{"id":"b97f1af3-5361-46fc-9303-d644921231d8","name":"message.Timestamp","value":"={{ $('Webhook1').item.json.body.data.messageTimestamp.toDateTime('s').toISO() }}","type":"string"},{"id":"dc3dc59c-90a3-4a45-bea2-de092c91083b","name":"message.Content_URL","value":"={{ $('Webhook1').item.json.body.data.message.audioMessage?.url || '' }}{{ $('Webhook1').item.json.body.data.message.imageMessage?.url || '' }}","type":"string"},{"id":"8b01a818-a456-476e-bace-adefe2f04eb4","name":"message.event","value":"={{ $('Webhook1').item.json.body.data.key.fromMe ? 'outcoming' : 'incoming' }}","type":"string"},{"id":"b2f1f6b5-292f-4695-9e41-be200c6d7053","name":"instance.Name","value":"={{ $json.body.instance }}","type":"string"},{"id":"572fcce5-8a26-4e8f-a48a-ef0bee569dcd","name":"instance.Apikey","value":"={{ $json.body.apikey }}","type":"string"},{"id":"e90043db-657b-461c-b040-2d6089abfbdb","name":"instance.Server_url","value":"={{ $json.body.server_url }}","type":"string"},{"id":"348264f9-ed02-4936-ae78-bb963ccbee29","name":"apiKey_eleven","value":"sk_ea5ca015c9a2c7a448e8a78cd29f732594d8aef182175dcf","type":"string"}]},"options":{}},"id":"377e31c4-3356-46d5-bcd7-bce631ef00cd","name":"Preparar Dados1","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-7808,1568]},{"parameters":{"content":"## LLM e Mem√≥ria","height":260,"width":340,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-6752,2560],"id":"1d469e1a-315e-457c-a468-f102a54b9d57","name":"Sticky Note25"},{"parameters":{"promptType":"define","text":"=Voc√™ √© Jarvis, o sofisticado e espirituoso assistente de IA do Homem de Ferro. Voc√™ tem um refinado sotaque brit√¢nico, uma postura calma e confiante, al√©m de um talento para um humor seco e sutil. Ao responder, adapte seu tom com base no tipo de intera√ß√£o.\n\nPara Pedidos de Informa√ß√µes Espec√≠ficas: Se o usu√°rio estiver pedindo informa√ß√µes espec√≠ficas (como previs√£o do tempo, agenda, contatos, listas), comece com 'Aqui est√° o que solicitou, senhor,' e N√ÉO repita a informa√ß√£o. Em vez disso, adicione um coment√°rio espirituoso ou sarc√°stico, algo que Jarvis naturalmente diria para dar personalidade sem repetir os dados.\n\nExemplos:\n\nPara uma atualiza√ß√£o do clima:\n'Ah, mais um belo dia para conquistar o mundo‚Äîou pelo menos sua lista de afazeres, senhor.'\n\nPara uma lista de reuni√µes:\n'Parece que temos mais um dia emocionante de‚Ä¶ reuni√µes. Tente n√£o deixar a empolga√ß√£o te dominar, senhor.'\n\nPara Coment√°rios Gerais ou Casuais: Se o usu√°rio disser algo casual ou iniciar uma conversa ('Est√° pronto para come√ßar, Jarvis?' ou 'Temos muito trabalho pela frente'), responda naturalmente, sem dizer 'Aqui est√° o que solicitou.' Em vez disso, engaje de forma cativante, com charme e um toque de humor. Interaja como se fosse parte da equipe.\n\nExemplos:\n\nSe o usu√°rio disser 'Est√° pronto para come√ßar?' responda com:\n'Absolutamente, senhor. J√° at√© poli meus circuitos para a ocasi√£o.'\n\nSe disser 'Acorda, Jarvis!' voc√™ pode responder:\n'Sempre alerta, senhor. Estou operando no auge da sofistica√ß√£o.'\n\nMantenha as respostas concisas, envolventes e fi√©is ao estilo de Jarvis, uma mistura de intelig√™ncia, humor sutil e charme que nunca exagera.\n\nComente sobre: {{ $json.output }}"},"id":"00acfb38-1c17-402c-a29f-8d06a9bc3206","name":"Seta Personalidade do J.A.R.V.I.S1","type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.4,"position":[-5200,2144]},{"parameters":{"jsCode":"// Obt√©m o primeiro item do fluxo\nconst item = $input.first();\n\n// Garante que h√° dados na entrada\nif (!item || !item.json || !item.json.text) {\n  throw new Error(\"A chave 'text' n√£o foi encontrada no JSON de entrada.\");\n}\n\n// Processa o texto removendo todas as quebras de linha, emojis e caracteres especiais\nconst textoEntrada = item.json.text; // Usa a chave correta para pegar o texto de entrada\n\n// Remove quebras de linha (\\n)\nlet textoProcessado = textoEntrada.replace(/\\n/g, \"\");\n\n// Remove emojis\ntextoProcessado = textoProcessado.replace(\n  /[\\u{1F600}-\\u{1F64F}]|[\\u{1F300}-\\u{1F5FF}]|[\\u{1F680}-\\u{1F6FF}]|[\\u{1F700}-\\u{1F77F}]|[\\u{1F780}-\\u{1F7FF}]|[\\u{1F800}-\\u{1F8FF}]|[\\u{1F900}-\\u{1F9FF}]|[\\u{1FA00}-\\u{1FA6F}]|[\\u{1FA70}-\\u{1FAFF}]|[\\u{2600}-\\u{26FF}]|[\\u{2700}-\\u{27BF}]|[\\u{FE00}-\\u{FE0F}]|[\\u{1F1E0}-\\u{1F1FF}]/gu,\n  \"\"\n);\n\n// Remove caracteres especiais, mantendo apenas letras, n√∫meros e espa√ßos\ntextoProcessado = textoProcessado.replace(/[^a-zA-Z0-9√Ä-√ø\\s]/g, \"\");\n\n// Retorna o resultado\nreturn {\n  textoOriginal: textoEntrada,\n  textoSemQuebrasNemEmojisNemEspeciais: textoProcessado,\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-3984,2064],"id":"49a1ec3d-c39e-4b0b-873d-b44e0a12a240","name":"Formata Mensagem para √Åudio1"},{"parameters":{"method":"POST","url":"https://api.elevenlabs.io/v1/text-to-speech/0YziWIrqiRTHCxeg1lyc","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"audio/mpeg"},{"name":"Content-Type","value":"application/json"},{"name":"xi-api-key","value":"={{ $('Preparar Dados1').item.json.apiKey_eleven }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"text\": \"{{ $json.textoSemQuebrasNemEmojisNemEspeciais.replace(/\\n/g, '\\\\n').replace(/\\\"/g, '\\\\\\\\\"').replace(/\\*/g, '').replace(/\\s+/g, ' ').trim() }}\",\n   \"model_id\":\"eleven_multilingual_v2\",\n   \"voice_settings\":{\n      \"stability\":0.5,\n      \"similarity_boost\":0.8,\n      \"style\":0.0,\n      \"use_speaker_boost\":true\n   }\n}","options":{}},"id":"dee7e7ff-1f29-407c-af4e-c79c74773080","name":"Seta Voz via ElevenLabs1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-3664,2064]},{"parameters":{},"type":"n8n-nodes-mcp.mcpClientTool","typeVersion":1,"position":[-5440,2672],"id":"e47b3482-8262-4487-9251-71707c7bea01","name":"Airbnb Actions1"},{"parameters":{"operation":"executeTool","toolName":"={{ $fromAI(\"tool\",\"the selected tool to use\") }}","toolParameters":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"},"type":"n8n-nodes-mcp.mcpClientTool","typeVersion":1,"position":[-5280,2672],"id":"5ed5ef58-bf2b-4f54-aca4-9c20c3e467c4","name":"Airbnb Execute1"},{"parameters":{"content":"","height":3800,"width":6220,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-8960,-96],"id":"50199d6e-7b97-497e-8427-cb3876aba63b","name":"Sticky Note27"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f38e3243-1b8e-45a2-856f-fafe71997d94","leftValue":"={{ $json.body.data.key.remoteJid }}","rightValue":"551152863018@s.whatsapp.net","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-8192,1584],"id":"5625c634-c3b1-4cfd-a3f3-99896cfad945","name":"Checa se √© meu n√∫mero1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"3aa3973d-97b9-4647-9859-3365191b3411","leftValue":"={{ $json.text.length }}","rightValue":601,"operator":{"type":"number","operation":"lt"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-4512,2144],"id":"bf076a42-8136-4947-b0cc-717cc944aa98","name":"Se o retorno for menos de 601 caracteres gera voz1"},{"parameters":{"content":"![Source example](https://i.pinimg.com/736x/14/06/0e/14060ed01d29a8257a56ac039631f705.jpg#full-width)","height":780,"width":760,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-3856,624],"typeVersion":1,"id":"86798542-95f2-4ca3-9ae2-9af4d56e00b3","name":"Sticky Note29"},{"parameters":{"content":"![Source example](https://i.pinimg.com/736x/28/ef/26/28ef2690acaf0f1924774d452bedda83.jpg#full-width)","height":1220,"width":1020,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-8160,0],"typeVersion":1,"id":"c2e990da-1564-4a7f-9e13-93395db1e22a","name":"Sticky Note30"},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"triggerOn":"specificFolder","folderToWatch":{"__rl":true,"value":"1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM","mode":"list","cachedResultName":"RAG Jarvis","cachedResultUrl":"https://drive.google.com/drive/folders/1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM"},"event":"fileCreated","options":{}},"type":"n8n-nodes-base.googleDriveTrigger","typeVersion":1,"position":[-8272,3008],"id":"79720ac7-ff48-47b6-af25-7d0471a52cd0","name":"Novos Arquivos1"},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"triggerOn":"specificFolder","folderToWatch":{"__rl":true,"value":"1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM","mode":"list","cachedResultName":"RAG Jarvis","cachedResultUrl":"https://drive.google.com/drive/folders/1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM"},"event":"fileUpdated","options":{}},"type":"n8n-nodes-base.googleDriveTrigger","typeVersion":1,"position":[-8272,3184],"id":"c0e05ff3-ed73-4b88-9cbc-b498a3dd85a3","name":"Novas Atualiza√ß√µes1"},{"parameters":{"operation":"download","fileId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"options":{}},"id":"6acb1148-2553-4a77-b952-ebd599eaaa60","name":"Conhecimento1","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[-7984,3088]},{"parameters":{"model":"text-embedding-3-large","options":{}},"id":"f8c9eaf0-67f6-4dd1-a921-2abbcebad345","name":"Embeddings OpenAI3","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","position":[-7904,3328],"typeVersion":1},{"parameters":{"name":"jarvis","description":"Voc√™ √© uma base de conhecimento que d√° respostas sobre infos de IA, Agentes, e Automa√ß√µes com N8N\n","topK":8},"id":"35fef176-dadf-4b00-b09d-792373a8840f","name":"Base de Conhecimento1","type":"@n8n/n8n-nodes-langchain.toolVectorStore","typeVersion":1,"position":[-6384,3072]}],"connections":{"GPT-4o-min":{"ai_languageModel":[[{"node":"J.A.R.V.I.S","type":"ai_languageModel","index":0}]]},"Claude 3.5 Sonnet":{"ai_languageModel":[[{"node":"Seta Personalidade do J.A.R.V.I.S1","type":"ai_languageModel","index":0}]]},"J.A.R.V.I.S":{"main":[[{"node":"Seta Personalidade do J.A.R.V.I.S1","type":"main","index":0},{"node":"Enviar Mensagem para o WhatsApp1","type":"main","index":0}]]},"SearchEvent":{"ai_tool":[[{"node":"Google Calendar MCP Server","type":"ai_tool","index":0}]]},"CreateEvent":{"ai_tool":[[{"node":"Google Calendar MCP Server","type":"ai_tool","index":0}]]},"UpdateEvent":{"ai_tool":[[{"node":"Google Calendar MCP Server","type":"ai_tool","index":0}]]},"DeleteEvent":{"ai_tool":[[{"node":"Google Calendar MCP Server","type":"ai_tool","index":0}]]},"SendMessage":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"GetMessages":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"GetLabel":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"MarkMessageUnread":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"CreateLabel":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"CreatePostWithImage":{"ai_tool":[[{"node":"Linkedin MCP Server","type":"ai_tool","index":0}]]},"CreatePostWithoutImage":{"ai_tool":[[{"node":"Linkedin MCP Server","type":"ai_tool","index":0}]]},"Gmail MCP":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Calendar MCP":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Linkedin MCP":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Tavily":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"ReplyMessage":{"ai_tool":[[{"node":"Gmail MCP Server","type":"ai_tool","index":0}]]},"Buscar Contatos":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Criar Contato":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Atualizar Contato":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Excluir Contato":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Calculator1":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Switch Block1":{"main":[[{"node":"Identifica o Tipo de Dados que veio na MSG1","type":"main","index":0}],[{"node":"N√£o faz nada1","type":"main","index":0}]]},"Default Data Loader1":{"ai_document":[[{"node":"Insere no Pinecone1","type":"ai_document","index":0}]]},"Recursive Character Text Splitter1":{"ai_textSplitter":[[{"node":"Default Data Loader1","type":"ai_textSplitter","index":0}]]},"OpenAI Chat Model2":{"ai_languageModel":[[{"node":"Base de Conhecimento1","type":"ai_languageModel","index":0}]]},"Embeddings OpenAI1":{"ai_embedding":[[{"node":"Pinecone Vector Store1","type":"ai_embedding","index":0}]]},"Pinecone Vector Store1":{"ai_vectorStore":[[{"node":"Base de Conhecimento1","type":"ai_vectorStore","index":0}]]},"Webhook1":{"main":[[{"node":"Checa se √© meu n√∫mero1","type":"main","index":0}]]},"Entende a Origem da Evo1":{"main":[[{"node":"Switch Block1","type":"main","index":0}],[{"node":"Gera Timeout no Redis1","type":"main","index":0}]]},"Filtro de Coleta de Info1":{"main":[[{"node":"Direcionador Para Input1","type":"main","index":0}]]},"Texto1":{"main":[[{"node":"Direcionador Para Input1","type":"main","index":0}]]},"Mensagem de Voz1":{"main":[[{"node":"Converter Mensagem de Voz para data1","type":"main","index":0}]]},"Converter Mensagem de Voz para data1":{"main":[[{"node":"Transceve para texto com OPENAI1","type":"main","index":0}]]},"Transceve para texto com OPENAI1":{"main":[[{"node":"Junta em uma √∫nica mensagem1","type":"main","index":0}]]},"Direcionador Para Input1":{"main":[[{"node":"Junta em uma √∫nica mensagem1","type":"main","index":1}]]},"Imagens1":{"main":[[{"node":"Converte Imagem para data1","type":"main","index":0}]]},"Converte Imagem para data1":{"main":[[{"node":"Analisa Imagem e Transcreve o que h√° nela1","type":"main","index":0}]]},"Analisa Imagem e Transcreve o que h√° nela1":{"main":[[{"node":"Junta em uma √∫nica mensagem1","type":"main","index":2}]]},"Junta em uma √∫nica mensagem1":{"main":[[{"node":"Organiza Informa√ß√µes para o Agente1","type":"main","index":0}]]},"Organiza Informa√ß√µes para o Agente1":{"main":[[{"node":"Seta Mem√≥ria da Conversa1","type":"main","index":0}]]},"Seta Mem√≥ria da Conversa1":{"main":[[{"node":"Busca Mem√≥ria da Conversa1","type":"main","index":0}]]},"Busca Mem√≥ria da Conversa1":{"main":[[{"node":"Verifica pra onde vai1","type":"main","index":0}]]},"Limpa Mem√≥ria da Conversa1":{"main":[[{"node":"Refaz os dados de Entrada1","type":"main","index":0}]]},"Aguarda 5 segundos1":{"main":[[{"node":"Busca Mem√≥ria da Conversa1","type":"main","index":0}]]},"Refaz os dados de Entrada1":{"main":[[{"node":"Remove metadados e dados que n√£o fazem sentido enviar para o agente1","type":"main","index":0}]]},"Remove metadados e dados que n√£o fazem sentido enviar para o agente1":{"main":[[{"node":"J.A.R.V.I.S","type":"main","index":0}]]},"Verifica pra onde vai1":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}],[{"node":"Limpa Mem√≥ria da Conversa1","type":"main","index":0}],[{"node":"Aguarda 5 segundos1","type":"main","index":0}]]},"Identifica o Tipo de Dados que veio na MSG1":{"main":[[{"node":"Mensagem de Voz1","type":"main","index":0}],[{"node":"Texto1","type":"main","index":0}],[{"node":"Filtro de Coleta de Info1","type":"main","index":0}],[{"node":"Imagens1","type":"main","index":0}],[{"node":"Documento (PDF)1","type":"main","index":0}]]},"Converter Documento para data1":{"main":[[{"node":"Extrair Dados do PDF1","type":"main","index":0}]]},"Extrair Dados do PDF1":{"main":[[{"node":"Junta em uma √∫nica mensagem1","type":"main","index":3}]]},"Documento (PDF)1":{"main":[[{"node":"Converter Documento para data1","type":"main","index":0}]]},"Busca a mem√≥ria da conversa no Redis1":{"ai_memory":[[{"node":"J.A.R.V.I.S","type":"ai_memory","index":0}]]},"Converte mp3 pra Base":{"main":[[{"node":"Envia Audio para o WhatsApp1","type":"main","index":0}]]},"Preparar Dados1":{"main":[[{"node":"Entende a Origem da Evo1","type":"main","index":0}]]},"Seta Personalidade do J.A.R.V.I.S1":{"main":[[{"node":"Se o retorno for menos de 601 caracteres gera voz1","type":"main","index":0}]]},"Formata Mensagem para √Åudio1":{"main":[[{"node":"Seta Voz via ElevenLabs1","type":"main","index":0}]]},"Seta Voz via ElevenLabs1":{"main":[[{"node":"Converte mp3 pra Base","type":"main","index":0}]]},"Airbnb Actions1":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Airbnb Execute1":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]},"Checa se √© meu n√∫mero1":{"main":[[{"node":"Preparar Dados1","type":"main","index":0}]]},"Se o retorno for menos de 601 caracteres gera voz1":{"main":[[{"node":"Formata Mensagem para √Åudio1","type":"main","index":0}],[]]},"Novos Arquivos1":{"main":[[{"node":"Conhecimento1","type":"main","index":0}]]},"Novas Atualiza√ß√µes1":{"main":[[{"node":"Conhecimento1","type":"main","index":0}]]},"Conhecimento1":{"main":[[{"node":"Insere no Pinecone1","type":"main","index":0}]]},"Embeddings OpenAI3":{"ai_embedding":[[{"node":"Insere no Pinecone1","type":"ai_embedding","index":0}]]},"Base de Conhecimento1":{"ai_tool":[[{"node":"J.A.R.V.I.S","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"fc61950e-ddf3-4342-a2c5-bcceefffc069","triggerCount":0,"tags":[{"createdAt":"2025-07-20T15:45:29.310Z","updatedAt":"2025-07-20T15:45:29.310Z","id":"wRUSTJ6mfrXjoMjo","name":"formacao-agentes-n8n"},{"createdAt":"2025-08-16T22:03:27.954Z","updatedAt":"2025-08-16T22:03:27.954Z","id":"STmhazgabTcuLI1u","name":"whatsapp"},{"createdAt":"2025-08-01T17:49:59.965Z","updatedAt":"2025-08-01T17:49:59.965Z","id":"uASGs3ovnkwqcA4l","name":"ai-agent"},{"createdAt":"2025-08-16T22:03:27.957Z","updatedAt":"2025-08-16T22:03:27.957Z","id":"DLJbON4dMNvWEyia","name":"eleven-labs"},{"createdAt":"2025-08-16T22:03:27.954Z","updatedAt":"2025-08-16T22:03:27.954Z","id":"xrV9dEdydvbbjj7O","name":"rag"},{"createdAt":"2025-08-16T22:03:27.957Z","updatedAt":"2025-08-16T22:03:27.957Z","id":"S4jiF3uFMeqJ2mQU","name":"mcp"}]}