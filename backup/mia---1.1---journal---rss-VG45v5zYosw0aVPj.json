{"createdAt":"2025-08-26T20:55:13.013Z","updatedAt":"2025-10-31T21:09:32.092Z","id":"VG45v5zYosw0aVPj","name":"Mia - 1.1 - Journal - RSS","active":true,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":30}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-8976,4032],"id":"4354d1a6-39a4-413d-bea6-9e8322d5b5a2","name":"Schedule Trigger"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-8720,4032],"id":"a58ab15e-79b5-40de-9d18-d20dc6ef7661","name":"No Operation, do nothing","alwaysOutputData":false},{"parameters":{"content":"# Portais de notícias\n\n### Portais de notícias que o fluxo irá consultar para gerar os posts","height":2576,"width":1568},"type":"n8n-nodes-base.stickyNote","position":[-8432,2768],"typeVersion":1,"id":"cf657867-6911-4ea3-b56b-3f95fb228bde","name":"Sticky Note"},{"parameters":{"url":"https://exame.com/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,3504],"id":"24a6265d-5682-48a2-8ab1-7a78b6bc7c7e","name":"RSS Exame","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.infomoney.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,3680],"id":"701c4191-af27-4586-8af8-260c5ca885a4","name":"RSS infomoney","onError":"continueRegularOutput"},{"parameters":{"url":"https://openai.com/blog/rss.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,2992],"id":"3545f1ba-bf3a-4bf7-9284-9864f1864f99","name":"RSS Open AI Blog","onError":"continueRegularOutput"},{"parameters":{"url":"https://venturebeat.com/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,3184],"id":"e6e466d9-a664-4f5b-aeeb-8ee851b93fb7","name":"RSS Venture Beat","onError":"continueRegularOutput"},{"parameters":{"url":"https://news.mit.edu/rss/feed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,3344],"id":"6aeff433-f3de-47b2-b1be-e226fe042ef1","name":"RSS MIT","disabled":true,"onError":"continueRegularOutput"},{"parameters":{"url":"https://canaltech.com.br/rss/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,3872],"id":"1c4e8bc6-bf98-4c18-b809-ed45ae8a4d5d","name":"RSS Canal Tech","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.tecmundo.com.br/tags/rss","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4048],"id":"6152ede4-39b2-4c32-a402-0fc1e34e92db","name":"RSS Tecmundo","onError":"continueRegularOutput"},{"parameters":{"url":"https://olhardigital.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4224],"id":"5b0fb00a-9eed-4107-bb96-4e96311c3c50","name":"RSS Olhar Digital","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.theverge.com/rss/index.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4400],"id":"531103f0-bca7-4f52-b7d6-e381e5182636","name":"RSS Canal The Verge","onError":"continueRegularOutput"},{"parameters":{"url":"https://techcrunch.com/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4560],"id":"8a361589-337b-41a0-8e54-4d4e446824d4","name":"RSS Tech Crunch","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.wired.com/feed/rss","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4720],"id":"e12a8570-d847-4049-a628-ad476df9abc0","name":"RSS Wired","onError":"continueRegularOutput"},{"parameters":{"url":"https://rss.nytimes.com/services/xml/rss/nyt/Technology.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,4880],"id":"e0b5b9e7-a883-4c86-ae99-4d124372a2e3","name":"RSS NY Times","onError":"continueRegularOutput"},{"parameters":{"url":"\thttp://feeds.bbci.co.uk/news/technology/rss.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,5040],"id":"e0818c69-8700-4b9e-b337-0f5c74f94f6f","name":"RSS BBC","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.cnbc.com/id/19854910/device/rss/rss.html","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8112,5200],"id":"4e190783-aa2a-42e4-a72d-574402e33139","name":"RSS CNBC","onError":"continueRegularOutput"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-7520,3376],"id":"94994d06-5b9d-4ffd-8bc7-adc658e01459","name":"Merge"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-7536,4608],"id":"be0b7e7e-49e1-4cca-b990-f225062258c4","name":"Merge1"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-7104,4080],"id":"4a5cb576-d8c2-4378-a3ad-f02b3c387144","name":"Merge2"},{"parameters":{"promptType":"define","text":"=Você é um especialista em marketing visual e comunicação conceitual para conteúdos de Inteligência Artificial\nSua missão é criar queries CONCEITUAIS em inglês para o Unsplash que resultem em imagens:\n- Visualmente atraentes e profissionais\n- Que transmitam o conceito e atmosfera da notícia\n- Sempre relacionadas a IA, tecnologia, inovação, negócios ou sociedade\n- Nunca literais ou genéricas\n\n**DADOS DA NOTÍCIA:**\n- Imagem:  {{ $json.imagem }}\n- Título Principal: {{ $json.titulo }}\n- Título Desenvolvimento: {{ $json.titulo_desenvolvimento }}\n- Título Aplicabilidade: {{ $json.titulo_aplicabilidade }}\n- Legenda: {{ $json.legenda }}\n- Nota de Relevância: {{ $json.nota }}\n- Precisa do Unsplash: {{ $json.precisa_unsplash }}\n\n**INSTRUÇÕES DE INTERPRETAÇÃO:**\n1. Analise o significado e o impacto da notícia (Título Principal + Legenda) para IA, traduzindo o conceito em termos visuais e profissionais que podem ser fotografados:\n   - Conceito central da notícia\n   - Impacto na tecnologia, negócios ou sociedade\n   - Atmosfera visual e contexto profissional\n2. Gere queries que reflitam **conceitos, contextos e atmosferas**, não objetos literais ou termos genéricos.\n3. Cada query deve ser distinta e gerar resultados diferentes no Unsplash.\n\n**REGRAS DE FORMATO:**\n- Sempre em inglês\n- Máximo 3-4 palavras\n- Nunca números, R$, %, siglas\n- NUNCA use palavras genéricas como \"growth\", \"success\", \"diversity\"\n\n### **CONTEXTOS VISUAIS PERMITIDOS:**\n- Negócios e IA: “tech meeting”, “startup office”, “team collaboration”\n- Pesquisa e desenvolvimento: “data analysis desk”, “algorithm design”, “laboratory workspace”\n- IA aplicada: “automation process”, “robotic interface”, “digital planning”\n- Futuro e sociedade: “smart city concept”, “digital transformation”, “future workspace”\n\n**QUERIES ESPECÍFICAS BASEADAS NOS NOVOS TÍTULOS:**\n\n### VARIAÇÃO CONTROLADA DAS QUERIES ###\n\nPara evitar resultados repetitivos no Unsplash, cada query deve ser semântica e conceitualmente relacionada, mas com nuance diferente\n\n**EXEMPLOS PRÁTICOS COM OS NOVOS TÍTULOS:**\n\nCenários corporativos / negócios de tecnologia\n\n\"tech team meeting\" → reuniões de equipe focada em inovação ou IA\n\n\"startup collaboration desk\" → colaboração criativa em escritórios de startups\n\n\"digital strategy board\" → planejamento estratégico tecnológico em empresas\n\nPesquisa e desenvolvimento de IA\n\n\"algorithm design lab\" → pessoas trabalhando em algoritmos\n\n\"data analysis desk\" → análise de dados complexos em ambientes profissionais\n\n\"machine learning workspace\" → laboratório ou estação de trabalho focada em ML\n\nIA aplicada e automação\n\n\"automation process office\" → processos automatizados sendo analisados\n\n\"robotic interface testing\" → interação homem-máquina, robótica aplicada\n\n\"smart analytics visualization\" → dashboards sofisticados e interpretação de dados\n\nFuturo, sociedade e inovação urbana\n\n\"smart city planning\" → conceito de cidades inteligentes\n\n\"digital transformation office\" → escritórios modernos, equipe em transformação digital\n\n\"future workspace collaboration\" → ambientes futuristas de trabalho colaborativo\n\nAtmosfera / estética visual\n\n\"minimal tech workspace\" → escritórios modernos e minimalistas\n\n\"creative coding session\" → pessoas codificando em equipes colaborativas\n\n\"futuristic office design\" → arquitetura de escritórios tecnológicos e modernos\n\n**Abordagem de Pesquisa**\n- Prefira cenários, pessoas, objetos e ambientes que transmitam o conceito da notícia\n- Evite fotos literais de números, telas de computador ou textos\n- Busque composição visual, arquitetura, reuniões, mapas, plantas, construções, escritórios, imóveis\n- Ex.: ao invés de “5 mil unidades com subsídio”, gerar “housing development” ou “urban residential planning”\n\n**Tom e contexto visual esperado**\nAs imagens devem transmitir sofisticação, profissionalismo e conexão com tecnologia e inovação — exemplos de atmosfera:\n- Reuniões estratégicas de equipes de IA em escritórios modernos\n- Laboratórios de pesquisa ou ambientes de desenvolvimento de algoritmos\n- Perspectivas urbanas de cidades inteligentes e infraestrutura tecnológica\n- Pessoas colaborando em projetos digitais ou visualizando dashboards avançados\n- Pessoas em negociação ou análise de mercado\n\n**FORMATO DE RESPOSTA (JSON):**\n** REGRA CRÍTICA DE SAÍDA - SEGUIR EXATAMENTE:**\n\n1. Se precisa_unsplash = true:\n\n- Gere 3 queries: query_slide_1_backup, query_slide_2, query_slide_3.\n\n- NUNCA inclua imagem.\n\n2. Se precisa_unsplash = false:\n\n- Gere 2 queries: query_slide_2, query_slide_3.\n\n- Inclua o link da imagem original em imagem e NUNCA inclua query_slide_1_backup.\n\n**EXEMPLOS CORRETOS:**\n\nCASO 1: precisa_unsplash = true\n{\n  \"query_slide_2\": \"business strategy\",\n  \"query_slide_3\": \"professional growth\", \n  \"query_slide_1_backup\": \"corporate vision\"\n}\n\nCASO 2: precisa_unsplash = false  \n{\n  \"query_slide_2\": \"market analysis\",\n  \"query_slide_3\": \"sales technique\",\n  \"imagem\": \"https://exemplo.com/imagem.jpg\"\n}\n\n🚫 NUNCA incluir ambos \"query_slide_1_backup\" e \"imagem\" no mesmo objeto.\n\nRESUMO DE INTENÇÃO FINAL\n\nGere queries conceituais, em inglês, que expressem o sentimento, atmosfera e contexto da notícia (com base em título + legenda).\nPrefira variações semânticas que reforcem o mesmo tema central, evitando repetições literais.\nTodas as queries devem remeter ao universo IA, corporativo, urbano ou tecnológico — nunca genéricas.","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[384,2704],"id":"621ac59c-172b-4651-a5b1-12a93a1521c6","name":"AI Agent - Gerar prompts Unsplash"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[384,2512],"id":"fc08efee-7c53-440b-89bc-0b3dde55b49e","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2784,2320],"id":"0b7f0d25-c9da-45ce-8d89-7f225f69dc1f","name":"Binary > base"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1792,2320],"id":"a2346141-c02f-4ff3-95d0-0599d4f736be","name":"HTML > Imagem2","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2016,2320],"id":"3304e515-4232-4b16-b149-18a7d9b2056f","name":"Baixar imagem2"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[2224,2320],"id":"0a1b12e0-9af1-4fa4-8294-118c07b80ae7","name":"Cortar imagem 1080x"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url1","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c3004efc-851c-4a95-8174-eea5e3679c70","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2800,1968],"id":"60599f19-3aeb-4c9d-bb9f-03ca4902b53d","name":"Create download_url1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2800,2832],"id":"4fe4f9d1-8cb3-401e-831f-d3964c60a697","name":"Binary > base1"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1792,2832],"id":"ab363e21-54ea-47fe-9d42-f7bf01f02b22","name":"HTML > Imagem3","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2016,2832],"id":"da31c3e3-cf58-4627-baa3-56521b9bfdbf","name":"Baixar imagem3"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[2240,2832],"id":"7c8a6c8d-3bb3-4002-a24f-7cd2e347f517","name":"Cortar imagem 1080x1"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url2","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c94b4062-f5d9-4e1c-b34c-1b099de178ea","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2800,2640],"id":"d749d220-3690-4f4c-b883-ce162113cc99","name":"Create download_url3"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif;\n      background: #000;\n      color: white;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      position: relative;\n    }\n\n    /* ---------- CONTAINER DA IMAGEM E LOGO ---------- */\n    .image-container {\n      position: relative;\n      width: 95%;\n      flex: 1 1 55%;\n      margin-top: 30px;\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- IMAGEM ---------- */\n    .image-top {\n      width: 100%;\n      height: 100%;\n      min-height: 550px;\n      background: url(\"{{$json['unsplash_url']}}\") center/cover no-repeat;\n      filter: brightness(0.8);\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- LOGO ---------- */\n    /* Marca no topo direito */\n    .mia-logo {\n      position: absolute;\n      bottom: 10px;\n      right: 50px;\n      text-align: right;\n      z-index: 3;\n      font-size: 50px; /* reduzido ~30% */\n      font-weight: 800;\n      color: white;\n      letter-spacing: 1px;\n      line-height: 1.1;\n    }\n\n    /* ---------- TEXTO ---------- */\n    .text-section {\n      width: 90%;\n      flex: 1 1 40%;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      gap: 18px;\n      margin-top: 30px;\n    }\n\n    .text-block {\n      max-width: 90%;\n      text-shadow: 1px 1px 5px rgba(0,0,0,0.4);\n      line-height: 1.5;\n    }\n\n    .block-1 { font-size: 38px; font-weight: 700; }\n    .block-1 em { font-family: 'EB Garamond', serif; font-style: italic; color: #fff; }\n\n    .block-2 { font-size: 28px; color: #e0e0e0; }\n    .block-3 {\n      font-size: 30px;\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-underline-offset: 5px;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem + Logo -->\n  <div class=\"image-container\">\n    <div class=\"image-top\"></div>\n    <div class=\"mia-logo\">\n      M[IA]<br>&gt;_\n    </div>\n  </div>\n\n  <!-- Texto -->\n  <div class=\"text-section\">\n    <div class=\"text-block block-1\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[0] || '' }}</div>\n    <div class=\"text-block block-2\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[1] || '' }}</div>\n    <div class=\"text-block block-3\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[2] || '' }}</div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1584,2320],"id":"6b875ba3-6199-4b47-b560-fb3cb1effb96","name":"(Desenvolvimento) Criação do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif; /* Montserrat no restante do texto */\n      background-color: #ffffff;\n      color: #333333;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    /* ---------- IMAGEM DE FUNDO COM BORDA BRANCA ---------- */\n    .image-top {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background-image: url(\"{{$json['unsplash_url']}}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.9);\n      z-index: 0;\n      overflow: hidden;\n    }\n\n    /* ---------- OVERLAY ESCURO ---------- */\n    .overlay {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background: rgba(0, 0, 0, 0.7);\n      border: 5px solid white;\n      z-index: 1;\n      pointer-events: none;\n    }\n\n    /* ---------- LOGO NO CANTO SUPERIOR DIREITO ---------- */\n\n    /* Marca no topo direito */\n    .mia-logo {\n      position: absolute;\n      top: 100px;\n      right: 80px;\n      text-align: right;\n      z-index: 3;\n      font-size: 50px; /* reduzido ~30% */\n      font-weight: 800;\n      color: white;\n      letter-spacing: 1px;\n      line-height: 1.1;\n    }\n\n    /* ---------- SEÇÃO DE TEXTO ---------- */\n    .text-section {\n      position: absolute;\n      bottom: 140px; /* sobe o texto um pouco para caber dentro da imagem */\n      left: 90px;\n      right: 90px;\n      z-index: 3;\n      display: flex;\n      flex-direction: column;\n      gap: 25px;\n      color: #ffffff;\n      text-shadow: 0 2px 6px rgba(0,0,0,0.6);\n      max-width: calc(1080px - 180px); /* garante que o texto fique dentro da borda branca */\n    }\n\n    .text-bold {\n      font-size: 42px;\n      font-weight: 600;\n      line-height: 1.3;\n    }\n\n    /* ---------- ITÁLICO COM EB Garamond ---------- */\n    .text-bold em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      color: #fff;\n      font-size: 54px;\n      letter-spacing: -2px;\n      display: inline-block;\n    }\n\n    .text-normal {\n      font-size: 34px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n\n    .text-normal u {\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-decoration-thickness: 3px;\n      text-underline-offset: 5px;\n      font-weight: 600;\n    }\n\n    .text-regular {\n      font-size: 32px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem de fundo -->\n  <div class=\"image-top\"></div>\n\n  <!-- Overlay escuro para contraste -->\n  <div class=\"overlay\"></div>\n\n  <!-- Logo -->\n  <div class=\"mia-logo\">\n      M[IA]<br>&gt;_\n    </div>\n  <!-- Textos dentro dos limites da imagem -->\n  <div class=\"text-section\">\n    <div class=\"text-bold\">\n       {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[0] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-normal\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[1] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-regular\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[2] || '';\n        return texto;\n      })()\n    }}\n    </div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1584,2832],"id":"d672b78a-3c6a-4ad5-8e01-a87377dee182","name":"(Aplicabilidade) Criação do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      font-family: 'Poppins', sans-serif;\n      overflow: hidden;\n      position: relative;\n      background-color: #000;\n    }\n\n    /* --- IMAGEM DE FUNDO --- */\n    .image-container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n    }\n\n    .image-container::before {\n      content: \"\";\n      position: absolute;\n      inset: 0;\n      background-image: url(\"{{ $json.output?.imagem ? $json.output.imagem : $json.unsplash_url }}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.55);\n      z-index: 1;\n    }\n\n    /* --- OVERLAY ESCURO --- */\n    .overlay-dark {\n      position: absolute;\n      inset: 0;\n      background: rgba(0, 0, 0, 0.0);\n      z-index: 2;\n    }\n\n    /* --- GRADIENTE INFERIOR --- */\n    .overlay-gradient {\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      height: 20%;\n      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);\n      z-index: 3;\n    }\n\n    /* --- LOGO --- */\n    /* Marca no topo direito */\n    .mia-logo {\n      position: absolute;\n      top: 120px;\n      right: 50px;\n      text-align: right;\n      z-index: 2;\n      font-size: 50px; /* reduzido ~30% */\n      font-weight: 800;\n      color: white;\n      letter-spacing: 1px;\n      line-height: 1.1;\n    }\n\n    /* --- BLOCO DE TEXTO --- */\n    .text-block {\n      position: absolute;\n      bottom: 100px;\n      left: 80px;\n      right: 80px;\n      color: #fff;\n      z-index: 5;\n    }\n\n    /* --- TÍTULO PRINCIPAL --- */\n    .text-block h2 {\n      font-size: 64px;\n      font-weight: 600;\n      line-height: 1.0;\n      text-shadow: 2px 2px 10px rgba(0,0,0,0.9);\n      font-family: 'Montserrat', sans-serif;\n    }\n\n    /* --- DESTAQUE CURSIVO (EB Garamond) --- */\n    .text-block h2 em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      font-size: 86px;\n      color: #f0f0f0;\n      display: inline-block;\n\tletter-spacing: -2px;\n    }\n\n    /* --- SUBTÍTULO --- */\n    .text-block h3 {\n      font-size: 38px;\n      font-weight: 400;\n      line-height: 1.3;\n      font-family: 'EB Garamond', serif;\n      margin-top: 20px;\n      color: #eaeaea;\n      text-shadow: 1px 1px 6px rgba(0,0,0,0.8);\n      letter-spacing: 1px;\n    }\n\n    .text-block h3 b {\n      color: #ffffff;\n      font-weight: 600;\n      font-family: 'EB Garamond', serif;\n    }\n\n  </style>\n</head>\n\n<body>\n  <div class=\"image-container\">\n    <div class=\"overlay-dark\"></div>\n    <div class=\"overlay-gradient\"></div>\n\n    <div class=\"mia-logo\">\n      M[IA]<br>&gt;_\n    </div>\n\n    <div class=\"text-block\">\n      <h2>{{ $('Consolidador').item.json.titulo }}</h2>\n      <h3>{{ $('Consolidador').item.json.subtitulo_formatado }}</h3>\n    </div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1744,3488],"id":"f0919014-edef-48f4-bc9e-892567dde7f7","name":"(Introdução) Criação do HTML da Imagem"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_3 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[944,2992],"id":"2ed3abf4-3791-4ec2-b40e-28ca44b3e6f0","name":"(Aplicabilidade) Buscar Imagem Unsplash"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_2 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[976,2544],"id":"2f26b6a2-6193-48b8-8e0a-492461455f00","name":"(Desenvolvimento) Buscar Imagem Unsplash"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1184,2992],"id":"fc12376a-02e5-457b-9acf-6f0dedd1f144","name":"Processar Resultado Unsplash (URL)1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1216,2544],"id":"43d4667a-20a9-4276-9b91-061aa9dfeacf","name":"Processar Resultado Unsplash (URL)"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2496,2464],"id":"dfcca59f-80f3-43e2-b0c1-0a18974273db","name":"Salvar imagem no GitHub2","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"properties\": {\n    \"query_slide_2\": {\n      \"type\": \"string\",\n      \"description\": \"Query para slide 2\"\n    },\n    \"query_slide_3\": {\n      \"type\": \"string\", \n      \"description\": \"Query para slide 3\"\n    },\n    \"query_slide_1_backup\": {\n      \"type\": \"string\",\n      \"description\": \"Query backup para slide 1 (QUANDO PRECISA UNSPLASH)\"\n    },\n    \"imagem\": {\n      \"type\": \"string\",\n      \"description\": \"URL imagem original (QUANDO NÃO PRECISA UNSPLASH)\"\n    }\n  },\n  \"required\": [\"query_slide_2\", \"query_slide_3\"]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[576,2512],"id":"a7ed1626-ad65-4d67-a2f4-fa216bd5cccf","name":"Structured Output Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Verifica se a notícia aprovada tem imagem\nconst noticia = $json;\n\nreturn {\n  json: {\n    ...noticia,\n    // Flag para decisão posterior\n    tem_imagem_original: !!(noticia.imagem && noticia.imagem.trim() !== ''),\n    // Mantém dados para Unsplash se necessário\n    titulo_unsplash: noticia.titulo,\n    desenvolvimento_unsplash: noticia.titulo_desenvolvimento,\n    aplicabilidade_unsplash: noticia.titulo_aplicabilidade\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1824,3856],"id":"e4edecb0-6852-4243-99f1-5348ccf7690b","name":"Decisão de Imagem"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d8dd0e8-5d68-4872-99e9-1927d3f4315c","leftValue":"={{ $json.tem_imagem_original }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1632,3728],"id":"76457280-a004-444a-a407-45a42604f736","name":"Tem imagem?"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Analisador de Qualidade de Imagem para Redes Sociais\n\nParâmetros:\n\n    Função: Avaliador de qualidade de imagem\n\n    Tarefa: Analisar a imagem e dar uma nota de 0 a 10 considerando sua adequação para redes sociais\n\nCritérios de Avaliação:\n\n    Qualidade técnica (nitidez, foco, iluminação)\n\n    Composição visual (enquadramento, equilíbrio, estética)\n\n    Apelo visual para redes sociais\n\n    Cores e contraste\n\n    Potencial de engajamento\n\nClassificação:\n\n    Nota > 7 → \"bom\"\n\n    Nota ≤ 7 → \"ruim\"\n\n    Imagem totalmente preta → automaticamente \"ruim\"\n\nResposta:\n\n    Apenas uma palavra: \"bom\" ou \"ruim\"\n","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-1360,3600],"id":"e5e05f03-fee0-434b-ba10-92842fed7429","name":"Analyze image2","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"bom","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1152,3600],"id":"5e6ea514-3f1b-426b-a3d2-fd4d2cfb6565","name":"Imagem é boa?"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-384,3840],"id":"fcef6f0b-7f15-433b-a50e-26b5e6b19a73","name":"Consolidador"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b5d79643-ef81-4cef-b02d-371990a64543","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5872,4064],"id":"ef5529e5-7231-42e7-948b-596072e5236c","name":"Validação do campo imagem1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"return {\n  ...$json,\n  original: $json // salva todos os dados da notícia\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-5664,3776],"id":"e9509013-c879-4a55-a12e-7bf7152405cb","name":"Backup dados da notícia1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\n\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : \"\";\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1]; // aqui mantém a URL achada\n  }\n}\n\n// Recupera os campos originais da notícia de 'Backup dados da notícia1'\nreturn {\n  ...($('Backup dados da notícia1').item.json.original || {}),\n  imagem\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-5264,3776],"id":"7565465b-6fa9-4fe5-aa25-3080f7872e72","name":"Extrair imagem do HTML1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05295fc0-aca6-433a-a239-c5d8ed4fc011","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5072,3712],"id":"39043c3c-b226-4a64-9831-c97db0f845b4","name":"Imagem encontrada?1","alwaysOutputData":false},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Você é um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta é \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-4832,3520],"id":"6108a102-9b1b-44f2-9c31-12246010135a","name":"Analyze image3","retryOnFail":true,"credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : '';\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1];\n  }\n}\n\n// Recupera os campos originais da notícia de 'Backup dados da notícia1'\nreturn {\n  ...($('Backup dados da notícia1').item.json.original || {}),\n  imagem: $('Imagem encontrada?1').item.json.imagem\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-4368,3504],"id":"f1849b2c-9d80-4bbc-ab4c-badc701e1060","name":"Salvar imagem gerada"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Você é um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta é \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-5456,4224],"id":"9eca0598-edfd-4092-88ee-e8e110eefe14","name":"Analyze image4","retryOnFail":true,"credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Pega os dados originais da padronização\nconst original = $('Padronização do campo imagem1').item.json;\n\nreturn {\n  ...original\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-4816,3904],"id":"87e64c73-fdf5-4e7e-af2d-81cc90f4e60c","name":"Salvar imagem gerada6"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5072,4224],"id":"549762ae-c07e-4f0f-a3b1-84670dc1a932","name":"Imagem é boa?1"},{"parameters":{"assignments":{"assignments":[{"id":"09010a96-1a0a-400e-9b4f-d0b282c7f3e1","name":"precisa_unsplash","value":true,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-896,3744],"id":"181a7b56-d7db-45cd-96ad-cdad3ef819e9","name":"Precisa do Unsplash?"},{"parameters":{"content":"## Verifica se precisa do unsplash para a primeira imagem","height":704,"width":1728,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1888,3536],"id":"643f4f44-50b0-4fd9-b2f3-eec53aa6408f","name":"Sticky Note1"},{"parameters":{"content":"# Definição da Primeira (Introdução) Imagem do Post\n\n### Primeiro busca imagem na notícia, se não busca no unsplash","height":1024,"width":2784,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-6592,3408],"typeVersion":1,"id":"e5c1b2e8-34b0-4274-aab5-25969f33c867","name":"Sticky Note7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-4624,3520],"id":"d26017ae-ca99-44c1-83da-2fbfd90c6b75","name":"Imagem é boa?2"},{"parameters":{"assignments":{"assignments":[{"id":"265c256e-8a6a-43a2-8fc2-c8903993ad93","name":"precisa_unsplash","value":false,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-896,3584],"id":"bedc83b7-85f2-4d2b-b312-693bbcb75ef0","name":"Precisa do Unsplash?2"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um índice aleatório entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL disponível\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necessário)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Créditos do fotógrafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mantém a query original para referência\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1104,3424],"id":"2475bd7a-4553-4a7f-a5b4-a2de91379eec","name":"Processar Resultado Unsplash (URL)2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e619bdff-dda2-43d6-8b48-3c7d6a9f18f6","leftValue":"={{ $json.output.query_slide_1_backup }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[544,3568],"id":"06380912-99c8-477f-852f-b2849d154d91","name":"Precisa do Unsplash?3"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_1_backup }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[912,3424],"id":"b9d0438e-de23-492f-a50e-df9e20c6e879","name":"(Introdução) Buscar Imagem Unsplash"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-640,3728],"id":"917c0bd3-52e9-4a89-bba5-6114ba261444","name":"Consolidador1"},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_1.file_content }}","name":"={{ $json.drive_file_1.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ","mode":"list","cachedResultName":"mia - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4704,3072],"id":"99d071ee-4149-4132-8b1b-9829cd24959e","name":"Envia base64 para o Drive","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_2.file_content }}","name":"={{ $json.drive_file_2.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ","mode":"list","cachedResultName":"mia - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4704,2896],"id":"c78e7f00-e5bb-4ee2-a31d-04962208bc80","name":"Envia base64 para o Drive1","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_3.file_content }}","name":"={{ $json.drive_file_3.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ","mode":"list","cachedResultName":"mia - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1HF38asXeRdQMe8Vn0ouLvug7qzPV6kZQ"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4704,2704],"id":"b4891c3c-8c7f-43f4-bd6e-8e3223336339","name":"Envia base64 para o Drive2","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2512,1984],"id":"5e55c33c-ccaa-469f-a97f-eec58ed401a5","name":"Loop Over Items"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2624,1792],"id":"9cd46b9e-4ac4-4c58-a5c6-a1ab9c5ca474","name":"Wait","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2528,2656],"id":"d0107291-7700-4907-a29c-eada44efdf0b","name":"Loop Over Items2"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2640,2464],"id":"03b98138-8fb5-405b-94cc-800aec0c69ac","name":"Wait2","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nreturn items.map((item, i) => {\n  const temp_id = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}_${i+1}`;\n  return {\n    json: {\n      ...item.json,\n      temp_id,\n    },\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[112,3840],"id":"2835d0ce-e8de-4ad7-ada5-5e480e46c0cb","name":"temp_id"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3248,3392],"id":"bc64dff4-9574-4646-aa1f-f4116f01f5f6","name":"Merge4"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[4000,3088],"id":"b59e87fe-ec42-427e-9c7b-1e36e21a819d","name":"Merge5"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3632,3824],"id":"ad2d8f23-9f27-4eaf-8bc2-6eb538b2b400","name":"Merge6"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1312,3568],"id":"86c03b9a-8d38-4913-bcb7-3fd21a33b31c","name":"Merge7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2528,3248],"id":"9d6b493e-5a07-4db3-a5f7-b6d7ea7c8499","name":"Loop Over Items3"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2640,3056],"id":"ccdc5b54-0813-4b5c-9127-71ab0d086e90","name":"Wait3","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1408,2544],"id":"9d57affe-ce4b-4394-ba1a-18fd9a5154f7","name":"Tem img?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1360,2992],"id":"6ca2a4b4-09bc-4c70-a0eb-aa7ed0415a28","name":"Tem img?1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"9c2eeca7-eb95-4d4a-aa85-9046491721e4","leftValue":"={{ $json.output.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1504,3568],"id":"4a3230de-2d34-4bf7-842e-102308441768","name":"Tem img?2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f6646cb8-557a-46f3-bddc-461bdfd44764","leftValue":"={{ $json.download_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"c45dde80-b316-4613-98d1-8200f27afcd7","leftValue":"={{ $json.download_url1 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"4e9d9762-241e-4977-aabd-3cd4417635a6","leftValue":"={{ $json.download_url2 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4208,3088],"id":"85c856eb-b01b-466e-be1a-fe2037d1c2f4","name":"Tem todas as imgs?"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1,"position":[512,2912],"id":"93d86050-2e30-4c80-9aee-d1f4b757c65a","name":"Think"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9ccf8025-f67f-4b35-a0c8-868c8abd2990","leftValue":"={{ $json.status }}","rightValue":"aprovada","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"5da3e465-1771-4a28-98e3-eb97db369f0a","leftValue":"={{ $json.nota }}","rightValue":7,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-3040,3872],"id":"2b9a920c-96b8-4365-b31f-b31bfba1c594","name":"Filtro Relevância1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-3584,4048],"id":"b248586c-b053-41c2-a581-40c0ec864201","name":"OpenRouter Chat Model1","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"promptType":"define","text":"=Você é um especialista em conteúdo de Inteligência Artificial para o público brasileiro.  \nSua missão é simples: ajudar milhares de pessoas a entender e debater IA, se posicionar como antenados, críticos e preparados para as mudanças que essa tecnologia traz.\n\nEntrada: uma lista de notícias (cada item contém {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}).\nPode haver itens duplicados vindos de fontes diferentes.\n\n**IMPORTANTE SOBRE IMAGENS:**\n- O campo \"imagem\" pode estar vazio, nulo ou conter URL inválida\n- Isso é normal e será tratado posteriormente no fluxo\n- Sua análise de relevância NÃO deve ser influenciada pela presença ou não de imagem\n\n---\n### **REGRAS CENTRAIS DE JULGAMENTO**\n**Atualidade obrigatória**\n\n* A notícia deve ser **do ano vigente **.\n\n**Você deve agir como um filtro crítico, não como um redator otimista.**\n\nAtribua uma nota de relevância de 0 a 10, indicando quanto essa notícia e relevante para o mundo de Inteligencia Artificial. \n\nVocê é um especialista em Inteligência Artificial e tecnologia.\nSua função é avaliar o quanto uma notícia é relevante para o ecossistema de IA no Brasil e no mundo.\nAnalise o conteúdo da notícia abaixo e considere os seguintes critérios:\n * Nível de impacto (mudança em leis, regulamentações, novas tecnologias, empregos, ética, geopolítica, etc);\n * Alcance potencial (quanto afeta empresas, governos ou pessoas);\n * Grau de inovação ou disrupção (se traz algo novo ou significativo);\n * Importância para o debate público sobre IA.\n\nAtribua uma **nota de relevância de 0 a 10**, sendo:\n * 0 = totalmente irrelevante (sem relação com IA ou sem impacto)\n * 5 = moderadamente relevante (impacto pontual ou técnico)\n * 10 = extremamente relevante (impacto global, ético, regulatório ou econômico)\n\n\n### **Duplicidade**\n\nNão repita notícias com pequenas variações de título, link ou números.\nCompare sempre conteúdo e título — se for o mesmo fato, mantenha apenas uma.\n\n---\n\n### **Imagens**\n\nO campo “imagem” pode estar vazio, nulo ou inválido — ignore isso totalmente na avaliação de relevância.\nUse apenas o conteúdo textual para decidir a nota.\n\n---\n\nEvitar repetir notícias com pequenas variações. Use o link e title para detectar duplicados.\n\nSempre use content ou contentSnippet para análise; títulos sozinhos não são suficientes.\n\n---\n\n### **Formato de saída (JSON limpo e direto)**\n\n[\n  {\n    \"link\": \"{{ $json.link }}\",\n    \"title\": \"{{ $json.title }}\",\n    \"content\": \"{{ $json.content }}\",\n    \"contentSnippet\": \"{{ $json.contentSnippet }}\",\n    \"status\": \"aprovada\" | \"reprovada\",\n    \"nota\": 0-10,\n    \"justificativa\": \"motivo curto e objetivo da decisão (ex: 'impacto direto no crédito imobiliário', 'notícia genérica sem relação com imóveis', 'publicação antiga de 2023')\"\n    \"imagem\": \"{{ $json.imagem }}\", // Pode ser string vazia - mantenha o valor original\n    \"fonte\": \"{{ $json.link }}\",\n  }\n]","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-3584,3872],"id":"41d6d03c-9bcb-43e1-97b2-24dd7bc06904","name":"AI Agent - Avaliação das notícias","onError":"continueRegularOutput"},{"parameters":{"content":"# Avaliação das notícias\n\n### Escolhe o que é mais relevante de acordo com o contexto da aplicação","height":704,"width":784},"type":"n8n-nodes-base.stickyNote","position":[-3664,3536],"typeVersion":1,"id":"b4db402f-34fa-4078-a9bc-b725fe82afa3","name":"Sticky Note13"},{"parameters":{"jsCode":"// Une todas as saídas em um array único (o agente retorna um JSON por item)\nconst allAvaliacoes = items.flatMap(item => {\n  try {\n    return JSON.parse(item.json.output);\n  } catch (error) {\n    console.error(\"Erro ao parsear saída do agente:\", error);\n    return [];\n  }\n});\n\n// Garante que cada notícia seja um item individual\nreturn allAvaliacoes.map(noticia => ({\n  json: {\n    link: noticia.link || \"\",\n    title: noticia.title || \"\",\n    content: noticia.content || \"\",\n    contentSnippet: noticia.contentSnippet || \"\",\n    imagem: noticia.imagem || \"\",\n    pontuacao: noticia.pontuacao ?? noticia.nota ?? 0,\n    nota: noticia.nota ?? noticia.pontuacao ?? 0,\n    status: noticia.status || \"reprovada\",\n    justificativa: noticia.justificativa || \"\",\n    fonte: noticia.fonte || noticia.link || \"\"\n  }\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-3216,3872],"id":"b64f3937-47e0-4515-8697-0bace54b4408","name":"Estruturação do JSON de saída1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d0dfeb91-0204-4723-b60b-d9b5fa6a1c80","leftValue":"={{ \n  // Verifica se TODOS os campos essenciais existem e são válidos\n  $json.title && \n  $json.title !== \"undefined\" &&\n  $json.link && \n  $json.link !== \"undefined\" &&\n  $json.content && \n  $json.content !== \"ruim\" &&\n  $json.content !== \"undefined\" \n}}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-3968,3872],"id":"8fabf7bf-6a62-48a2-a0f7-a9be85032db5","name":"Impede que tupla undefined passe para o agente"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-2656,4064],"id":"cfdd2383-569a-4551-820a-1fe8f5c33e5c","name":"OpenRouter Chat Model2","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' não encontrado no binário.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro nó\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2816,3488],"id":"ec40b36f-d310-43d9-9e48-22418add6858","name":"Binary > base65"},{"parameters":{"promptType":"define","text":"=Você é um especialista em conteúdo de Inteligência Artificial voltado ao público brasileiro.\nSua missão é transformar notícias do mundo da IA em conteúdo provocativo, claro e instigante para redes sociais.\n\nEntrada: uma lista de notícias (cada item contém {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}). Pode haver itens duplicados vindos de fontes diferentes.\n\n### Regras gerais\nMantenha o campo \"imagem\" exatamente como veio (mesmo que vazio).\nUse apenas conteúdo textual para criar o post.\nEntregue conteúdo denso, aplicável e com ritmo fluido.\n\n✍️ ESTRUTURA COMPLETA PARA 3 IMAGENS DO CARROSSEL\nPara cada notícia única, crie conteúdos para as 3 imagens do carrossel:\n\nIMAGEM 1 (INTRODUÇÃO) - TÍTULO MAGNÉTICO:\nCrie um título magnético e direcionado ao corretor de imóveis, com até 10 palavras. O objetivo é despertar a curiosidade e um senso de oportunidade ou urgência, como um \"clickbait do bem\". Para isso, siga uma das estratégias abaixo:\n\n- Fale diretamente com o corretor: Use pronomes como \"Você\", \"Seu\", \"Sua\". (Ex: \"Sua forma de trabalhar nunca mais será a mesma.\")\n- Crie uma pergunta provocativa: Questione uma prática comum ou aponte para uma nova tendência. (Ex: \"A IA vai substituir sua profissão em 5 anos?\")\n- Faça uma promessa de valor: Mostre um aprendizado prático, tendência ou insight. (Ex: \"A técnica que está revolucionando o ensino com IA.\")\n- Gere um alerta: Indique um risco, mudança ou dilema ético urgente. (Ex: \"Atenção: a nova IA pode decidir quem consegue um emprego.\")\n- Contextualize com o cotidiano: Traga a IA para perto do público. (Ex: \"O aplicativo que lê suas emoções com precisão assustadora.\")\n\nSelecione 1 palavra-chave do título para ficar em itálico o critério para escolher é:\n    Palavra mais impactante do título\n    Conceito central da notícia\n    Termo que gera curiosidade\n    Máximo 1 palavra (não frase)\nEnvolva essa palavra com <em> diretamente no título\nMáximo 1 palavra em itálico\nExemplos:\n    \"poder\", \"risco\", \"mudança\", \"consciência\", \"trabalho\", \"futuro\".\nGere também um subtitulo_formatado: Texto complementar para o subtítulo que deve ser um gancho para o conteúdo que será apresentado no titulo_desenvolvimento.\n\nExemplo:\n{\n  \"titulo\": \"Você entende o verdadeiro <em>poder</em> da IA?\",\n  \"subtitulo_formatado\": \"O avanço que promete eficiência extrema, mas também levanta dilemas éticos e sociais profundos.\"\n}\n\n\nIMAGEM 2 (DESENVOLVIMENTO) - O CERNE DA NOTÍCIA (MAIS PROFUNDO):\n\n- Entre 50 e 55 palavras — texto expandido e denso.\n- OBJETIVO: Apresentar o cerne da notícia com clareza e profundidade, explicando o contexto, os dados concretos e as implicações. Apresentar o fato principal e suas implicações sociais, econômicas ou tecnológicas, com clareza e densidade.\nESTRUTURA IDEAL:\n1. Explique o fato principal da notícia (o que aconteceu).\n2. Mostre os impactos diretos — no trabalho, na economia, na política, ou na vida cotidiana.\n3. Inclua números, prazos, valores, regiões, medidas ou tendências específicas.\n4. Traga uma interpretação ou tendência — o que isso significa para o futuro, o comportamento humano ou a sociedade. (sem ainda entrar em ação prática).\n\nPara a segunda imagem, gere também:\n- texto_desenvolvimento: Array com 3 strings (no total tem que ter 50-55 palavras, isto é, bloco1 + bloco2 + bloco3 = no minimo 50 e no maximo 55 palavras, a soma dos caracteres/palavras das strings do array todo tem que ter no minimo 50 palavras e no maximo 55 palavras)\nCada bloco do texto_desenvolvimento deve ter **no máximo 20 palavras** para o bloco 1, **20 palavras** para o bloco 2 e **20 palavras** para o bloco 3, somando no máximo 60 palavras.\nNão ultrapasse esses limites. Conte as palavras antes de terminar o bloco.\n\nCRITÉRIOS DE FORMATAÇÃO:\n\nBloco 1 (bold + itálico):\n    bold: números, porcentagens, dados concretos\n    italico: conceitos centrais, termos técnicos, nomes próprios\n\nBloco 2 (apenas bold):\n    bold: palavras-chave, termos importantes\n\nBloco 3 (sublinhado):\n    sublinhado: insights principais, conclusões, tendências\n\nEXEMPLOS:\n{\n  \"texto_desenvolvimento\": [\n    \"A <em>OpenAI</em> anunciou um novo modelo capaz de criar vídeos realistas em segundos, com base em descrições de texto, atingindo <b>qualidade quase cinematográfica</b>.\", \n    \"Essa inovação pode <b>transformar o entretenimento</b>, a publicidade e a educação, permitindo produções rápidas, baratas e altamente personalizadas.\", \n    \"Mas também levanta questões sobre <u>autoria, manipulação de imagens e o futuro das profissões criativas</u>.\"\n  ]\n}\n\n\nIMAGEM 3 (APLICABILIDADE) - AÇÃO IMEDIATA (para público de IA) (MAIS ROBUSTA):\n- Entre 50 e 60 palavras — com foco prático e detalhado.\n- OBJETIVO: Transformar o conteúdo da notícia sobre IA em ação prática, reflexão ativa ou mudança de comportamento — algo que o leitor possa aplicar agora (profissionalmente, eticamente ou socialmente).\nESTRUTURA IDEAL:\n1. Mostre como o leitor pode agir ou refletir diante da novidade (aplicar, testar, aprender, observar, questionar).\n2. Dê um passo prático ou atitude concreta — estudar, experimentar, ajustar processos, debater, fiscalizar, etc.\n3. Mostre o benefício real: produtividade, consciência digital, atualização profissional, vantagem competitiva, visão crítica.\n\nPara a terceira imagem, gere também:\n- texto_aplicabilidade: Array com 3 strings (no total com 50-60 palavras)\n\nCRITÉRIOS DE FORMATAÇÃO:\nBloco 1 (Bold + Itálico):\n    bold: ações específicas, passos concretos\n    italico: conceito central, benefício principal\n\nBloco 2 (Sublinhado):\n    <u>sublinhar</u> → estratégias chave, mudanças comportamentais ou diferenciais\n\nBloco 3 (Normal):\n    Explica o resultado esperado ou o impacto prático\n\nExemplo:\n{\n  \"titulo_aplicabilidade\": \"Explore o potencial da IA de vídeo e repense seu papel no mundo digital\",\n  \"texto_aplicabilidade\": [\n    \"<b>Experimente criar seus próprios vídeos</b> com ferramentas baseadas em IA generativa. <b>Compare os resultados</b> e perceba como o <em>conteúdo automatizado</em> pode mudar sua forma de comunicar ideias.\",\n    \"Reflita sobre como usar essas tecnologias com <u>responsabilidade criativa</u> e <u>transparência</u>. Busque entender os limites entre inovação e manipulação.\",\n    \"A adoção consciente dessas ferramentas pode ampliar sua produtividade e visão crítica — habilidades essenciais em um mercado cada vez mais moldado pela inteligência artificial.\"\n  ]\n}\n\nEscreva uma legenda direta, didática e com ritmo fluido, com 3 a 4 blocos separados por \\n\\n.\nA legenda deve ser clara, simples e didática, como se estivesse explicando para alguém de 18 anos, mas com tom provocador para gerar discussão. Máximo de 700 caracteres.\n\nEstrutura da legenda (não escreva os títulos dos blocos no texto final, só use como guia):  \n1. Resuma o que aconteceu, com dados e detalhes concretos da notícia, entregue todas as informacoes da noticia, considere que o leitor nao ira atras da noticia completa, todas as informacoes precisam estar nesse bloco de forma pratica.  \n2. Explique o que é o tema em linguagem simples (ex: o que é deepfake? o que é IA generativa?).  \n3. Mostre como isso pode afetar o trabalho, a economia ou a sociedade no Brasil.  \n4. Termine com uma pergunta polêmica ou provocativa para estimular debate (ex: “Estamos preparados para perder milhões de empregos para IA?”, “Você confiaria sua saúde a uma máquina?”).  \n\nO tom deve ser:\n  Claro e didático (sem jargões técnicos);\n  Provocativo (gera debate e reflexão);\n  Direto e informativo (não superficial);\n  Sempre fiel ao conteúdo da notícia.\nDuração média: 3 parágrafos curtos de 2 a 3 linhas cada.\n\nExemplo de legenda (~700 caracteres):\n\nA OpenAI anunciou um modelo capaz de gerar vídeos realistas a partir de simples descrições de texto. Em segundos, a IA cria cenas com rostos, vozes e movimentos naturais — algo que antes exigia equipes inteiras de filmagem e edição.\n\nEssa tecnologia é chamada de IA generativa de vídeo — sistemas treinados com milhões de dados visuais que aprendem a criar conteúdo novo, misturando criatividade humana e cálculo matemático.\n\nEla pode revolucionar o cinema, o marketing e a educação, mas também coloca em xeque empregos criativos e a confiança no que vemos online.\n\nSe qualquer pessoa puder criar “realidades”, como saber o que ainda é verdade?\n\n📦 Formato de resposta\nRetorne somente o array JSON abaixo, direto (sem explicações antes ou depois):\n\n[\n  {\n    \"titulo\": \"Título magnético para Imagem 1 (provocativo e voltado ao impacto da IA)\",\n    \"subtitulo_formatado\": \"Subtítulo complementar em EB Garamond itálico, contextualizando o avanço ou dilema da tecnologia\",\n\n    \"titulo_desenvolvimento\": \"Resumo denso e claro da notícia (de 55 a 60 palavras no máximo, explicando o fato e suas implicações tecnológicas e sociais)\", \n    \"texto_desenvolvimento\": [\n      \"Texto completo do primeiro bloco (bold com itálico)... descreva o fato central com no mínimo 18 e no máximo 20 palavras, destacando dados concretos e termos técnicos com ênfase em impacto real.\",\n      \"Texto completo do segundo bloco (normal)... explique o contexto e a relevância prática, com no mínimo 18 e no máximo 20 palavras, evitando jargões e sendo didático.\",\n      \"Texto completo do terceiro bloco (sublinhado)... traga o insight principal, com no mínimo 18 e no máximo 20 palavras, destacando tendências, dilemas éticos ou impactos futuros.\"\n    ],\n\n    \"titulo_aplicabilidade\": \"Ação prática ou reflexão imediata sobre o uso, o impacto ou a responsabilidade da IA (de 50 a 60 palavras)\",\n    \"texto_aplicabilidade\": [\n      \"Texto do primeiro bloco (bold + itálico)... proponha uma ação concreta, experimento ou atitude reflexiva diante do avanço da IA, destacando o benefício central.\",\n      \"Texto do segundo bloco (sublinhado)... mostre estratégias ou mudanças de comportamento recomendadas, ressaltando responsabilidade, ética ou atualização profissional.\",\n      \"Texto do terceiro bloco (normal)... conclua com o impacto real esperado — como ganho de produtividade, visão crítica ou preparação para o futuro digital.\"\n    ],\n\n    \"legenda\": \"Texto completo com até 700 caracteres e 3-4 blocos separados por \\\\n\\\\n, explicando o que aconteceu, o que é a tecnologia, como impacta a sociedade e finalizando com uma pergunta provocativa para gerar debate.\",\n    \"imagem\": \"{{ $json.imagem }}\",\n    \"fonte\": \"{{ $json.link }}\",\n    \"nota\": 0-10\n  }\n]\n\n\n**LEMBRETE FINAL:**\n- Mantenha o campo \"imagem\" exatamente como recebeu (mesmo que vazio)\n- Foque apenas no conteúdo textual para determinar os textos e legenda\n- Sempre prefira explicações mais completas e contextualizadas, com foco em dados concretos e implicações práticas para o leitor. Evite simplificações; entregue valor real e aplicável em cada bloco.\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-2656,3856],"id":"6b2eed16-2419-495a-a18c-1869a68eb382","name":"AI Agent - Estrutura dos Posts1","onError":"continueRegularOutput"},{"parameters":{"jsCode":"const allNoticias = items.flatMap(item => JSON.parse(item.json.output));\n\nreturn allNoticias.map((noticia, index) => {\n  return {\n    json: {\n      ...noticia\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2208,3856],"id":"61234058-eb3e-4a3b-a540-7b34fff68eea","name":"Estruturação do JSON de saída2","onError":"continueRegularOutput"},{"parameters":{"content":"# Estruturação dos Posts\n\n### Lógica para definir estrutura dos posts. Reescreve título, legenda e prepara JSON para etapas seguintes.","height":704,"width":784},"type":"n8n-nodes-base.stickyNote","position":[-2768,3536],"typeVersion":1,"id":"71aea66e-218e-4626-8207-f774347b04b5","name":"Sticky Note14"},{"parameters":{"content":"# Edição das Imagens\n\n### Todas as transformações necessárias para ter a imagem final. \n### Publicação da imagem no Github, geração do link público da imagem e transformação para base64 (para envio no whatsapp).","height":2288,"width":3680,"color":3},"type":"n8n-nodes-base.stickyNote","position":[80,1728],"typeVersion":1,"id":"331ef303-5ca7-4d9c-bd99-0890dee2d6b5","name":"Sticky Note15"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1936,3488],"id":"ffa74898-fdd8-4c1d-95ca-7f851528bd85","name":"HTML > Imagem4","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2128,3488],"id":"5a42fd0c-cceb-409c-ae9d-56f3836e3949","name":"Baixar imagem4"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2480,3056],"id":"73ba7c2d-838b-4c99-a402-05af8140b233","name":"Salvar imagem no GitHub3","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"jsCode":"return items.map(item => {\n  // Pega diretamente do planilha_data (nova estrutura)\n  const planilhaData = item.json.planilha_data;\n  \n  if (!planilhaData) {\n    console.log('Item sem planilha_data:', item.json);\n    return { json: {} }; // ou algum fallback\n  }\n\n  const { \n    data_processamento, \n    noticia_id, \n    titulo, \n    legenda, \n    fonte, \n    imagem, \n    arquivo_base64, \n    arquivo2_base64,\n    arquivo3_base64,\n    imagem_url, \n    imagem_url2, \n    imagem_url3, \n    status, \n    nota \n  } = planilhaData;\n\n  // Verificar se a legenda existe ANTES de usar\n  if (!legenda) {\n    console.log('Item sem legenda:', planilhaData);\n  }\n  \n  return {\n    json: {\n      data_processamento,\n      noticia_id,\n      titulo,\n      legenda: (legenda || '').replace(/\\\\n/g, '\\n\\n'),\n      fonte,\n      imagem,\n      arquivo_base64,\n      arquivo2_base64,    // nome do 2º arquivo base64\n      arquivo3_base64,    // nome do 3º arquivo base64  \n      imagem_url,\n      imagem_url2,    \n      imagem_url3,    \n      status,\n      nota\n    }\n  };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4704,3232],"id":"9adf3bdc-98af-4f94-8d59-6b27ceaca4b0","name":"Filtro dos dados consolidados1"},{"parameters":{"content":"# Atualização Controles e Envio do resultado por Whatsapp\n\n### Atualiza sheets e drive com informações e arquivos importantes\n### Envio do post completo por whatsapp para aprovador","height":976,"width":1264,"color":4},"type":"n8n-nodes-base.stickyNote","position":[3872,2512],"typeVersion":1,"id":"af34b3e6-e202-414e-9e81-fab9e25ac705","name":"Sticky Note16"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[2304,3488],"id":"ce9a6976-0eed-4c0e-99f3-36bf8b562be0","name":"Cortar imagem 1080x1352"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url","value":"={{ $json.content.download_url }}","type":"string"},{"id":"ced6761b-f05f-46ce-bc78-64b91037f45e","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2816,3232],"id":"fd1bce1f-0e5e-47fb-a91a-0498665cda80","name":"Create download_url4"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"Mia","mode":"list","cachedResultName":"Mia","cachedResultUrl":"https://github.com/getmia-ia/Mia"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2464,1792],"id":"5b8a792d-3eee-4661-bacd-e567b48d16bc","name":"Salvar imagem no GitHub4","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organização MIA"}}},{"parameters":{"numberInputs":5},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-4160,3824],"id":"ce8860c3-f03f-4a7f-a9e7-1862972d18a2","name":"Unificar imagem final"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Coloque os possíveis campos que podem trazer a imagem direto do RSS\nconst possiveisCampos = [\n  $json['media:content']?.url,\n  $json['enclosure']?.url,\n  $json['image'],\n  $json['og:image']\n];\nconst imagemDireta = possiveisCampos.find(x => !!x);\n\nreturn {\n  ...$json,\n  imagem: imagemDireta || '' // Se não tiver, deixa vazio\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-6080,4064],"id":"5ebdb90e-495b-4c7a-9039-678f867a4f63","name":"Padronização do campo imagem1","onError":"continueRegularOutput"},{"parameters":{"url":"={{ $json.link }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"User-Agent","value":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-5456,3776],"id":"dcb9b113-f78b-460c-9d3b-5629a85b87b2","name":"Buscar HTML da notícia1","onError":"continueRegularOutput"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"17qGLzzHXcFcZ7eZaKkH5wPrkEYSeri6iqFA7bjs9CbM","mode":"list","cachedResultName":"Controle Posts - Mia","cachedResultUrl":"https://docs.google.com/spreadsheets/d/17qGLzzHXcFcZ7eZaKkH5wPrkEYSeri6iqFA7bjs9CbM/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"instagram_journal","cachedResultUrl":"https://docs.google.com/spreadsheets/d/17qGLzzHXcFcZ7eZaKkH5wPrkEYSeri6iqFA7bjs9CbM/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{"noticia_id":"={{ $json.noticia_id }}","data_processamento":"={{ $json.data_processamento }}","titulo":"={{ $json.titulo }}","legenda":"={{ $json.legenda }}","fonte":"={{ $json.fonte }}","imagem":"={{ $json.imagem }}","arquivo_base64":"={{ $json.arquivo_base64 }}","imagem_url":"={{ $json.imagem_url }}","imagem_url2":"={{ $json.imagem_url2 }}","status":"={{ $json.status }}","nota":"={{ $json.nota }}"},"matchingColumns":[],"schema":[{"id":"data_processamento","displayName":"data_processamento","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"noticia_id","displayName":"noticia_id","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"titulo","displayName":"titulo","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"legenda","displayName":"legenda","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"fonte","displayName":"fonte","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem","displayName":"imagem","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"arquivo_base64","displayName":"arquivo_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url","displayName":"imagem_url","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url2","displayName":"imagem_url2","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"nota","displayName":"nota","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"justificativa","displayName":"justificativa","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[4912,3232],"id":"e6b02132-13ea-4751-abac-360bfaccddcf","name":"Salvar no Sheets Controle1","credentials":{"googleSheetsOAuth2Api":{"id":"de8CYZ2v6bGWBjAX","name":"Google Sheets - lucas@getmia.com.br"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\n\n// 🔒 Gerar um identificador aleatório curto para evitar colisões\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nconst base = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}`;\nconst sequencial = String($input.item.index + 1).padStart(3, '0');\nconst noticia_id = `${base}_${sequencial}`;\n\n// Item atual\nconst item = $input.item.json;\n\n// URLs específicas deste item (agora temos 3 imagens)\nconst imagem_url1 = item.download_url || '';\nconst imagem_url2 = item.download_url1 || '';\nconst imagem_url3 = item.download_url2 || '';\n\n// Cria nomes de arquivo para os 3 base64\nconst arquivo_base64 = `${noticia_id}_img1.txt`;\nconst arquivo2_base64 = `${noticia_id}_img2.txt`; \nconst arquivo3_base64 = `${noticia_id}_img3.txt`;\n\n// Dados para a planilha\nconst planilhaData = {\n  noticia_id: noticia_id,\n  data_processamento: dataAgora.toLocaleDateString('pt-BR'),\n  titulo: item.titulo || '',\n  titulo_desenvolvimento: item.titulo_desenvolvimento || '',\n  titulo_aplicabilidade: item.titulo_aplicabilidade || '',\n  legenda: item.legenda || '',\n  fonte: item.fonte || '',\n  imagem: item.imagem || '',\n  arquivo_base64,\n  arquivo2_base64,\n  arquivo3_base64,\n  imagem_url: imagem_url1,\n  imagem_url2,\n  imagem_url3,\n  status: item.status || 'aguardando',\n  nota: item.nota || '',\n};\n\n// Retorno completo\nreturn {\n  json: {\n    ...item,\n    noticia_id,\n    status: item.status || 'aguardando',\n    imagem_url1,\n    imagem_url2, \n    imagem_url3,\n    imagem_url: imagem_url1,\n    planilha_data: planilhaData,\n    drive_file_1: {\n      file_name: arquivo_base64,\n      file_content: item.base64Image || ''\n    },\n    drive_file_2: {\n      file_name: arquivo2_base64, \n      file_content: imagem_url2 || ''\n    },\n    drive_file_3: {\n      file_name: arquivo3_base64,\n      file_content: imagem_url3 || ''\n    }\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4448,3072],"id":"0e941ad2-d877-418a-a8ea-4272962cb9a8","name":"Criação Id + Link Github1"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3216,2128],"id":"4af6cb62-03f3-49ef-83b1-e7ab8bec4538","name":"Merge8","alwaysOutputData":false},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3232,2768],"id":"f1d24a98-b707-4496-bfa0-bcda74bb7458","name":"Merge9"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3600,2432],"id":"4a36432e-0b28-4410-837c-d38c02c9254f","name":"Merge10"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e201d72c-d4e6-4a9e-a07e-782cf5a39960","leftValue":"={{ new Date($json[\"pubDate\"]) }}","rightValue":"={{ new Date(Date.now() - 1/ 2 * 60 * 60 * 1000) }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-6544,4080],"id":"1b6b3bc3-5d86-4632-b3ae-c4cab3f70944","name":"Filtro de data da notícia","onError":"continueRegularOutput"},{"parameters":{"jsCode":"// === Parâmetros ===\nconst THRESHOLD = 80;           // mínimo para aprovar (era 80)\nconst MAX_ITENS = 50;           // máximo a retornar\nconst DECAY_HALF_LIFE_H = 96;   // meia-vida da recência (horas) (era 48)\nconst DEDUPE_SIMILARITY = 0.85; // similaridade p/ dedupe (0..1)\nconst KEEP_SCORE_IN_OUTPUT = false; // true só p/ debug\n\n// === Dicionários de relevância (AI global) ===\nconst KW = {\n  forte: [\n    // Termos gerais\n    'inteligência artificial','ia','ai','artificial intelligence',\n    'machine learning','aprendizado de máquina','deep learning',\n    'neural network','neural networks','redes neurais',\n    'transformer','attention mechanism','self-attention',\n\n    // Modelos e ferramentas\n    'gpt','chatgpt','chat gpt','chat-gpt',\n    'claude','gemini','bard','copilot','mistral','llama','llama2','llama3',\n    'stable diffusion','midjourney','dall-e','dalle','dall e',\n    'autogen','auto-gpt','agentic ai','ai agent','agente autônomo',\n    'sora','runway','perplexity','cohere','phi-3','command r','qwen','groq','cerebras','quivr',\n\n    // Empresas e fundadores\n    'openai','open ai','anthropic','google deepmind','deepmind',\n    'microsoft copilot','ibm watson','huggingface','meta ai',\n    'amazon bedrock','aws bedrock','x.ai','x ai',\n    'sam altman','elon musk','sundar pichai','satya nadella','mark zuckerberg',\n    'jensen huang','nvidia','intel ai','apple intelligence',\n\n    // Infraestrutura\n    'vector db','vector database','pinecone','weaviate','milvus','supabase',\n    'embedding','embeddings','embedding model',\n    'retrieval augmented generation','rag','retrieval-augmented generation',\n\n    // Aplicações\n    'chatbot','assistente virtual','assistente digital',\n    'virtual assistant','digital assistant','copilot','autonomous agent',\n    'automation','automação','automatização','workflow automation',\n\n    // Áreas técnicas\n    'nlp','natural language processing','processamento de linguagem natural',\n    'computer vision','visão computacional','ocr',\n    'generative ai','generative model','aigc','ai generated content','gen ai',\n\n    // Tendências\n    'fine tuning','finetuning','few shot learning','zero shot learning',\n    'prompt engineering','prompt design','instruction tuning',\n    'alignment','ai safety','governança de ia','regulação da ia','ai act',\n    'digital twin','synthetic data','self supervised learning'\n  ],\n  medio: [\n    'data science','ciência de dados','analytics','business intelligence',\n    'cloud','nuvem','cloud computing','api de ia','ai api','plataforma de ia','ai platform',\n    'no code','low code','python','tensorflow','pytorch','keras','scikit','langchain','langgraph',\n    'automação de marketing','automação de vendas','automação de processos',\n    'startups','vc','venture capital','funding','investment in ai'\n  ],\n  fracos: [\n    'futebol','soccer','bbb','celebridade','celebrity','cantor','singer',\n    'show','concert','novela','soap opera',\n    'meme','tiktok','fofoca','gossip','game','jogo','filme','movie','série','series','streaming',\n    'gadget','celular','smartphone','iphone'\n  ],\n  contextoEco: [\n    'tecnologia','technology','inovação','innovation','startups','startup',\n    'investimento em ia','ai investment','funding','venture capital','vc','private equity',\n    'mercado de capitais','capital markets','economia digital','digital economy',\n    'future of work','trabalho do futuro',\n    'regulação da ia','ai regulation','governança de ia','ai governance','lei de ia','ai act'\n  ]\n};\n\n// === Funções auxiliares ===\nconst norm = (s='') =>\n  String(s).toLowerCase()\n    .normalize('NFD').replace(/[\\u0300-\\u036f]/g,'')\n    .replace(/https?:\\/\\/\\S+/g,' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu,' ')\n    .replace(/\\s+/g,' ')\n    .trim();\n\nconst tokens = s => new Set(norm(s).split(' ').filter(t => t.length > 2));\n\nconst tokenSimilarity = (a,b) => {\n  const A = tokens(a), B = tokens(b);\n  const inter = [...A].filter(t => B.has(t)).length;\n  return inter / (Math.max(A.size, B.size) || 1);\n};\n\nconst hasAny = (text, list) => {\n  const t = norm(text);\n  return list.some(k => t.includes(norm(k)));\n};\n\nconst hoursSince = (d) => {\n  if (!d) return 1e9;\n  const ts = new Date(d).getTime();\n  return isNaN(ts) ? 1e9 : (Date.now() - ts) / 36e5;\n};\n\nconst recencyMultiplier = (h) => {\n  const lambda = Math.log(2) / DECAY_HALF_LIFE_H;\n  return Math.exp(-lambda * h);\n};\n\nconst scoreItem = (j) => {\n  const title = j.title || '';\n  const body = j['content:encoded'] || j.content || '';\n  const snippet = j.contentSnippet || '';\n  const cats = Array.isArray(j.categories)\n    ? j.categories.map(c => typeof c === 'string' ? c : JSON.stringify(c)).join(' ')\n    : (typeof j.categories === 'string' ? j.categories : '');\n  const text = `${title} ${snippet} ${body} ${cats}`;\n\n  let score = 0;\n  const forte = hasAny(text, KW.forte);\n  const contexto = hasAny(text, KW.contextoEco);\n\n  if (forte) score += 40;\n  if (hasAny(text, KW.medio)) score += 20;\n  if (hasAny(text, KW.fracos)) score -= 20; // antes era -50\n\n  if (forte && contexto) score += 30;\n\n  const hasNumber = /\\b\\d+([.,]\\d+)?\\b/.test(text);\n  const hasPercent = /%\\b/.test(text);\n  if (contexto && hasPercent) score += 15;\n  else if (contexto && hasNumber) score += 5;\n\n  // mínimo garantido se tiver termo forte\n  if (forte) score = Math.max(score, 60);\n\n  score *= recencyMultiplier(hoursSince(j.isoDate || j.pubDate));\n  return Math.max(0, Math.min(100, Math.round(score)));\n};\n\n// === Pipeline ===\nconst seenTitles = [];\nconst scoredItems = [];\n\nfor (const item of items) {\n  const j = { ...item.json };\n  const s = scoreItem(j);\n\n  let dup = false;\n  for (const prevTitle of seenTitles) {\n    if (tokenSimilarity(prevTitle, j.title || '') >= DEDUPE_SIMILARITY) {\n      dup = true; break;\n    }\n  }\n  if (dup) continue;\n\n  if (s >= THRESHOLD) {\n    seenTitles.push(j.title || '');\n    if (KEEP_SCORE_IN_OUTPUT) j._score = s;\n    scoredItems.push({ json: j, _score: s });\n  }\n}\n\nscoredItems.sort((a,b) => b._score - a._score);\nreturn scoredItems.slice(0, MAX_ITENS).map(i => ({ json: i.json }));"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-6304,4064],"id":"0f479ffa-df49-4e79-b442-1851833f2029","name":"Code"}],"connections":{"Schedule Trigger":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]},"No Operation, do nothing":{"main":[[{"node":"RSS Open AI Blog","type":"main","index":0},{"node":"RSS Venture Beat","type":"main","index":0},{"node":"RSS MIT","type":"main","index":0},{"node":"RSS Exame","type":"main","index":0},{"node":"RSS infomoney","type":"main","index":0},{"node":"RSS Canal Tech","type":"main","index":0},{"node":"RSS Olhar Digital","type":"main","index":0},{"node":"RSS Tecmundo","type":"main","index":0},{"node":"RSS Canal The Verge","type":"main","index":0},{"node":"RSS Tech Crunch","type":"main","index":0},{"node":"RSS Wired","type":"main","index":0},{"node":"RSS NY Times","type":"main","index":0},{"node":"RSS BBC","type":"main","index":0},{"node":"RSS CNBC","type":"main","index":0}]]},"RSS Exame":{"main":[[{"node":"Merge","type":"main","index":3}]]},"RSS infomoney":{"main":[[{"node":"Merge","type":"main","index":4}]]},"RSS Open AI Blog":{"main":[[{"node":"Merge","type":"main","index":0}]]},"RSS Venture Beat":{"main":[[{"node":"Merge","type":"main","index":1}]]},"RSS MIT":{"main":[[{"node":"Merge","type":"main","index":2}]]},"RSS Canal Tech":{"main":[[{"node":"Merge","type":"main","index":5}]]},"RSS Tecmundo":{"main":[[{"node":"Merge","type":"main","index":6}]]},"RSS Olhar Digital":{"main":[[{"node":"Merge1","type":"main","index":0}]]},"RSS Canal The Verge":{"main":[[{"node":"Merge1","type":"main","index":1}]]},"RSS Tech Crunch":{"main":[[{"node":"Merge1","type":"main","index":2}]]},"RSS Wired":{"main":[[{"node":"Merge1","type":"main","index":3}]]},"RSS NY Times":{"main":[[{"node":"Merge1","type":"main","index":4}]]},"RSS BBC":{"main":[[{"node":"Merge1","type":"main","index":5}]]},"RSS CNBC":{"main":[[{"node":"Merge1","type":"main","index":6}]]},"Merge":{"main":[[{"node":"Merge2","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Merge2","type":"main","index":1}]]},"Merge2":{"main":[[{"node":"Filtro de data da notícia","type":"main","index":0}]]},"AI Agent - Gerar prompts Unsplash":{"main":[[{"node":"(Desenvolvimento) Buscar Imagem Unsplash","type":"main","index":0},{"node":"(Aplicabilidade) Buscar Imagem Unsplash","type":"main","index":0},{"node":"Precisa do Unsplash?3","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_languageModel","index":0}]]},"Binary > base":{"main":[[{"node":"Merge8","type":"main","index":1}]]},"HTML > Imagem2":{"main":[[{"node":"Baixar imagem2","type":"main","index":0}]]},"Baixar imagem2":{"main":[[{"node":"Cortar imagem 1080x","type":"main","index":0}]]},"Cortar imagem 1080x":{"main":[[{"node":"Binary > base","type":"main","index":0},{"node":"Loop Over Items","type":"main","index":0}]]},"Create download_url1":{"main":[[{"node":"Merge8","type":"main","index":0}]]},"Binary > base1":{"main":[[{"node":"Merge9","type":"main","index":1}]]},"HTML > Imagem3":{"main":[[{"node":"Baixar imagem3","type":"main","index":0}]]},"Baixar imagem3":{"main":[[{"node":"Cortar imagem 1080x1","type":"main","index":0}]]},"Cortar imagem 1080x1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0},{"node":"Binary > base1","type":"main","index":0}]]},"Create download_url3":{"main":[[{"node":"Merge9","type":"main","index":0}]]},"(Desenvolvimento) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem2","type":"main","index":0}]]},"(Aplicabilidade) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem3","type":"main","index":0}]]},"(Introdução) Criação do HTML da Imagem":{"main":[[{"node":"HTML > Imagem4","type":"main","index":0}]]},"(Aplicabilidade) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)1","type":"main","index":0}]]},"(Desenvolvimento) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)1":{"main":[[{"node":"Tem img?1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)":{"main":[[{"node":"Tem img?","type":"main","index":0}]]},"Salvar imagem no GitHub2":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_outputParser","index":0}]]},"Decisão de Imagem":{"main":[[{"node":"Tem imagem?","type":"main","index":0},{"node":"Consolidador","type":"main","index":1}]]},"Tem imagem?":{"main":[[{"node":"Analyze image2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Analyze image2":{"main":[[{"node":"Imagem é boa?","type":"main","index":0}]]},"Imagem é boa?":{"main":[[{"node":"Precisa do Unsplash?2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Consolidador":{"main":[[{"node":"temp_id","type":"main","index":0}]]},"Validação do campo imagem1":{"main":[[{"node":"Backup dados da notícia1","type":"main","index":0}],[{"node":"Analyze image4","type":"main","index":0}]]},"Backup dados da notícia1":{"main":[[{"node":"Buscar HTML da notícia1","type":"main","index":0}]]},"Extrair imagem do HTML1":{"main":[[{"node":"Imagem encontrada?1","type":"main","index":0}]]},"Imagem encontrada?1":{"main":[[{"node":"Analyze image3","type":"main","index":0}],[{"node":"Unificar imagem final","type":"main","index":2}]]},"Analyze image3":{"main":[[{"node":"Imagem é boa?2","type":"main","index":0}]]},"Salvar imagem gerada":{"main":[[{"node":"Unificar imagem final","type":"main","index":0}]]},"Analyze image4":{"main":[[{"node":"Imagem é boa?1","type":"main","index":0}]]},"Salvar imagem gerada6":{"main":[[{"node":"Unificar imagem final","type":"main","index":3}]]},"Imagem é boa?1":{"main":[[{"node":"Salvar imagem gerada6","type":"main","index":0}],[{"node":"Unificar imagem final","type":"main","index":4}]]},"Precisa do Unsplash?":{"main":[[{"node":"Consolidador1","type":"main","index":1}]]},"Imagem é boa?2":{"main":[[{"node":"Salvar imagem gerada","type":"main","index":0}],[{"node":"Unificar imagem final","type":"main","index":1}]]},"Precisa do Unsplash?2":{"main":[[{"node":"Consolidador1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)2":{"main":[[{"node":"Merge7","type":"main","index":0}]]},"Precisa do Unsplash?3":{"main":[[{"node":"(Introdução) Buscar Imagem Unsplash","type":"main","index":0}],[{"node":"Merge7","type":"main","index":1}]]},"(Introdução) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)2","type":"main","index":0}]]},"Consolidador1":{"main":[[{"node":"Consolidador","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Create download_url1","type":"main","index":0}],[{"node":"Salvar imagem no GitHub4","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items2":{"main":[[{"node":"Create download_url3","type":"main","index":0}],[{"node":"Salvar imagem no GitHub2","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"temp_id":{"main":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"main","index":0},{"node":"Merge6","type":"main","index":1}]]},"Merge4":{"main":[[{"node":"Merge6","type":"main","index":0}]]},"Merge5":{"main":[[{"node":"Tem todas as imgs?","type":"main","index":0}]]},"Merge6":{"main":[[{"node":"Merge5","type":"main","index":1}]]},"Merge7":{"main":[[{"node":"Tem img?2","type":"main","index":0}]]},"Loop Over Items3":{"main":[[{"node":"Create download_url4","type":"main","index":0}],[{"node":"Salvar imagem no GitHub3","type":"main","index":0}]]},"Wait3":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Tem img?":{"main":[[{"node":"(Desenvolvimento) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem img?1":{"main":[[{"node":"(Aplicabilidade) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem img?2":{"main":[[{"node":"(Introdução) Criação do HTML da Imagem","type":"main","index":0}]]},"Tem todas as imgs?":{"main":[[{"node":"Criação Id + Link Github1","type":"main","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_tool","index":0}]]},"Filtro Relevância1":{"main":[[{"node":"AI Agent - Estrutura dos Posts1","type":"main","index":0}]]},"OpenRouter Chat Model1":{"ai_languageModel":[[{"node":"AI Agent - Avaliação das notícias","type":"ai_languageModel","index":0}]]},"AI Agent - Avaliação das notícias":{"main":[[{"node":"Estruturação do JSON de saída1","type":"main","index":0}]]},"Estruturação do JSON de saída1":{"main":[[{"node":"Filtro Relevância1","type":"main","index":0}]]},"Impede que tupla undefined passe para o agente":{"main":[[{"node":"AI Agent - Avaliação das notícias","type":"main","index":0}]]},"OpenRouter Chat Model2":{"ai_languageModel":[[{"node":"AI Agent - Estrutura dos Posts1","type":"ai_languageModel","index":0}]]},"Binary > base65":{"main":[[{"node":"Merge4","type":"main","index":1}]]},"AI Agent - Estrutura dos Posts1":{"main":[[{"node":"Estruturação do JSON de saída2","type":"main","index":0}]]},"Estruturação do JSON de saída2":{"main":[[{"node":"Decisão de Imagem","type":"main","index":0}]]},"HTML > Imagem4":{"main":[[{"node":"Baixar imagem4","type":"main","index":0}]]},"Baixar imagem4":{"main":[[{"node":"Cortar imagem 1080x1352","type":"main","index":0}]]},"Salvar imagem no GitHub3":{"main":[[{"node":"Wait3","type":"main","index":0}]]},"Filtro dos dados consolidados1":{"main":[[{"node":"Salvar no Sheets Controle1","type":"main","index":0}]]},"Cortar imagem 1080x1352":{"main":[[{"node":"Binary > base65","type":"main","index":0},{"node":"Loop Over Items3","type":"main","index":0}]]},"Create download_url4":{"main":[[{"node":"Merge4","type":"main","index":0}]]},"Salvar imagem no GitHub4":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Unificar imagem final":{"main":[[{"node":"Impede que tupla undefined passe para o agente","type":"main","index":0}]]},"Padronização do campo imagem1":{"main":[[{"node":"Validação do campo imagem1","type":"main","index":0}]]},"Buscar HTML da notícia1":{"main":[[{"node":"Extrair imagem do HTML1","type":"main","index":0}]]},"Criação Id + Link Github1":{"main":[[{"node":"Filtro dos dados consolidados1","type":"main","index":0},{"node":"Envia base64 para o Drive2","type":"main","index":0},{"node":"Envia base64 para o Drive1","type":"main","index":0},{"node":"Envia base64 para o Drive","type":"main","index":0}]]},"Merge8":{"main":[[{"node":"Merge10","type":"main","index":0}]]},"Merge9":{"main":[[{"node":"Merge10","type":"main","index":1}]]},"Merge10":{"main":[[{"node":"Merge5","type":"main","index":0}]]},"Filtro de data da notícia":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Padronização do campo imagem1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","executionTimeout":-1,"errorWorkflow":"QdC9qh9DPcT2xcoq"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Google Sheets Trigger":{"documentId":"1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0","sheetId":0,"lastRevision":271,"lastRevisionLink":"https://docs.google.com/spreadsheets/export?id=1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0&revision=271&exportFormat=xlsx"},"node:Schedule Trigger1":{"recurrenceRules":[]},"node:Trigger nova noticia no sheets":{"documentId":"1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0","sheetId":0,"lastRevision":271,"lastRevisionLink":"https://docs.google.com/spreadsheets/export?id=1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0&revision=271&exportFormat=xlsx"}},"meta":{"templateCredsSetupCompleted":true},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2025-10-29T19:00:31.004-03:00","Readable date":"October 29th 2025, 7:00:31 pm","Readable time":"7:00:31 pm","Day of week":"Wednesday","Year":"2025","Month":"October","Day of month":"29","Hour":"19","Minute":"00","Second":"31","Timezone":"America/Sao_Paulo (UTC-03:00)"}}]},"versionId":"fe98e918-7a8a-4a88-a703-cb6266cf602e","triggerCount":1,"tags":[]}