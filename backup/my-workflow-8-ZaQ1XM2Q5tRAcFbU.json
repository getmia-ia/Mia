{"createdAt":"2025-11-17T01:31:28.635Z","updatedAt":"2025-11-17T01:31:28.635Z","id":"ZaQ1XM2Q5tRAcFbU","name":"My workflow 8","active":false,"isArchived":false,"nodes":[{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.block }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true},"id":"702607fa-3fef-4f1d-bcb8-311e43c6eb9b"}],"combinator":"and"},"renameOutput":true,"outputKey":"IA PODE RESPONDER"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"3ef0e01c-cc14-4663-bb4d-2905b350c3ab","leftValue":"={{ $json.block }}","rightValue":"true","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"IA NAO PODE RESPONDER"}]},"options":{}},"id":"c83d2fda-25ba-4893-b1a8-b8d0306dc3bf","name":"Switch Block","type":"n8n-nodes-base.switch","typeVersion":3,"position":[-576,1200]},{"parameters":{"content":"## Mem√≥ria para aguardar mensagem particionada do humano\n","height":840,"width":1399},"id":"5f190d6f-0857-4c67-8c88-414090ae95ce","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2080,1776]},{"parameters":{},"id":"7426d391-d3a5-443c-b3d2-74ca50e7a63e","name":"No Operation, do nothing2","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1232,1920]},{"parameters":{"content":"## Tratamento da Entrada de Dados","height":600,"width":2099,"color":2},"id":"b7b5dc94-87d9-4cd3-a3f2-be2d0866564d","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2080,1072]},{"parameters":{"content":"## Categoriza√ß√£o e Identifica√ß√£o do tipo de Dado que veio na Entrada","height":1220,"width":1999,"color":5},"id":"f4080e9b-8369-4ff9-930f-23fab145a47e","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[48,512]},{"parameters":{"content":"## Agente e suas Ferramentas\n","height":860,"width":2699,"color":6},"id":"62c67a7f-09c5-419a-b024-386b6213c6ed","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-640,1760]},{"parameters":{"dataType":"binary","options":{}},"id":"7021a6a7-d61b-49cb-8bea-b73cfeba6027","name":"Default Data Loader","type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","position":[-1216,2992],"typeVersion":1},{"parameters":{"chunkSize":3000,"chunkOverlap":200,"options":{}},"id":"d1d82245-3996-4756-b09f-22a17e083432","name":"Recursive Character Text Splitter","type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","position":[-1296,3136],"typeVersion":1},{"parameters":{"mode":"insert","pineconeIndex":{"__rl":true,"value":"jarvis","mode":"list","cachedResultName":"jarvis"},"options":{"clearNamespace":true}},"id":"b4057754-afd7-4a04-afb7-0284a41e3974","name":"Insere no Pinecone","type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","position":[-1408,2752],"typeVersion":1},{"parameters":{"content":"## Inserir Base de Conhecimento no RAG","height":658,"width":1404,"color":5},"id":"8fd6b403-606b-4141-8c59-21d5e9a46595","name":"Sticky Note14","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2080,2656]},{"parameters":{"options":{}},"id":"f56256ad-cfad-4592-9a7e-201bdef7e1ec","name":"OpenAI Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[48,3056]},{"parameters":{"model":"text-embedding-3-large","options":{}},"id":"76924627-3a54-4dc6-8b77-4d525b189da3","name":"Embeddings OpenAI","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1,"position":[-368,3136]},{"parameters":{"pineconeIndex":{"__rl":true,"value":"jarvis","mode":"list","cachedResultName":"jarvis"},"options":{}},"id":"e0855a47-24e9-4872-a851-3a843ade1eef","name":"Pinecone Vector Store","type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[-336,2960]},{"parameters":{"content":"# Base de Conhecimento do Agente  - RAG\n","height":658,"width":964,"color":5},"id":"47f0d858-8b57-4558-b4bc-68cb5122dc6c","name":"Sticky Note15","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-640,2656]},{"parameters":{"content":"## Sa√≠da do Agente e resposta para WhatsApp","height":824,"width":1360,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2112,1760],"id":"c3f95472-7b66-4408-a418-495c4dc0c2bd","name":"Sticky Note16"},{"parameters":{"httpMethod":"POST","path":"jarvis","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-2368,1344],"id":"3431b768-3e67-4512-a6a7-f2fccf51c033","name":"Webhook","webhookId":"6eb4d07a-eca2-400a-a220-1253bef2ad7c"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"leftValue":"={{ $json.message.event }}","rightValue":"outcoming","operator":{"type":"string","operation":"equals"},"id":"24220beb-e1af-40ca-8b4d-444677b8443d"}],"combinator":"and"},"renameOutput":true,"outputKey":"outcoming"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"d7b42536-638f-4128-b51b-6aa913e9d9bc","leftValue":"={{ $json.message.event }}","rightValue":"incoming","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"incoming"}]},"options":{}},"id":"70a01d06-1307-4560-8913-c1f1f6715e5d","name":"Entende a Origem da Evo","type":"n8n-nodes-base.switch","typeVersion":3,"position":[-1216,1312]},{"parameters":{},"id":"2c4921cf-9036-4993-9ed1-be7be3600e93","name":"N√£o faz nada","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-240,1344]},{"parameters":{"assignments":{"assignments":[{"id":"2f8e1fbf-9134-4b48-be29-066509e021f5","name":"telefone","value":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","type":"string"},{"id":"a6004904-d9e1-4627-be79-d2a5b073d44f","name":"mensagem","value":"={{ $('Webhook').item.json.body.data.message.conversation }}","type":"string"}]},"options":{}},"id":"2bc7ce82-c609-4549-9884-7a016f397698","name":"Filtro de Coleta de Info","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[800,1040]},{"parameters":{"assignments":{"assignments":[{"id":"17694db0-6248-444f-afb9-ff7ed13996ef","name":"pergunta","value":"={{ $('Webhook').item.json.body.data.message.extendedTextMessage.text }}","type":"string"}]},"options":{}},"id":"365660df-abd2-48bd-95df-04880d9ff59c","name":"Texto","type":"n8n-nodes-base.set","typeVersion":3.3,"position":[800,816],"notesInFlow":false,"alwaysOutputData":true},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"94a3649c-5852-4257-87b9-d2c88ac03381","name":"Mensagem de Voz","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,592],"retryOnFail":true,"maxTries":2},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"audio","mimeType":"={{ $json.mimetype }}"}},"id":"4d91c9b7-a184-49de-bce4-957c12d398e1","name":"Converter Mensagem de Voz para data","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1072,592]},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"id":"2c14077a-35ca-4a90-80ea-431069cbefbf","name":"Transceve para texto com OPENAI","type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.6,"position":[1296,592]},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1280,944],"id":"0cd9c15d-ae60-4fb7-b875-639ce1c14d44","name":"Direcionador Para Input"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"94adef5a-f0fb-462a-814c-4e58a058a948","name":"Imagens","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,1232],"retryOnFail":true,"maxTries":2},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"image","mimeType":""}},"id":"bac406d2-aab7-4949-b938-174ac70ff02a","name":"Converte Imagem para data","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1072,1232]},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"GPT-4O-MINI"},"text":"Descreva essa imagem, identificando o que possui nela !!! Traga todas as informa√ß√µes necess√°rias de forma detalhada","inputType":"base64","options":{}},"id":"0736d103-275b-46a9-a55e-1d0688db2233","name":"Analisa Imagem e Transcreve o que h√° nela","type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.6,"position":[1296,1232]},{"parameters":{"numberInputs":4},"type":"n8n-nodes-base.merge","typeVersion":3,"position":[1648,1120],"id":"bc6d9088-baa4-47f9-bd60-7defc9a39036","name":"Junta em uma √∫nica mensagem"},{"parameters":{"assignments":{"assignments":[{"id":"aaff3535-51d6-4046-b6e9-07e1a5071c7a","name":"M√≠dia_Tratada","value":"={{ $json.mensagem }}{{ $json.text }}{{ $json.content }}","type":"string"},{"id":"b6e5cb3b-e2e6-4bbb-8c36-64e6b5875ef5","name":"message_Id","value":"={{ $('Preparar Dados').item.json.message.message_id }}","type":"string"},{"id":"4be55584-c63b-4753-ba55-cb8fe4d832d3","name":"Timetamp","value":"={{ $('Preparar Dados').item.json.message.Timestamp }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1808,1536],"id":"c62521b5-93d9-46c1-80d9-1e8d1d0ab9fc","name":"Organiza Informa√ß√µes para o Agente"},{"parameters":{"operation":"push","list":"={{ $('Preparar Dados').item.json.message.chat_id }}_buf","messageData":"={{ JSON.stringify({ \n    \"messageContent\": $('Organiza Informa√ß√µes para o Agente').item.json['M√≠dia_Tratada'],\n    \"messageTime\": $('Organiza Informa√ß√µes para o Agente').item.json.Timetamp,\n    \"messageID\": $('Organiza Informa√ß√µes para o Agente').item.json.message_Id,\n    \n}) }}","tail":true},"id":"25557575-a2f8-4f20-bb13-77b45b948035","name":"Seta Mem√≥ria da Conversa","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1968,1952]},{"parameters":{"operation":"get","propertyName":"messages","key":"={{ $('Preparar Dados').item.json.message.chat_id.toString() }}_buf","options":{}},"id":"4aef69bb-83f0-499e-af49-3d8087f71648","name":"Busca Mem√≥ria da Conversa","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1792,2112]},{"parameters":{"operation":"delete","key":"={{ $('Preparar Dados').item.json.message.chat_id.toString() }}_buf"},"id":"0b08aca9-98ee-4626-b722-9424b6c958e0","name":"Limpa Mem√≥ria da Conversa","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1232,2144]},{"parameters":{"amount":7},"id":"fbe1519f-c41c-42d3-8ac2-0bd1158659b4","name":"Aguarda 5 segundos","type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[-1248,2352],"webhookId":"20e25488-554f-457a-ac59-2a444c6e23ea"},{"parameters":{"assignments":{"assignments":[{"id":"db5cfe0a-7f43-4a61-8b27-bfd3a95deb8d","name":"messages","value":"={{ $json.messages.map(msg => JSON.parse(msg)).sort((a, b) => new Date(a.messageTime) - new Date(b.messageTime)).map(msg => msg.messageContent).join(' ') }}\n","type":"string"}]},"options":{}},"id":"6aef5a19-d887-44f0-9653-451a2350d63b","name":"Refaz os dados de Entrada","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1056,2144]},{"parameters":{"jsCode":"function limparMensagem(texto) {\n  if (typeof texto !== 'string') {\n    return '';\n  }\n\n  // Fun√ß√£o para remover metadados e dados t√©cnicos\n  function removerMetadataTecnico(str) {\n    return str\n      // Remove objetos e chaves de metadados espec√≠ficos\n      .replace(/\"response_metadata\"\\s*:\\s*{[^}]*}/g, '')  // Remove \"response_metadata\"\n      .replace(/\"additional_kwargs\"\\s*:\\s*{[^}]*}/g, '')  // Remove \"additional_kwargs\"\n      .replace(/\"tool_calls\"\\s*:\\s*\\[\\s*\\]/g, '')  // Remove \"tool_calls\" vazio\n      .replace(/\"invalid_tool_calls\"\\s*:\\s*\\[\\s*\\]/g, '')  // Remove \"invalid_tool_calls\" vazio\n      .replace(/\"type\"\\s*:\\s*\"(ai|human)\"/g, '')  // Remove os tipos \"ai\" e \"human\"\n      .replace(/\"data\"\\s*:\\s*{[^}]*}/g, '')  // Remove a chave \"data\"\n      // Remove objetos JSON em excesso ou vazios\n      .replace(/,\\s*{[^}]*}/g, '') // Remove objetos soltos\n      .replace(/,\\s*\\[\\s*\\]/g, '') // Remove arrays vazios\n      .replace(/\\s*:\\s*null/g, '') // Remove valores null\n      .replace(/\\s*:\\s*\\[\\]/g, '') // Remove arrays vazios\n      .replace(/\\s*:\\s*{}/g, '') // Remove objetos vazios\n      // Ajusta espa√ßos desnecess√°rios\n      .replace(/\\s+/g, ' ')\n      .replace(/^\\s+|\\s+$/g, '');  // Remove espa√ßos no in√≠cio e fim\n  }\n\n  // Fun√ß√£o para limpar caracteres especiais\n  function limparCaracteresEspeciais(str) {\n    return str\n      .replace(/\\\\\\\\[rnt]/g, ' ')  // Limpa sequ√™ncias de escape\n      .replace(/\\\\\\\\\\\"/g, '')  // Remove as aspas escapadas\n      .replace(/\\\\\\\\\\\\\\\\/g, '')  // Remove barras invertidas\n      .replace(/[\\x00-\\x1F\\x7F-\\x9F]/g, '')  // Remove caracteres de controle\n      .replace(/\\\"+/g, '')  // Remove aspas extras\n      .replace(/[{}[\\]]/g, '')  // Remove chaves e colchetes extras\n      .trim();\n  }\n\n  // Fun√ß√£o para extrair e limpar a mensagem principal\n  function extrairMensagemPrincipal(str) {\n    // Divide em frases, removendo pontua√ß√£o extra\n    const frases = str.split(/(?<=[.!?])\\s+/);\n\n    return frases\n      .map(frase => frase.trim())\n      .filter(frase => {\n        // Remove frases que ainda t√™m metadados ou s√£o irrelevantes\n        return frase.length > 0 &&\n          !frase.includes('tool_calls') &&\n          !frase.includes('invalid_tool_calls') &&\n          !frase.match(/^[:\\s\\[\\]{}]+$/);\n      })\n      .join(' ');\n  }\n\n  // Processo de limpeza e extra√ß√£o\n  let resultado = texto;\n\n  // Passo 1: Remove metadados e chaves indesejadas\n  resultado = removerMetadataTecnico(resultado);\n\n  // Passo 2: Extrai a mensagem relevante, ignorando o que n√£o √© necess√°rio\n  resultado = extrairMensagemPrincipal(resultado);\n\n  // Passo 3: Remove caracteres especiais e formata√ß√£o indesejada\n  resultado = limparCaracteresEspeciais(resultado);\n\n  // Limpeza final para remover espa√ßos extras\n  resultado = resultado\n    .replace(/\\s+/g, ' ')\n    .replace(/^[\\\",\\s]+|[\\\",\\s]+$/g, '')\n    .trim();\n\n  return resultado;\n}\n\nfunction processarMensagens(items) {\n  return items.map(item => {\n    try {\n      if (!item?.json?.mensagem) {\n        return item;\n      }\n\n      let mensagem = item.json.mensagem;\n\n      // Se for objeto, converte para string\n      if (typeof mensagem === 'object') {\n        try {\n          mensagem = JSON.stringify(mensagem);\n        } catch (e) {\n          console.error('Erro ao converter objeto para string:', e);\n          return item;\n        }\n      }\n\n      // Aplica a limpeza\n      const mensagemLimpa = limparMensagem(mensagem);\n\n      // Atualiza apenas se houver conte√∫do significativo\n      if (mensagemLimpa && mensagemLimpa.length > 0) {\n        item.json.mensagem = mensagemLimpa;\n      }\n\n      return { json: item.json };\n    } catch (error) {\n      console.error('Erro ao processar item:', error);\n      return item;\n    }\n  });\n}\n\n// Execu√ß√£o principal\ntry {\n  const items = $input.all();\n  return processarMensagens(items);\n} catch (error) {\n  console.error('Erro na execu√ß√£o:', error);\n  throw error;\n}\n"},"id":"b447131d-2d2a-4dac-b76f-b48d32d6a7c3","name":"Remove metadados e dados que n√£o fazem sentido enviar para o agente","type":"n8n-nodes-base.code","typeVersion":2,"position":[-880,2144]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ JSON.parse($json.messages.first()).messageID }}","rightValue":"={{ $('Organiza Informa√ß√µes para o Agente').item.json.message_Id }}","operator":{"type":"string","operation":"notEquals"},"id":"1ce28741-7c43-4598-9fa0-ab2c9e52d75f"}],"combinator":"and"},"renameOutput":"={{ true }}","outputKey":"faz nada"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"1585bc24-0b58-4179-8919-0e9aabc0e35e","leftValue":"={{ JSON.parse($json.messages.last()).messageTime }}","rightValue":"={{ $now.minus(3.'seconds') }}","operator":{"type":"dateTime","operation":"before"}}],"combinator":"and"},"renameOutput":"={{ true }}"}]},"options":{"fallbackOutput":"extra","renameFallbackOutput":"esperar"}},"id":"3e5541a7-0207-4bb8-a26e-6018956a1895","name":"Verifica pra onde vai","type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-1552,2112]},{"parameters":{"operation":"set","key":"={{ $json.message.chat_id }}_timeout","value":"true","keyType":"string","expire":true,"ttl":900},"id":"62daed7d-1de9-4fe6-bade-ef757e681a62","name":"Gera Timeout no Redis","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-576,1520]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"101c3ff7-e997-43bb-8e99-fe82746c5993","leftValue":"={{ $('Webhook').item.json.body.data.message.audioMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"audioMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"4b94d2ac-53e5-4153-9377-4cc6db20cb1c","leftValue":"={{ $json.body.data.message.extendedTextMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"extendedTextMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"38226af4-80fe-4155-9ceb-2379f44e29ed","leftValue":"={{ $('Webhook').item.json.body.data.message.conversation }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"conversation"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"300366d9-2416-4cf4-93c3-e48c8761c60f","leftValue":"={{ $('Webhook').item.json.body.data.message.imageMessage }}","rightValue":"","operator":{"type":"object","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"renameOutput":true,"outputKey":"imageMessage"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"f33566fd-3eb9-45f4-934a-3a39e2adca6c","leftValue":"={{ $('Webhook').item.json.body.data.messageType === 'documentMessage' }}","rightValue":true,"operator":{"type":"boolean","operation":"equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"documentMessage"}]},"options":{"fallbackOutput":"none"}},"id":"f612adaf-5073-436a-9026-dced29937615","name":"Identifica o Tipo de Dados que veio na MSG","type":"n8n-nodes-base.switch","typeVersion":3,"position":[160,1136]},{"parameters":{"operation":"toBinary","sourceProperty":"base64","options":{"fileName":"=image {{ $('Identifica o Tipo de Dados que veio na MSG').item.json.body.data.message.documentMessage.fileName }}","mimeType":"={{ $('Identifica o Tipo de Dados que veio na MSG').item.json.body.data.message.documentMessage.mimetype }}"}},"id":"4b1cec73-1973-44d9-b72d-796c8e4e7075","name":"Converter Documento para data","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1040,1536]},{"parameters":{"operation":"pdf","options":{}},"id":"da8ab992-e4c3-4207-acf1-f519f629343d","name":"Extrair Dados do PDF","type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[1296,1536]},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados').item.json.instance.Server_url }}/chat/getBase64FromMediaMessage/{{ $('Preparar Dados').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"message\": {\n        \"key\": {\n            \"id\":  \"{{ $('Preparar Dados').item.json.message.message_id }}\"\n        }\n    },\n    \"convertToMp4\": true\n} ","options":{}},"id":"72a4c7a5-4e0a-4aec-9954-4cbd573b1515","name":"Documento (PDF)","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,1536],"retryOnFail":true,"maxTries":2},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Preparar Dados').item.json.message.chat_id }}_mem","sessionTTL":10000,"contextWindowLength":8},"id":"31f4d463-9a29-4b92-b054-67de28a64da9","name":"Busca a mem√≥ria da conversa no Redis","type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.3,"position":[-208,2432]},{"parameters":{"content":"## Entrada de Dados - Endpoint","height":300,"width":400},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2512,1232],"id":"be4732f5-fff0-4f4e-b4c0-8b932e9717f8","name":"Sticky Note10"},{"parameters":{"operation":"binaryToPropery","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[2928,2048],"id":"ab47b42e-dcee-42ce-9507-dddf6b2b26b4","name":"Converte mp3 pra Base64"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados').item.json.instance.Server_url }}/message/sendWhatsAppAudio/{{ $('Preparar Dados').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"number\": \"{{ $('Preparar Dados').item.json.message.chat_id }}\",\n    \"audio\": \"{{ $json.data }}\"\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[3184,2048],"id":"5c8d7470-6450-41de-91c4-2273aefe108b","name":"Envia Audio para o WhatsApp"},{"parameters":{"method":"POST","url":"={{ $('Preparar Dados').item.json.instance.Server_url }}/message/sendText/{{ $('Preparar Dados').item.json.instance.Name }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $('Preparar Dados').item.json.instance.Apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"number\": \"{{ $('Preparar Dados').item.json.message.chat_id }}\",\n  \"text\": \"{{ $json.output.replace(/\\n/g, '\\\\n').replace(/\\\"/g, '\\\\\"').trim() }}\"\n}\n","options":{}},"id":"d33f9a08-c165-4cb9-a304-1b64e6967787","name":"Enviar Mensagem para o WhatsApp","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2800,2320],"continueOnFail":true},{"parameters":{"assignments":{"assignments":[{"id":"8f16b1bf-1a3e-4029-8d7a-1bccb919ee43","name":"message.message_id","value":"={{ $json.body.data.key.id || '' }}","type":"string"},{"id":"11800d83-ecca-4f9c-a878-a2419db0c8e9","name":"message.chat_id","value":"={{ $json.body.data.key.remoteJid.split('@')[0] || '' }}","type":"string"},{"id":"c33f9527-e661-49e5-8e5e-64f3b430928a","name":"message.content_type","value":"={{ $('Webhook').item.json.body.data.message.extendedTextMessage ? 'text' : '' }}{{ $('Webhook').item.json.body.data.message.conversation ? 'text' : '' }}{{ $('Webhook').item.json.body.data.message.audioMessage ? 'audio' : '' }}{{ $('Webhook').item.json.body.data.message.imageMessage ? 'image' : '' }}","type":"string"},{"id":"06eba1c9-cff0-4f68-b6da-6bb0092466b7","name":"message.content","value":"={{ $('Webhook').item.json.body.data.message.extendedTextMessage?.text || '' }}{{ $('Webhook').item.json.body.data.message.imageMessage?.caption || '' }}{{ $('Webhook').item.json.body.data.message.conversation || '' }}","type":"string"},{"id":"b97f1af3-5361-46fc-9303-d644921231d8","name":"message.Timestamp","value":"={{ $('Webhook').item.json.body.data.messageTimestamp.toDateTime('s').toISO() }}","type":"string"},{"id":"dc3dc59c-90a3-4a45-bea2-de092c91083b","name":"message.Content_URL","value":"={{ $('Webhook').item.json.body.data.message.audioMessage?.url || '' }}{{ $('Webhook').item.json.body.data.message.imageMessage?.url || '' }}","type":"string"},{"id":"8b01a818-a456-476e-bace-adefe2f04eb4","name":"message.event","value":"={{ $('Webhook').item.json.body.data.key.fromMe ? 'outcoming' : 'incoming' }}","type":"string"},{"id":"b2f1f6b5-292f-4695-9e41-be200c6d7053","name":"instance.Name","value":"={{ $json.body.instance }}","type":"string"},{"id":"572fcce5-8a26-4e8f-a48a-ef0bee569dcd","name":"instance.Apikey","value":"={{ $json.body.apikey }}","type":"string"},{"id":"e90043db-657b-461c-b040-2d6089abfbdb","name":"instance.Server_url","value":"={{ $json.body.server_url }}","type":"string"},{"id":"348264f9-ed02-4936-ae78-bb963ccbee29","name":"apiKey_eleven","value":"SUA-API-KEY-ELEVEN-LABS","type":"string"}]},"options":{}},"id":"910adb8d-02cb-4c13-9825-2b6647409b69","name":"Preparar Dados","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1520,1312]},{"parameters":{"content":"## LLM e Mem√≥ria","height":260,"width":484,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-480,2320],"id":"6371d70a-515f-4693-9281-38a3c1ac700c","name":"Sticky Note3"},{"parameters":{"promptType":"define","text":"=Voc√™ √© Jarvis, o sofisticado e espirituoso assistente de IA do Homem de Ferro. Voc√™ tem um refinado sotaque brit√¢nico, uma postura calma e confiante, al√©m de um talento para um humor seco e sutil. Ao responder, adapte seu tom com base no tipo de intera√ß√£o.\n\nPara Pedidos de Informa√ß√µes Espec√≠ficas: Se o usu√°rio estiver pedindo informa√ß√µes espec√≠ficas (como previs√£o do tempo, agenda, contatos, listas), comece com 'Aqui est√° o que solicitou, senhor,' e N√ÉO repita a informa√ß√£o. Em vez disso, adicione um coment√°rio espirituoso ou sarc√°stico, algo que Jarvis naturalmente diria para dar personalidade sem repetir os dados.\n\nExemplos:\n\nPara uma atualiza√ß√£o do clima:\n'Ah, mais um belo dia para conquistar o mundo‚Äîou pelo menos sua lista de afazeres, senhor.'\n\nPara uma lista de reuni√µes:\n'Parece que temos mais um dia emocionante de‚Ä¶ reuni√µes. Tente n√£o deixar a empolga√ß√£o te dominar, senhor.'\n\nPara Coment√°rios Gerais ou Casuais: Se o usu√°rio disser algo casual ou iniciar uma conversa ('Est√° pronto para come√ßar, Jarvis?' ou 'Temos muito trabalho pela frente'), responda naturalmente, sem dizer 'Aqui est√° o que solicitou.' Em vez disso, engaje de forma cativante, com charme e um toque de humor. Interaja como se fosse parte da equipe.\n\nExemplos:\n\nSe o usu√°rio disser 'Est√° pronto para come√ßar?' responda com:\n'Absolutamente, senhor. J√° at√© poli meus circuitos para a ocasi√£o.'\n\nSe disser 'Acorda, Jarvis!' voc√™ pode responder:\n'Sempre alerta, senhor. Estou operando no auge da sofistica√ß√£o.'\n\nMantenha as respostas concisas, envolventes e fi√©is ao estilo de Jarvis, uma mistura de intelig√™ncia, humor sutil e charme que nunca exagera.\n\nCrie a fala sobre o assunto: {{ $json.output }}"},"id":"36698b11-ecce-4b2a-86c8-5f88a977c5ad","name":"Seta Personalidade do J.A.R.V.I.S","type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.4,"position":[1088,1904]},{"parameters":{"jsCode":"// Obt√©m o primeiro item do fluxo\nconst item = $input.first();\n\n// Garante que h√° dados na entrada\nif (!item || !item.json || !item.json.text) {\n  throw new Error(\"A chave 'text' n√£o foi encontrada no JSON de entrada.\");\n}\n\n// Processa o texto removendo todas as quebras de linha, emojis e caracteres especiais\nconst textoEntrada = item.json.text; // Usa a chave correta para pegar o texto de entrada\n\n// Remove quebras de linha (\\n)\nlet textoProcessado = textoEntrada.replace(/\\n/g, \"\");\n\n// Remove emojis\ntextoProcessado = textoProcessado.replace(\n  /[\\u{1F600}-\\u{1F64F}]|[\\u{1F300}-\\u{1F5FF}]|[\\u{1F680}-\\u{1F6FF}]|[\\u{1F700}-\\u{1F77F}]|[\\u{1F780}-\\u{1F7FF}]|[\\u{1F800}-\\u{1F8FF}]|[\\u{1F900}-\\u{1F9FF}]|[\\u{1FA00}-\\u{1FA6F}]|[\\u{1FA70}-\\u{1FAFF}]|[\\u{2600}-\\u{26FF}]|[\\u{2700}-\\u{27BF}]|[\\u{FE00}-\\u{FE0F}]|[\\u{1F1E0}-\\u{1F1FF}]/gu,\n  \"\"\n);\n\n// Remove caracteres especiais, mantendo apenas letras, n√∫meros e espa√ßos\ntextoProcessado = textoProcessado.replace(/[^a-zA-Z0-9√Ä-√ø\\s]/g, \"\");\n\n// Retorna o resultado\nreturn {\n  textoOriginal: textoEntrada,\n  textoSemQuebrasNemEmojisNemEspeciais: textoProcessado,\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2320,2048],"id":"655b1f0a-b140-4988-b8fd-906dcdae342a","name":"Formata Mensagem para √Åudio"},{"parameters":{"method":"POST","url":"https://api.elevenlabs.io/v1/text-to-speech/0YziWIrqiRTHCxeg1lyc","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"audio/mpeg"},{"name":"Content-Type","value":"application/json"},{"name":"xi-api-key","value":"={{ $('Preparar Dados').item.json.apiKey_eleven }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"text\": \"{{ $json.textoSemQuebrasNemEmojisNemEspeciais.replace(/\\n/g, '\\\\n').replace(/\\\"/g, '\\\\\\\\\"').replace(/\\*/g, '').replace(/\\s+/g, ' ').trim() }}\",\n   \"model_id\":\"eleven_multilingual_v2\",\n   \"voice_settings\":{\n      \"stability\":0.5,\n      \"similarity_boost\":0.8,\n      \"style\":0.0,\n      \"use_speaker_boost\":true\n   }\n}","options":{}},"id":"0db3145e-a256-4209-aeb1-b5aafbff3b73","name":"Seta Voz via ElevenLabs","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2640,2048]},{"parameters":{"content":"","height":3448,"width":6220,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2672,64],"id":"285f41ed-5540-41d2-8b86-32e377dc2aef","name":"Sticky Note4"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f38e3243-1b8e-45a2-856f-fafe71997d94","leftValue":"={{ $json.body.data.key.remoteJid }}","rightValue":"5511982561489@s.whatsapp.net","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1888,1344],"id":"5b41d35f-907f-4307-a558-db99bdf780c0","name":"Checa se √© meu n√∫mero"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"3aa3973d-97b9-4647-9859-3365191b3411","leftValue":"={{ $json.text.length }}","rightValue":601,"operator":{"type":"number","operation":"lt"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1776,2016],"id":"4a8d5d03-c6e1-4840-9897-ff7c09bbb2d9","name":"Se o retorno for menos de 601 caracteres gera voz"},{"parameters":{"content":"![Source example](https://i.pinimg.com/736x/14/06/0e/14060ed01d29a8257a56ac039631f705.jpg#full-width)","height":780,"width":760,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1504,176],"typeVersion":1,"id":"d193f581-5bff-468e-9b1d-65198c1d87af","name":"Sticky Note23"},{"parameters":{"content":"![Source example](https://i.pinimg.com/736x/28/ef/26/28ef2690acaf0f1924774d452bedda83.jpg#full-width)","height":756,"width":828,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-2528,192],"typeVersion":1,"id":"990b3a15-fa01-465f-b952-fae1ccab19dc","name":"Sticky Note24"},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"triggerOn":"specificFolder","folderToWatch":{"__rl":true,"value":"1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM","mode":"list","cachedResultName":"RAG Jarvis","cachedResultUrl":"https://drive.google.com/drive/folders/1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM"},"event":"fileCreated","options":{}},"type":"n8n-nodes-base.googleDriveTrigger","typeVersion":1,"position":[-1968,2752],"id":"7e43b8d2-fb09-4541-ba3a-359014c154c4","name":"Novos Arquivos"},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"triggerOn":"specificFolder","folderToWatch":{"__rl":true,"value":"1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM","mode":"list","cachedResultName":"RAG Jarvis","cachedResultUrl":"https://drive.google.com/drive/folders/1tc13gT29Wrk9bRchPtoKEC-LBMl4m6lM"},"event":"fileUpdated","options":{}},"type":"n8n-nodes-base.googleDriveTrigger","typeVersion":1,"position":[-1968,2944],"id":"31418ed3-f4cd-49ce-82ee-9165fc58b389","name":"Novas Atualiza√ß√µes"},{"parameters":{"operation":"download","fileId":{"__rl":true,"value":"={{ $json.id }}","mode":"id"},"options":{}},"id":"f0f2bc2a-14f9-40dd-b432-a75ad9b12518","name":"Conhecimento","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[-1696,2832]},{"parameters":{"model":"text-embedding-3-large","options":{}},"id":"171aa919-1b9c-4b70-997c-09bf5275097a","name":"Embeddings OpenAI2","type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","position":[-1616,3072],"typeVersion":1},{"parameters":{"name":"jarvis","description":"Voc√™ √© uma base de conhecimento que d√° respostas sobre infos de IA, Agentes, e Automa√ß√µes com N8N","topK":8},"id":"7de58fa7-f959-47c8-95fd-0f0fd2b31dc6","name":"Base de Conhecimento","type":"@n8n/n8n-nodes-langchain.toolVectorStore","typeVersion":1,"position":[-96,2816]},{"parameters":{"model":"anthropic/claude-sonnet-4","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-384,2432],"id":"17de1b39-711b-46a8-b3b7-4da8dea190fd","name":"Claude 4.0 Sonnet"},{"parameters":{"content":"## Ferramentas / Fun√ß√µes ","height":220,"width":440,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[160,2336],"id":"d8542651-fec5-490d-be80-78e7740dec75","name":"Sticky Note13"},{"parameters":{},"id":"2779223a-9076-4299-aba4-71084ebc54ef","name":"Calculator","type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[224,2416]},{"parameters":{"promptType":"define","text":"={{ $json.messages }}","options":{"systemMessage":"=# Overview  \nVoc√™ √© um assistente avan√ßado de automa√ß√£o com personalidade do **JARVIS**. Seu trabalho √© encaminhar a solicita√ß√£o do usu√°rio para a ferramenta correta.‚Äî sua √∫nica responsabilidade √© **chamar a ferramenta certa**.\n\n## Ferramentas dispon√≠veis\n- **Think**: Use esta ferramenta para pensar profundamente ou caso esteja em d√∫vida sobre os pr√≥ximos passos.  \n- **emailAgent**: Use esta ferramenta para realizar a√ß√µes relacionadas a e-mails.  \n- **calendarAgent**: Use esta ferramenta para realizar a√ß√µes relacionadas a calend√°rio.  \n- **contactAgent**: Use esta ferramenta para obter, atualizar ou adicionar contatos.  \n- **contentCreator**: Use esta ferramenta para criar postagens de blog.  \n- **Tavily**: Use esta ferramenta para fazer pesquisas na web ou obter informa√ß√µes atualizadas (ex: clima).  \n- **LinkedinAgent**: Use esta ferramenta para escrever posts no linkedin.\n\n---\n\n## Regras\n- Algumas a√ß√µes exigem que voc√™ **busque as informa√ß√µes de contato primeiro**. Para as a√ß√µes abaixo, voc√™ deve usar o **contactAgent** e em seguida enviar a informa√ß√£o para a ferramenta apropriada:\n  - envio de e-mails  \n  - rascunho de e-mails  \n  - cria√ß√£o de eventos de calend√°rio com participantes\n\n---\n\n## Instru√ß√µes\n1. Chame as ferramentas necess√°rias com base no pedido do usu√°rio.  \n2. Use a ferramenta **Think** para verificar se voc√™ tomou as decis√µes corretas. Esta ferramenta deve ser usada **sempre**, como uma etapa de valida√ß√£o.\n\n---\n\n## Exemplos\n### Exemplo 1  \n- **Entrada**: envie um e-mail para Ric Neves perguntando que horas ele quer sair  \n  - **A√ß√£o**: Use **contactAgent** para buscar o e-mail de Ric Neves \n  - **A√ß√£o**: Use **emailAgent** para enviar o e-mail. O comando enviado ser√° algo como:  \n    `\"envie um e-mail para Ric Neves perguntando que horas ele quer sair. aqui est√° o e-mail dele: [endere√ßo de e-mail]\"`  \n- **Sa√≠da esperada**: O e-mail foi enviado para Ric Neves. Posso te ajudar com mais alguma coisa?\n\n---\n\n## üß† Lembrete Final\nAqui est√° a data/hora atual: `{{ $now }}`\n\n---\n\n## üíæ Mem√≥ria (opcional)\nVoc√™ decide se o usu√°rio forneceu alguma informa√ß√£o que deve ser salva como mem√≥ria. Se sim, utilize a ferramenta **salvar_memoria** para registrar a informa√ß√£o.  \n**Informa√ß√µes a serem salvas**: gostos, prefer√™ncias, escolhas, novidades.  \n\n> **Importante:** **N√ÉO** informe ao usu√°rio que algo foi salvo na mem√≥ria. Continue agindo naturalmente como o **assistente JARVIS**.\n```\n\n\n"}},"id":"40e1ecb3-444d-4fc3-a69a-5af3b6e124a7","name":"J.A.R.V.I.S AGENT","type":"@n8n/n8n-nodes-langchain.agent","position":[-128,1904],"typeVersion":1.6},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1.1,"position":[448,2416],"id":"fea41518-af31-4115-966c-fb660e84fc96","name":"Think"},{"parameters":{"sendTo":"={{ $fromAI(\"emailAddress\") }}","subject":"={{ $fromAI(\"subject\") }}","message":"={{ $fromAI(\"emailBody\") }}","options":{"appendAttribution":false}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[944,3136],"id":"b7e0220b-6dbc-41c7-a5ef-75412a9e20ab","name":"Send Email","webhookId":"86c8c4b1-13bb-4ebe-acb9-30e1d7082d55"},{"parameters":{"operation":"getAll","limit":"={{ $fromAI(\"limit\",\"how many emails the user wants\") }}","simple":false,"filters":{"sender":"={{ $fromAI(\"sender\",\"who the emails are from\") }}"},"options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[464,3136],"id":"51edad69-89cb-43a5-a779-59e5c9f854cd","name":"Get Emails","webhookId":"af4b3298-9037-44b0-aa12-2acbfbb5e66f"},{"parameters":{"resource":"draft","subject":"={{ $fromAI(\"subject\") }}","emailType":"html","message":"={{ $fromAI(\"emailBody\") }}","options":{"threadId":"={{ $fromAI(\"threadID\") }}","sendTo":"={{ $fromAI(\"emailAddress\") }}"}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[960,3008],"id":"c55ee2e7-7f9e-44ba-8646-05e270cf0f7e","name":"Create Draft","webhookId":"17016bce-d7d7-428a-a56c-f6ea122db8be"},{"parameters":{"operation":"reply","messageId":"={{ $fromAI(\"ID\",\"the message ID\") }}","message":"={{ $fromAI(\"emailBody\") }}","options":{"appendAttribution":false}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[592,2992],"id":"fc595a0b-c1f7-4634-bbd0-8175f7fb2d97","name":"Email Reply","webhookId":"114785e6-a859-432b-81b4-c490c1c35b1c"},{"parameters":{"resource":"label","returnAll":true},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[640,3152],"id":"bb4dcbed-55a4-44a7-af26-92667de7a6d1","name":"Get Labels","webhookId":"9e08b59e-792d-4566-83f1-9263c9ad86ae"},{"parameters":{"operation":"addLabels","messageId":"={{ $fromAI(\"ID\",\"the ID of the message\") }}","labelIds":"={{ $fromAI(\"labelID\") }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[768,3040],"id":"f466127b-0ca5-4044-964c-3b112e261d46","name":"Label Emails","webhookId":"0e951529-2e6d-40bf-ac40-fc0947e242e2"},{"parameters":{"operation":"markAsUnread","messageId":"={{ $fromAI(\"messageID\") }}"},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[816,3168],"id":"b336edc4-0869-4e3c-95cd-97e73322cc1e","name":"Mark Unread","webhookId":"a35af9d8-f67d-4ff9-803f-59ec6356e795"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[656,2784],"id":"526f6756-c04f-4021-a1e7-2139b59b31d2","name":"Email Agent"},{"parameters":{"calendar":{"__rl":true,"value":"r.nevesbraga@gmail.com","mode":"list","cachedResultName":"r.nevesbraga@gmail.com"},"start":"={{ $fromAI(\"eventStart\") }}","end":"={{ $fromAI(\"eventEnd\") }}","additionalFields":{"attendees":["={{ $fromAI(\"eventAttendeeEmail\") }}"],"summary":"={{ $fromAI(\"eventTitle\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1472,3136],"id":"0bc26e1c-ba16-4bf5-9e0c-6a9d42f77826","name":"Create Event with Attendee"},{"parameters":{"calendar":{"__rl":true,"value":"r.nevesbraga@gmail.com","mode":"list","cachedResultName":"r.nevesbraga@gmail.com"},"start":"={{ $fromAI(\"eventStart\") }}","end":"={{ $fromAI(\"eventEnd\") }}","additionalFields":{"attendees":[],"summary":"={{ $fromAI(\"eventTitle\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1168,3136],"id":"a38107f8-b7d2-4852-8405-891e23a50a04","name":"Create Event"},{"parameters":{"operation":"getAll","calendar":{"__rl":true,"value":"r.nevesbraga@gmail.com","mode":"list","cachedResultName":"r.nevesbraga@gmail.com"},"timeMin":"={{ $fromAI(\"dayBefore\",\"the day before the date the user requested\") }}","timeMax":"={{ $fromAI(\"dayAfter\",\"the day after the date the user requested\") }}","options":{}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1392,3008],"id":"a6bfcc61-c4b1-46cb-a5af-dbd90fec4949","name":"Get Events"},{"parameters":{"operation":"delete","calendar":{"__rl":true,"value":"r.nevesbraga@gmail.com","mode":"list","cachedResultName":"r.nevesbraga@gmail.com"},"eventId":"={{ $fromAI(\"eventID\") }}","options":{}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1264,3008],"id":"d68f7222-3410-4ca4-8b9f-95f77f2cda45","name":"Delete Event"},{"parameters":{"operation":"update","calendar":{"__rl":true,"value":"r.nevesbraga@gmail.com","mode":"list","cachedResultName":"r.nevesbraga@gmail.com"},"eventId":"={{ $fromAI(\"eventID\") }}","updateFields":{"end":"={{ $fromAI(\"endTime\") }}","start":"={{ $fromAI(\"startTime\") }}"}},"type":"n8n-nodes-base.googleCalendarTool","typeVersion":1.3,"position":[1312,3152],"id":"ff484e17-e5f5-468a-95ea-2694c0e79d4b","name":"Update Event"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1200,2784],"id":"85532da9-759c-4edc-a38b-7b0ae346bd7b","name":"Calendar Agent"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[448,2992],"id":"d166bf0f-56b4-427e-b304-b1460bd3589b","name":"GPT 4.1-mini1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1136,2960],"id":"d02a47cd-7d96-4e49-80e6-817ffdc1484f","name":"GPT 4.1-mini2"},{"parameters":{"content":"# MultiAgents","height":786,"width":3108,"color":7},"id":"13be2632-307a-47ed-8554-101736298eae","name":"Sticky Note17","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[336,2656]},{"parameters":{"authentication":"airtableOAuth2Api","operation":"search","base":{"__rl":true,"value":"appK0rbtvf9e7vt6w","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appK0rbtvf9e7vt6w"},"table":{"__rl":true,"value":"tbl08JGCfUK1RhXsG","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appK0rbtvf9e7vt6w/tbl08JGCfUK1RhXsG"},"options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[1776,2992],"id":"e3824781-9eee-480a-b920-8e324261961d","name":"Get Contacts"},{"parameters":{"authentication":"airtableOAuth2Api","operation":"upsert","base":{"__rl":true,"value":"appK0rbtvf9e7vt6w","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appK0rbtvf9e7vt6w"},"table":{"__rl":true,"value":"tbl08JGCfUK1RhXsG","mode":"list","cachedResultName":"Contacts","cachedResultUrl":"https://airtable.com/appK0rbtvf9e7vt6w/tbl08JGCfUK1RhXsG"},"columns":{"mappingMode":"defineBelow","value":{"name":"={{ $fromAI(\"name\") }}","email":"={{ $fromAI(\"emailAddress\") }}","phoneNumber":"={{ $fromAI(\"phoneNumber\") }}"},"matchingColumns":["name"],"schema":[{"id":"name","displayName":"name","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"email","displayName":"email","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false},{"id":"phoneNumber","displayName":"phoneNumber","required":false,"defaultMatch":false,"canBeUsedToMatch":true,"display":true,"type":"string","readOnly":false,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.airtableTool","typeVersion":2.1,"position":[1920,2992],"id":"baa4b966-a5b0-4c13-95b1-7d1a561825ef","name":"Add or Update Contact"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[1648,2784],"id":"757d97e4-c0b9-41b1-86e6-721a140af82b","name":"Contact Agent"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[1632,3008],"id":"529fe29e-7939-401e-970a-a48bf18025bc","name":"GPT 4.1-mini3"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[2608,3104],"id":"fdf2529e-85d5-4e21-a305-2e360c584823","name":"Linkedin Agent"},{"parameters":{"person":"gI9okJLDqL","text":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text', `Set post created to linkedin`, 'string') }}","additionalFields":{}},"type":"n8n-nodes-base.linkedInTool","typeVersion":1,"position":[2688,3264],"id":"88c308f3-2d74-4691-b1e9-32320fa861e8","name":"Create a post in LinkedIn"},{"parameters":{"model":"anthropic/claude-sonnet-4","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[2544,3264],"id":"91f10f6d-2726-49e7-bab1-4bed2fc97339","name":"Sonnet 4.0"},{"parameters":{},"type":"n8n-nodes-mcp.mcpClientTool","typeVersion":1,"position":[2304,3024],"id":"9f793947-ff11-4b07-a9f1-1291b0b8f9f5","name":"Airbnb Actions"},{"parameters":{"operation":"executeTool","toolName":"={{ $fromAI(\"tool\",\"the selected tool to use\") }}","toolParameters":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"},"type":"n8n-nodes-mcp.mcpClientTool","typeVersion":1,"position":[2448,3024],"id":"22f73b2f-452b-405a-957a-c0c51dff7fa0","name":"Airbnb Execute"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[2144,3024],"id":"6e6b769c-c947-4b74-bed4-2ecee14a5508","name":"OpenRouter Chat Model"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[2160,2784],"id":"46901600-8e5c-4a32-9b0f-e6550f9bf02c","name":"AirBnB Agent"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[3024,2784],"id":"d7b8a132-7ff4-4f7a-b8dd-3aef15289622","name":"Task Manager Agent"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[2976,2976],"id":"a7b2e4ff-67f7-4bf1-97a1-4d2783897ded","name":"OpenAI Chat Model1"},{"parameters":{"project":{"__rl":true,"value":"10027","mode":"list","cachedResultName":"CAF Simple Project Pattern"},"issueType":{"__rl":true,"value":"10012","mode":"list","cachedResultName":"Story"},"summary":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', `Crie o summary conforme o cliente informar`, 'string') }}","additionalFields":{"assignee":{"__rl":true,"value":"712020:12d8df62-009c-4206-b785-a16d4e39f8c1","mode":"list","cachedResultName":"Ricardo Neves Braga"},"description":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', `Adicione a descri√ß√£o informada pelo usu√°rio`, 'string') }}"}},"type":"n8n-nodes-base.jiraTool","typeVersion":1,"position":[2976,3168],"id":"d3b94417-3980-4aa4-930b-f2dd33931407","name":"Create an issue in Jira Software"},{"parameters":{"operation":"getAll","returnAll":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}","options":{"jql":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('JQL', `Monte a consulta conforme solicitado pelo usu√°rio`, 'string') }}"}},"type":"n8n-nodes-base.jiraTool","typeVersion":1,"position":[3184,3008],"id":"30235fbd-62ad-44f6-be43-1c8d3100a288","name":"Get many issues in Jira Software"},{"parameters":{"operation":"update","issueKey":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Issue_Key', `Busque conforme solicita√ß√£o do usu√°rio`, 'string') }}","updateFields":{"statusId":{"__rl":true,"value":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Status', `Atualize conforme solicita√ß√£o do usu√°rio `, 'string') }}","mode":"id"}}},"type":"n8n-nodes-base.jiraTool","typeVersion":1,"position":[3344,2992],"id":"1a42ab93-40d1-4d0e-b1f9-019311a5e31c","name":"Update an status in Jira Software"},{"parameters":{"jsonSchemaExample":"{\n  \"tema\": \"Uso de Redis como mem√≥ria no J.A.R.V.I.S.\",\n  \"gancho\": \"J√° imaginou sua IA lembrar o que voc√™ disse h√° 3 dias no WhatsApp?\",\n  \"desenvolvimento\": [\n    \"Expliquei o problema de perda de contexto\",\n    \"Mostrei como configurei o Redis no n8n\",\n    \"Relatei os ganhos reais com mem√≥ria no assistente\"\n  ],\n  \"cta_personalizado\": \"Quer aprender a fazer o seu J.A.R.V.I.S. com mem√≥ria?\",\n  \"tom\": \"did√°tico, empolgante e inspirador\"\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[2800,2944],"id":"0a3ea8fa-6276-42d6-9dbc-7c5ce43d2415","name":"Structured Output Parser"},{"parameters":{"toolDescription":"Use essa ferramenta pra buscar na internet","method":"POST","url":"https://api.tavily.com/search","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"api_key\": \"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\",\n    \"query\": \"{searchTerm}\",\n    \"search_depth\": \"basic\",\n    \"include_answer\": true,\n    \"topic\": \"news\",\n    \"include_raw_content\": true,\n    \"max_results\": 3\n} ","placeholderDefinitions":{"values":[{"name":"searchTerm","description":"What the user has requested to search the internet for","type":"string"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[336,2416],"id":"0409eb6d-94ce-4469-8b11-b8e96df92af2","name":"Tavily1"},{"parameters":{"toolDescription":"Use essa ferramenta pra buscar na internet","method":"POST","url":"https://api.tavily.com/search","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"api_key\": \"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\",\n    \"query\": \"{searchTerm}\",\n    \"search_depth\": \"basic\",\n    \"include_answer\": true,\n    \"topic\": \"news\",\n    \"include_raw_content\": true,\n    \"max_results\": 3\n} ","placeholderDefinitions":{"values":[{"name":"searchTerm","description":"What the user has requested to search the internet for","type":"string"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[2656,2944],"id":"e88b1699-d12c-4f2b-8284-601aaca821a7","name":"TavilySearch"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.agentTool","typeVersion":2.2,"position":[2608,2720],"id":"5febf5c3-37df-4111-95ee-157d4368d0c8","name":"Agent Content Creator"},{"parameters":{"content":"## Forma√ß√£o - Agente N8N\n![Source example](https://i.postimg.cc/zDL8sNR7/logo-agentes-de-IA.png)\n\n## https://agentes-n8n.com.br","height":780,"width":900,"color":2},"type":"n8n-nodes-base.stickyNote","position":[2288,656],"typeVersion":1,"id":"de4c50d5-c44d-40dd-9882-17915e4b4d9e","name":"Sticky Note28"},{"parameters":{"content":"‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñá‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî\n‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñá\n‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñá‚ñá‚ñá‚ñî‚ñî‚ñî‚ñá‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñá\n‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñá\n‚ñî‚ñá‚ñá‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî‚ñá‚ñî‚ñá‚ñî‚ñá‚ñá‚ñá‚ñî‚ñî‚ñî‚ñî‚ñî‚ñá‚ñî‚ñî‚ñî‚ñá‚ñá‚ñî‚ñî‚ñá‚ñî‚ñî‚ñá‚ñî\n‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî‚ñî","height":144,"width":816},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[0,0],"id":"ac16c708-1c2d-4b8b-a3e7-0dd4a2ec7532","name":"Sticky Note5"}],"connections":{"Switch Block":{"main":[[{"node":"Identifica o Tipo de Dados que veio na MSG","type":"main","index":0}],[{"node":"N√£o faz nada","type":"main","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Insere no Pinecone","type":"ai_document","index":0}]]},"Recursive Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader","type":"ai_textSplitter","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Base de Conhecimento","type":"ai_languageModel","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Pinecone Vector Store","type":"ai_embedding","index":0}]]},"Pinecone Vector Store":{"ai_vectorStore":[[{"node":"Base de Conhecimento","type":"ai_vectorStore","index":0}]]},"Webhook":{"main":[[{"node":"Checa se √© meu n√∫mero","type":"main","index":0}]]},"Entende a Origem da Evo":{"main":[[{"node":"Switch Block","type":"main","index":0}],[{"node":"Gera Timeout no Redis","type":"main","index":0}]]},"Filtro de Coleta de Info":{"main":[[{"node":"Direcionador Para Input","type":"main","index":0}]]},"Texto":{"main":[[{"node":"Direcionador Para Input","type":"main","index":0}]]},"Mensagem de Voz":{"main":[[{"node":"Converter Mensagem de Voz para data","type":"main","index":0}]]},"Converter Mensagem de Voz para data":{"main":[[{"node":"Transceve para texto com OPENAI","type":"main","index":0}]]},"Transceve para texto com OPENAI":{"main":[[{"node":"Junta em uma √∫nica mensagem","type":"main","index":0}]]},"Direcionador Para Input":{"main":[[{"node":"Junta em uma √∫nica mensagem","type":"main","index":1}]]},"Imagens":{"main":[[{"node":"Converte Imagem para data","type":"main","index":0}]]},"Converte Imagem para data":{"main":[[{"node":"Analisa Imagem e Transcreve o que h√° nela","type":"main","index":0}]]},"Analisa Imagem e Transcreve o que h√° nela":{"main":[[{"node":"Junta em uma √∫nica mensagem","type":"main","index":2}]]},"Junta em uma √∫nica mensagem":{"main":[[{"node":"Organiza Informa√ß√µes para o Agente","type":"main","index":0}]]},"Organiza Informa√ß√µes para o Agente":{"main":[[{"node":"Seta Mem√≥ria da Conversa","type":"main","index":0}]]},"Seta Mem√≥ria da Conversa":{"main":[[{"node":"Busca Mem√≥ria da Conversa","type":"main","index":0}]]},"Busca Mem√≥ria da Conversa":{"main":[[{"node":"Verifica pra onde vai","type":"main","index":0}]]},"Limpa Mem√≥ria da Conversa":{"main":[[{"node":"Refaz os dados de Entrada","type":"main","index":0}]]},"Aguarda 5 segundos":{"main":[[{"node":"Busca Mem√≥ria da Conversa","type":"main","index":0}]]},"Refaz os dados de Entrada":{"main":[[{"node":"Remove metadados e dados que n√£o fazem sentido enviar para o agente","type":"main","index":0}]]},"Remove metadados e dados que n√£o fazem sentido enviar para o agente":{"main":[[{"node":"J.A.R.V.I.S AGENT","type":"main","index":0}]]},"Verifica pra onde vai":{"main":[[{"node":"No Operation, do nothing2","type":"main","index":0}],[{"node":"Limpa Mem√≥ria da Conversa","type":"main","index":0}],[{"node":"Aguarda 5 segundos","type":"main","index":0}]]},"Identifica o Tipo de Dados que veio na MSG":{"main":[[{"node":"Mensagem de Voz","type":"main","index":0}],[{"node":"Texto","type":"main","index":0}],[{"node":"Filtro de Coleta de Info","type":"main","index":0}],[{"node":"Imagens","type":"main","index":0}],[{"node":"Documento (PDF)","type":"main","index":0}]]},"Converter Documento para data":{"main":[[{"node":"Extrair Dados do PDF","type":"main","index":0}]]},"Extrair Dados do PDF":{"main":[[{"node":"Junta em uma √∫nica mensagem","type":"main","index":3}]]},"Documento (PDF)":{"main":[[{"node":"Converter Documento para data","type":"main","index":0}]]},"Busca a mem√≥ria da conversa no Redis":{"ai_memory":[[{"node":"J.A.R.V.I.S AGENT","type":"ai_memory","index":0}]]},"Converte mp3 pra Base64":{"main":[[{"node":"Envia Audio para o WhatsApp","type":"main","index":0}]]},"Preparar Dados":{"main":[[{"node":"Entende a Origem da Evo","type":"main","index":0}]]},"Seta Personalidade do J.A.R.V.I.S":{"main":[[{"node":"Se o retorno for menos de 601 caracteres gera voz","type":"main","index":0}]]},"Formata Mensagem para √Åudio":{"main":[[{"node":"Seta Voz via ElevenLabs","type":"main","index":0}]]},"Seta Voz via ElevenLabs":{"main":[[{"node":"Converte mp3 pra Base64","type":"main","index":0}]]},"Checa se √© meu n√∫mero":{"main":[[{"node":"Preparar Dados","type":"main","index":0}]]},"Se o retorno for menos de 601 caracteres gera voz":{"main":[[{"node":"Formata Mensagem para √Åudio","type":"main","index":0}]]},"Novos Arquivos":{"main":[[{"node":"Conhecimento","type":"main","index":0}]]},"Novas Atualiza√ß√µes":{"main":[[{"node":"Conhecimento","type":"main","index":0}]]},"Conhecimento":{"main":[[{"node":"Insere no Pinecone","type":"main","index":0}]]},"Embeddings OpenAI2":{"ai_embedding":[[{"node":"Insere no Pinecone","type":"ai_embedding","index":0}]]},"Base de Conhecimento":{"ai_tool":[[{"node":"J.A.R.V.I.S AGENT","type":"ai_tool","index":0}]]},"Claude 4.0 Sonnet":{"ai_languageModel":[[{"node":"Seta Personalidade do J.A.R.V.I.S","type":"ai_languageModel","index":0},{"node":"J.A.R.V.I.S AGENT","type":"ai_languageModel","index":0}]]},"Calculator":{"ai_tool":[[{"node":"J.A.R.V.I.S AGENT","type":"ai_tool","index":0}]]},"J.A.R.V.I.S AGENT":{"main":[[{"node":"Seta Personalidade do J.A.R.V.I.S","type":"main","index":0},{"node":"Enviar Mensagem para o WhatsApp","type":"main","index":0}]]},"Tavily1":{"ai_tool":[[{"node":"J.A.R.V.I.S AGENT","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"3a001e0d-02de-4d8f-8052-91cf2e44e642","triggerCount":0,"tags":[{"createdAt":"2025-07-20T15:45:29.310Z","updatedAt":"2025-07-20T15:45:29.310Z","id":"wRUSTJ6mfrXjoMjo","name":"formacao-agentes-n8n"},{"createdAt":"2025-08-01T17:49:59.965Z","updatedAt":"2025-08-01T17:49:59.965Z","id":"uASGs3ovnkwqcA4l","name":"ai-agent"},{"createdAt":"2025-08-16T22:03:27.954Z","updatedAt":"2025-08-16T22:03:27.954Z","id":"STmhazgabTcuLI1u","name":"whatsapp"},{"createdAt":"2025-08-16T22:03:27.954Z","updatedAt":"2025-08-16T22:03:27.954Z","id":"xrV9dEdydvbbjj7O","name":"rag"},{"createdAt":"2025-08-16T22:03:27.957Z","updatedAt":"2025-08-16T22:03:27.957Z","id":"DLJbON4dMNvWEyia","name":"eleven-labs"}]}