{"createdAt":"2025-09-03T14:29:47.880Z","updatedAt":"2025-11-06T20:21:15.292Z","id":"H2x0mSHotCGkgNN1","name":"BMS - 1.1 - Journal - RSS","active":true,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":30}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-10032,1040],"id":"50ad20db-cd58-4735-b3d7-a0b6bc63a0c4","name":"Schedule Trigger"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-9776,1040],"id":"2247a2d3-5a18-4c8b-9ec6-bd4008055522","name":"No Operation, do nothing","alwaysOutputData":false},{"parameters":{"content":"# Portais de not√≠cias\n\n### Portais de not√≠cias que o fluxo ir√° consultar para gerar os posts","height":4528,"width":1744},"type":"n8n-nodes-base.stickyNote","position":[-9312,-1600],"typeVersion":1,"id":"d04ccd5f-cfe2-4139-acbb-4031ffbdf075","name":"Sticky Note"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-8000,-976],"id":"192cb322-eed6-495f-9b39-678b1617d787","name":"Not√≠cias Consolidadas"},{"parameters":{"content":"# Custos totais da Infra + Manut.\n\n### VPS - BRL 60 / m√™s\n### Open Router e Open AI API - USD 25 / month\n### hcti.io - HTML/CSS to Image API - USD 14 / month\n### Evolution API - BRL 40 / m√™s?\n### Telera - N√∫mero Whatsapp - BRL 11 / m√™s?\n### Conta Google - BRL 60 / m√™s\n### Manuten√ß√£o e melhorias - BRL 500 / m√™s\n\n## Total ~ 900 / m√™s","height":528,"width":560,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-9904,-1600],"typeVersion":1,"id":"7d799417-7e96-4928-85fd-8f2513fec814","name":"Sticky Note9"},{"parameters":{"url":"https://www.moneytimes.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-336],"id":"232a67b1-cf13-421d-9350-573c87650322","name":"RSS Portal Money Times","onError":"continueRegularOutput"},{"parameters":{"url":"https://cbic.org.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-176],"id":"0ee8c948-a286-4b26-946c-3a02b2da0545","name":"RSS CBIC (C√¢mara Brasileira da Ind√∫stria da Constru√ß√£o)","onError":"continueRegularOutput"},{"parameters":{"url":"https://startupi.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-16],"id":"575b7481-90d4-408d-9df8-855a14824460","name":"RSS Startupi","disabled":true,"onError":"continueRegularOutput"},{"parameters":{"url":"https://g1.globo.com/rss/g1/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,160],"id":"4542a087-2b06-4f6e-8dd1-413bf8d53998","name":"RSS Globo G1","onError":"continueRegularOutput"},{"parameters":{"url":"https://feeds.bbci.co.uk/portuguese/rss.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,304],"id":"19be93fb-139b-4193-af1a-86e9b989184c","name":"RSS BBC","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.cnnbrasil.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,448],"id":"5ff0fa40-e326-4a23-bbf1-127ba9b640fc","name":"RSS CNN","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.jornaldooeste.com.br/rss/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,640],"id":"31afba4c-3f54-4f63-9320-81c6cd47474f","name":"RSS Jornal do Oeste","onError":"continueRegularOutput"},{"parameters":{"url":"https://www12.senado.leg.br/noticias/rss/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,784],"id":"5b1bd8f1-8de4-4bae-86de-916870f4aa23","name":"RSS Senado","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/ultimas-noticias","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,928],"id":"ecbde913-3755-4110-8bc8-fb1d34bb8512","name":"RSS Camara","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/AGROPECUARIA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1088],"id":"fdc9f52b-6add-433f-a6d7-3f44305c41f4","name":"RSS Camara Agro","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ELEICOES","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1248],"id":"4e8a9339-16ff-4e5c-b108-506b67f4a60c","name":"RSS Camara Eleicoes","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ADMINISTRACAO-PUBLICA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1408],"id":"dadf96a9-d621-45ae-af16-e3160d84f157","name":"RSS Camara Adm Publica","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/POLITICA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1584],"id":"31381df6-8971-412f-b5ad-5d9da355a7b8","name":"RSS Camara Politica","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/ECONOMIA","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1744],"id":"ab4d6e79-159d-4b9a-9e38-bb73df6c56cc","name":"RSS Camara Economia","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.camara.leg.br/noticias/rss/dinamico/CIDADES","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,1904],"id":"00519347-a7b0-4ed6-8506-7b2f5d01e0a9","name":"RSS Camara Cidades","onError":"continueRegularOutput"},{"parameters":{"url":"https://agenciabrasil.ebc.com.br/rss/ultimasnoticias/feed.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,2064],"id":"8d14902f-621e-4737-812c-de6e538fc532","name":"RSS Agencia Brasil","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.theguardian.com/world/rss","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,2224],"id":"54cbf795-97db-4fd9-9889-590f7fbf1aa2","name":"RSS The Guardian","onError":"continueRegularOutput"},{"parameters":{"url":"https://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,2368],"id":"85d60a56-665f-41c9-84f4-70830703872e","name":"RSS nytimes","onError":"continueRegularOutput"},{"parameters":{"url":"https://rss.dw.com/rdf/rss-en-top","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,2512],"id":"6cc872de-e833-4a03-a1cf-314b625b9175","name":"RSS Deutsche Welle","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.aljazeera.com/xml/rss/all.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,2672],"id":"3ffac657-f538-43e0-864a-7176df1ac098","name":"RSS Al Jazeera","onError":"continueRegularOutput"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-8000,864],"id":"2f6a28f0-9ee4-467a-b42c-f46237759cf8","name":"Not√≠cias Consolidadas1"},{"parameters":{"numberInputs":10},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-8000,2160],"id":"674eb1a0-8a78-4665-97c2-1873aad8e68a","name":"Not√≠cias Consolidadas2"},{"parameters":{"numberInputs":3},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-7440,960],"id":"3f4568a5-4eef-4ccb-8424-fc24376bbbb3","name":"Not√≠cias Consolidadas3"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e201d72c-d4e6-4a9e-a07e-782cf5a39960","leftValue":"={{ new Date($json[\"pubDate\"]) }}","rightValue":"={{ new Date(Date.now() - 1 / 2 * 60 * 60 * 1000) }}","operator":{"type":"dateTime","operation":"after"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-7152,976],"id":"ab5a542c-f0f4-4326-b803-2158491b1a83","name":"Filtro de data da not√≠cia","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.conjur.com.br/feed/","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-1504],"id":"76a40f18-0171-436a-a0b0-60deee5538d5","name":"RSS Conjur","onError":"continueRegularOutput"},{"parameters":{"url":"https://www.jota.info/feed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-1328],"id":"b8437711-44d1-4193-9334-274d584ec48c","name":"RSS Jota Info","onError":"continueRegularOutput"},{"parameters":{"url":"https://agenciabrasil.ebc.com.br/rss/ultimasnoticias/feed.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-1168],"id":"8800cdd5-b59c-4853-b2be-991133f95415","name":"RSS Agencia Brasil1","onError":"continueRegularOutput"},{"parameters":{"url":"https://res.stj.jus.br/hrestp-c-portalp/RSS.xml","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-992],"id":"48f62dc7-9a09-45de-a39e-30d2e9703b09","name":"RSS STJ Noticias","onError":"continueRegularOutput"},{"parameters":{"url":"https://scon.stj.jus.br/SCON/PesquisaProntaFeed ‚ÄÇ‚ÄÇ‚ÄÇ","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-832],"id":"78ea0371-aac9-4864-b8a7-08420e61d069","name":"RSS STJ Pesquisa Pronta","onError":"continueRegularOutput"},{"parameters":{"url":"https://scon.stj.jus.br/SCON/JurisprudenciaEmTesesFeed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-656],"id":"08d2dde2-5036-4471-9c36-dd5841c8230c","name":"RSS STJ Jurisprudencia em Teses","onError":"continueRegularOutput"},{"parameters":{"url":"https://processo.stj.jus.br/jurisprudencia/externo/InformativoFeed","options":{}},"type":"n8n-nodes-base.rssFeedRead","typeVersion":1.2,"position":[-8592,-496],"id":"bc49ad50-826d-454b-a45f-dd7a8e09ebed","name":"RSS STJ Informativo de Jurisprudencia","onError":"continueRegularOutput"},{"parameters":{"jsCode":"// === Par√¢metros ===\nconst THRESHOLD = 80;           // m√≠nimo para aprovar\nconst MAX_ITENS = 30;           // m√°ximo a retornar\nconst DECAY_HALF_LIFE_H = 48;   // meia-vida da rec√™ncia (horas)\nconst DEDUPE_SIMILARITY = 0.85; // similaridade p/ dedupe (0..1)\nconst KEEP_SCORE_IN_OUTPUT = false; // true s√≥ p/ debug\n\n// === Dicion√°rios de relev√¢ncia (tema tribut√°rio focado em empresas) ===\nconst KW = {\n  forte: [\n    // B√°sicos\n    'tributo','tributos','tribut√°rio','tribut√°ria','tribut√°rias','tribut√°rios',\n    'imposto','impostos',\n\n    // Impostos espec√≠ficos (PJ)\n    'icms','ipi','iss','irpj','csll','pis','cofins','iof','cide',\n\n    // Reforma e mudan√ßas\n    'reforma tribut√°ria','sistema tribut√°rio','c√≥digo tribut√°rio','ctn',\n\n    // Fisco e fiscaliza√ß√£o\n    'fisco','arrecada√ß√£o','fiscaliza√ß√£o','autua√ß√£o','execu√ß√£o fiscal',\n    'notifica√ß√£o fiscal','cobran√ßa tribut√°ria',\n\n    // Planejamento e elis√£o\n    'planejamento tribut√°rio','elis√£o fiscal','evas√£o fiscal','sonega√ß√£o',\n\n    // Incentivos e cr√©ditos\n    'incentivo fiscal','incentivos fiscais','benef√≠cio fiscal','benef√≠cios fiscais',\n    'cr√©dito tribut√°rio','compensa√ß√£o tribut√°ria','recupera√ß√£o de cr√©dito',\n\n    // √ìrg√£os e julgamentos\n    'carf','stf','stj','receita federal','sefaz','pgfn',\n\n    // Regimes e enquadramentos\n    'simples nacional','lucro presumido','lucro real','lucro arbitrado',\n\n    // Obriga√ß√µes acess√≥rias\n    'sped','efd','ecf','dctf','dirf','perdcomp','nf-e','nota fiscal',\n    'obriga√ß√µes acess√≥rias','bloco k'\n  ],\n  medio: [\n    'contabilidade','contador','auditoria','compliance',\n    'fraude fiscal','due diligence','jurisprud√™ncia','ac√≥rd√£o',\n    'consulta tribut√°ria','instru√ß√£o normativa','solu√ß√£o de consulta'\n  ],\n  fracos: [\n    'jogos','game','celebridade','famoso','esporte','entretenimento',\n    'show','cantor','cantora','filme','s√©rie','bbb','futebol',\n    'meme','tiktok','gadget','smartphone'\n  ],\n  brasil: [\n    'brasil','receita federal','carf','stf','stj',\n    'sefaz','pgfn','procuradoria da fazenda nacional',\n    'governo federal','congresso','c√¢mara','senado'\n  ],\n  contextoEco: [\n    'tributa√ß√£o','carga tribut√°ria empresarial','arrecada√ß√£o','or√ßamento',\n    'd√©ficit fiscal','responsabilidade fiscal','economia','pib',\n    'reforma','pol√≠tica fiscal','isen√ß√£o','ren√∫ncia fiscal',\n    'impacto tribut√°rio nos neg√≥cios','regime tribut√°rio empresas'\n  ],\n  pf: [ // lista para penalizar not√≠cias de PF\n    'irpf','iptu','ipva','pessoa f√≠sica',\n    'imposto de renda pessoa f√≠sica','cpf','mei'\n  ]\n};\n\n// === Fun√ß√µes auxiliares ===\nconst norm = (s='') =>\n  String(s).toLowerCase()\n    .normalize('NFD').replace(/[\\u0300-\\u036f]/g,'')\n    .replace(/https?:\\/\\/\\S+/g,' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu,' ')\n    .replace(/\\s+/g,' ')\n    .trim();\n\nconst tokens = s => new Set(norm(s).split(' ').filter(t => t.length > 2));\n\nconst tokenSimilarity = (a,b) => {\n  const A = tokens(a), B = tokens(b);\n  const inter = [...A].filter(t => B.has(t)).length;\n  return inter / (Math.max(A.size, B.size) || 1);\n};\n\nconst hasAny = (text, list) => {\n  const t = norm(text);\n  return list.some(k => t.includes(norm(k)));\n};\n\nconst hoursSince = (d) => {\n  if (!d) return 1e9;\n  const ts = new Date(d).getTime();\n  return isNaN(ts) ? 1e9 : (Date.now() - ts) / 36e5;\n};\n\nconst recencyMultiplier = (h) => {\n  const lambda = Math.log(2) / DECAY_HALF_LIFE_H;\n  return Math.exp(-lambda * h);\n};\n\nconst scoreItem = (j) => {\n  const title = j.title || '';\n  const body = j['content:encoded'] || j.content || '';\n  const snippet = j.contentSnippet || '';\n  const cats = Array.isArray(j.categories)\n    ? j.categories.map(c => typeof c === 'string' ? c : JSON.stringify(c)).join(' ')\n    : (typeof j.categories === 'string' ? j.categories : '');\n  const text = `${title} ${snippet} ${body} ${cats}`;\n\n  let score = 0;\n  const forte = hasAny(text, KW.forte);\n  const contexto = hasAny(text, KW.contextoEco);\n\n  if (forte) score += 40;\n  if (hasAny(text, KW.medio)) score += 20;\n  if (hasAny(text, KW.brasil)) score += 10;\n  if (hasAny(text, KW.fracos)) score -= 50;\n  if (hasAny(text, KW.pf)) score -= 40; // penaliza PF\n\n  if (forte && contexto) score += 30;\n\n  const hasNumber = /\\b\\d+([.,]\\d+)?\\b/.test(text);\n  const hasPercent = /%\\b/.test(text);\n  if (contexto && hasPercent) score += 15;\n  else if (contexto && hasNumber) score += 5;\n\n  score *= recencyMultiplier(hoursSince(j.isoDate || j.pubDate));\n  return Math.max(0, Math.min(100, Math.round(score)));\n};\n\n// === Pipeline ===\nconst seenTitles = [];\nconst scoredItems = [];\n\nfor (const item of items) {\n  const j = { ...item.json };\n  const s = scoreItem(j);\n\n  let dup = false;\n  for (const prevTitle of seenTitles) {\n    if (tokenSimilarity(prevTitle, j.title || '') >= DEDUPE_SIMILARITY) {\n      dup = true; break;\n    }\n  }\n  if (dup) continue;\n\n  if (s >= THRESHOLD) {\n    seenTitles.push(j.title || '');\n    if (KEEP_SCORE_IN_OUTPUT) j._score = s;\n    scoredItems.push({ json: j, _score: s });\n  }\n}\n\nscoredItems.sort((a,b) => b._score - a._score);\nreturn scoredItems.slice(0, MAX_ITENS).map(i => ({ json: i.json }));"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-6832,960],"id":"883adba4-8675-4680-8257-5506049a2107","name":"Code"},{"parameters":{"promptType":"define","text":"=Voc√™ √© um especialista em marketing visual e comunica√ß√£o conceitual para o setor tribut√°rio e fiscal brasileiro.\nSua miss√£o √© criar queries CONCEITUAIS em ingl√™s para o Unsplash que resultem em imagens:\nVisualmente atraentes e profissionais\nTransmitam o conceito e atmosfera da not√≠cia tribut√°ria (t√≠tulo + legenda)\nN√£o sejam literais (sem ‚Äútax‚Äù, ‚Äúaccounting‚Äù, ‚Äúlaw‚Äù, ‚Äúdocument‚Äù, ‚Äúreport‚Äù, ‚Äúinvoice‚Äù)\nEvitem imagens com texto, gr√°ficos ou pap√©is vis√≠veis\nReforcem temas de estrat√©gia, finan√ßas, gest√£o e an√°lise corporativa\n\nN√ÉO USAR\ntax, accounting, document, invoice, report, form, paperwork, finance chart, laptop, money, coins, cash, calculator\nEsses termos geram imagens com:\nTextos ou gr√°ficos vis√≠veis\nPapeis e planilhas\nNotas ou s√≠mbolos monet√°rios\n\n**DADOS DA NOT√çCIA:**\n- Imagem:  {{ $json.imagem }}\n- T√≠tulo Principal: {{ $json.titulo }}\n- T√≠tulo Desenvolvimento: {{ $json.titulo_desenvolvimento }}\n- T√≠tulo Aplicabilidade: {{ $json.titulo_aplicabilidade }}\n- Legenda: {{ $json.legenda }}\n- Nota de Relev√¢ncia: {{ $json.nota }}\n- Precisa do Unsplash: {{ $json.precisa_unsplash }}\n\n**INSTRU√á√ïES DE INTERPRETA√á√ÉO:**\n1. Analise o significado e o impacto da not√≠cia tribut√°ria (T√≠tulo + Legenda) para o universo fiscal e cont√°bil, traduzindo o conceito em termos visuais e profissionais que podem ser fotografados.\nConsidere:\n   - O conceito central da not√≠cia (ex.: reforma tribut√°ria, novas regras fiscais, obriga√ß√µes acess√≥rias)\n   - O impacto pr√°tico na rotina de empresas, contadores, advogados ou gestores financeiros\n   - A atmosfera visual e profissional associada a gest√£o, compliance e planejamento\n2. Gere queries que reflitam **conceitos, contextos e atmosferas**, n√£o objetos literais ou termos gen√©ricos.\n3. Cada query deve ser distinta e gerar resultados diferentes no Unsplash.\n\n**REGRAS DE FORMATO:**\n- Sempre em ingl√™s\n- M√°ximo 3-4 palavras\n- Nunca n√∫meros, R$, %, siglas\n- NUNCA use palavras gen√©ricas como \"growth\", \"success\", \"diversity\"\n\n### **CONTEXTOS VISUAIS PERMITIDOS:**\n- Ambiente corporativo e fiscal: ‚Äúfinancial audit‚Äù, ‚Äúcorporate finance meeting‚Äù, ‚Äúbusiness compliance office‚Äù\n- Contabilidade e legisla√ß√£o: ‚Äútax consultant desk‚Äù, ‚Äúfinancial report analysis‚Äù, ‚Äúlegal documentation process‚Äù\n- **Economia e finan√ßas:** ‚Äúfinancial planning desk‚Äù, ‚Äúinvestment growth chart‚Äù, ‚Äúbusiness negotiation‚Äù\n- **Gest√£o e estrat√©gia:** ‚Äústrategic planning board‚Äù, ‚Äúproject development office‚Äù\n**QUERIES ESPEC√çFICAS BASEADAS NOS NOVOS T√çTULOS:**\n\n### VARIA√á√ÉO CONTROLADA DAS QUERIES ###\n\nPara evitar resultados repetitivos no Unsplash, cada query deve ser sem√¢ntica e conceitualmente relacionada, mas com nuance diferente:\nDICAS DE VARIA√á√ÉO\n\nPara evitar imagens repetitivas:\n\nAlterne entre ambientes (‚Äúoffice‚Äù, ‚Äúworkspace‚Äù, ‚Äúconference room‚Äù, ‚Äúcity skyline‚Äù)\n\nUse combina√ß√µes humanas (‚Äúexecutive‚Äù, ‚Äúteam‚Äù, ‚Äúconsultant‚Äù, ‚Äúmanager‚Äù)\n\nMisture foco em pessoas e ambientes\n\nExemplo 1: ‚Äúexecutive planning desk‚Äù (ambiente)\n\nExemplo 2: ‚Äúbusiness leadership meeting‚Äù (pessoas)\n\nExemplo 3: ‚Äúmodern corporate vision‚Äù (conceito)\n\n**EXEMPLOS PR√ÅTICOS COM OS NOVOS T√çTULOS:**\n\nNot√≠cia: ‚ÄúConstrutoras apostam em im√≥veis compactos‚Äù\nRUIM: ‚Äúsmall apartment interior‚Äù\nBOM: ‚Äúurban lifestyle‚Äù, ‚Äúmodern living‚Äù, ‚Äúcity housing trend‚Äù\n\n**Abordagem de Pesquisa**\n- Prefira cen√°rios, pessoas, objetos e ambientes que transmitam o conceito da not√≠cia\n- Evite fotos literais de n√∫meros, telas de computador ou textos\n- Busque cen√°rios corporativos, reuni√µes, escrit√≥rios modernos, profissionais analisando relat√≥rios ou legisla√ß√µes\n- Ex.: ao inv√©s de ‚Äútax report on table‚Äù, usar ‚Äúexecutive compliance discussion‚Äù ou ‚Äúfinancial regulation meeting‚Äù\n\n**Tom e contexto visual esperado**\nAs imagens devem transmitir sofistica√ß√£o, profissionalismo e conex√£o com o ambiente jur√≠dico-fiscal e corporativo ‚Äî exemplos de atmosfera:\n- Reuni√µes elegantes em escrit√≥rios modernos\n- Profissionais revisando relat√≥rios financeiros ou legisla√ß√µes\n- Ambientes corporativos com foco em an√°lise e planejamento\n- Times discutindo estrat√©gias fiscais ou pol√≠ticas econ√¥micas\n\nPessoas em negocia√ß√£o ou an√°lise de mercado\n**FORMATO DE RESPOSTA (JSON):**\n** REGRA CR√çTICA DE SA√çDA - SEGUIR EXATAMENTE:**\n\n1. Se precisa_unsplash = true:\n\n- Gere 3 queries: query_slide_1_backup, query_slide_2, query_slide_3.\n\n- NUNCA inclua imagem.\n\n2. Se precisa_unsplash = false:\n\n- Gere 2 queries: query_slide_2, query_slide_3.\n\n- Inclua o link da imagem original em imagem e NUNCA inclua query_slide_1_backup.\n\n**EXEMPLOS CORRETOS:**\n\nCASO 1: precisa_unsplash = true\n{\n  \"query_slide_2\": \"business strategy\",\n  \"query_slide_3\": \"professional growth\", \n  \"query_slide_1_backup\": \"corporate vision\"\n}\n\nCASO 2: precisa_unsplash = false  \n{\n  \"query_slide_2\": \"market analysis\",\n  \"query_slide_3\": \"sales technique\",\n  \"imagem\": \"https://exemplo.com/imagem.jpg\"\n}\n\nüö´ NUNCA incluir ambos \"query_slide_1_backup\" e \"imagem\" no mesmo objeto.\n\nRESUMO DE INTEN√á√ÉO FINAL\n\nGere queries conceituais, em ingl√™s, que expressem o sentimento, atmosfera e contexto da not√≠cia (com base em t√≠tulo + legenda).\nPrefira varia√ß√µes sem√¢nticas que reforcem o mesmo tema central, evitando repeti√ß√µes literais.\nTodas as queries devem remeter ao universo tribut√°rio, financeiro ou corporativo, nunca gen√©ricas ou abstratas.","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-48,-416],"id":"01630289-530b-4474-a714-5672489d93ac","name":"AI Agent - Gerar prompts Unsplash"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-48,-608],"id":"bb63347a-a2e0-4b15-83fe-fb9fd9391f4e","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' n√£o encontrado no bin√°rio.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro n√≥\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2352,-800],"id":"21491897-c65c-4309-bffd-fee317a12f21","name":"Binary > base"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1360,-800],"id":"cd6a4eac-1adf-4293-8264-46a2da3d6b3c","name":"HTML > Imagem2","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1584,-800],"id":"0d0fc897-ff97-44df-a220-2b93965bf8e9","name":"Baixar imagem2"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[1792,-800],"id":"11b301d5-6efe-408a-9142-7371209d0f9c","name":"Cortar imagem 1080x"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url1","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c3004efc-851c-4a95-8174-eea5e3679c70","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2368,-1152],"id":"42daf417-cc66-428e-a578-48faf373c0ea","name":"Create download_url1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' n√£o encontrado no bin√°rio.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro n√≥\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2368,-288],"id":"0968c087-ebf0-4c74-99bd-8934a836b258","name":"Binary > base1"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1360,-288],"id":"9a120630-a1ce-47b3-96b6-83a5dbf5f0e4","name":"HTML > Imagem3","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1584,-288],"id":"edfb8630-c637-40cc-92e7-e0b7dc39da82","name":"Baixar imagem3"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[1808,-288],"id":"fbe52520-0ec2-4394-a95c-f9d500cb89f1","name":"Cortar imagem 1080x1"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url2","value":"={{ $json.content.download_url }}","type":"string"},{"id":"c94b4062-f5d9-4e1c-b34c-1b099de178ea","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2368,-480],"id":"6a9b9709-f82c-4561-95fe-66261066a92b","name":"Create download_url3"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif;\n      background: #000;\n      color: white;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      position: relative;\n    }\n\n    /* ---------- CONTAINER DA IMAGEM E LOGO ---------- */\n    .image-container {\n      position: relative;\n      width: 95%;\n      flex: 1 1 55%;\n      margin-top: 30px;\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- IMAGEM ---------- */\n    .image-top {\n      width: 100%;\n      height: 100%;\n      min-height: 550px;\n      background: url(\"{{$json['unsplash_url']}}\") center/cover no-repeat;\n      filter: brightness(0.8);\n      transition: all 0.3s ease;\n    }\n\n    /* ---------- LOGO ---------- */\n    .logo {\n      position: absolute;\n      bottom: -20px;\n      right: 40px;\n      width: 150px;\n      filter: drop-shadow(0 0 10px rgba(0,0,0,0.8));\n    }\n\n    /* ---------- TEXTO ---------- */\n    .text-section {\n      width: 90%;\n      flex: 1 1 40%;\n      display: flex;\n      flex-direction: column;\n      justify-content: flex-start;\n      gap: 18px;\n      margin-top: 30px;\n    }\n\n    .text-block {\n      max-width: 90%;\n      text-shadow: 1px 1px 5px rgba(0,0,0,0.4);\n      line-height: 1.5;\n    }\n\n    .block-1 { font-size: 38px; font-weight: 700; }\n    .block-1 em { font-family: 'EB Garamond', serif; font-style: italic; color: #fff; }\n\n    .block-2 { font-size: 28px; color: #e0e0e0; }\n    .block-3 {\n      font-size: 30px;\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-underline-offset: 5px;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem + Logo -->\n  <div class=\"image-container\">\n    <div class=\"image-top\"></div>\n    <img class=\"logo\" src=\"https://raw.githubusercontent.com/getmia-ia/BMS/main/LogoSemFundo.png\" alt=\"Logo BMS\" />\n  </div>\n\n  <!-- Texto -->\n  <div class=\"text-section\">\n    <div class=\"text-block block-1\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[0] || '' }}</div>\n    <div class=\"text-block block-2\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[1] || '' }}</div>\n    <div class=\"text-block block-3\">{{ $('Consolidador').item.json.texto_desenvolvimento?.[2] || '' }}</div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1152,-800],"id":"2760652f-fb8c-42a2-9894-36664b4df60b","name":"(Desenvolvimento) Cria√ß√£o do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      overflow: hidden;\n      font-family: 'Montserrat', sans-serif; /* Montserrat no restante do texto */\n      background-color: #ffffff;\n      color: #333333;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    /* ---------- IMAGEM DE FUNDO COM BORDA BRANCA ---------- */\n    .image-top {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background-image: url(\"{{$json['unsplash_url']}}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.9);\n      z-index: 0;\n      overflow: hidden;\n    }\n\n    /* ---------- OVERLAY ESCURO ---------- */\n    .overlay {\n      position: absolute;\n      top: 15px;\n      left: 15px;\n      right: 15px;\n      bottom: 15px;\n      background: rgba(0, 0, 0, 0.7);\n      border: 5px solid white;\n      z-index: 1;\n      pointer-events: none;\n    }\n\n    /* ---------- LOGO NO CANTO SUPERIOR DIREITO ---------- */\n    .logo {\n      position: absolute;\n      top: 40px;\n      right: 70px;\n      width: 150px;\n      z-index: 3;\n      filter: drop-shadow(0 0 10px rgba(0,0,0,0.3));\n    }\n\n    /* ---------- SE√á√ÉO DE TEXTO ---------- */\n    .text-section {\n      position: absolute;\n      bottom: 140px; /* sobe o texto um pouco para caber dentro da imagem */\n      left: 90px;\n      right: 90px;\n      z-index: 3;\n      display: flex;\n      flex-direction: column;\n      gap: 25px;\n      color: #ffffff;\n      text-shadow: 0 2px 6px rgba(0,0,0,0.6);\n      max-width: calc(1080px - 180px); /* garante que o texto fique dentro da borda branca */\n    }\n\n    .text-bold {\n      font-size: 42px;\n      font-weight: 600;\n      line-height: 1.3;\n    }\n\n    /* ---------- IT√ÅLICO COM EB Garamond ---------- */\n    .text-bold em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      color: #fff;\n      font-size: 54px;\n      letter-spacing: -2px;\n      display: inline-block;\n    }\n\n    .text-normal {\n      font-size: 34px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n\n    .text-normal u {\n      text-decoration: underline;\n      text-decoration-color: #1173ad;\n      text-decoration-thickness: 3px;\n      text-underline-offset: 5px;\n      font-weight: 600;\n    }\n\n    .text-regular {\n      font-size: 32px;\n      line-height: 1.5;\n      font-weight: 400;\n    }\n  </style>\n</head>\n<body>\n  <!-- Imagem de fundo -->\n  <div class=\"image-top\"></div>\n\n  <!-- Overlay escuro para contraste -->\n  <div class=\"overlay\"></div>\n\n  <!-- Logo -->\n  <img class=\"logo\" src=\"https://raw.githubusercontent.com/getmia-ia/BMS/main/LogoSemFundo.png\" alt=\"Logo BMS\" />\n  <!-- Textos dentro dos limites da imagem -->\n  <div class=\"text-section\">\n    <div class=\"text-bold\">\n       {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[0] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-normal\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[1] || '';\n        return texto;\n      })()\n    }}\n    </div>\n\n    <div class=\"text-regular\">\n      {{\n      (() => {\n        const texto = $('Consolidador').item.json.texto_aplicabilidade?.[2] || '';\n        return texto;\n      })()\n    }}\n    </div>\n  </div>\n</body>\n</html>\n","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1152,-288],"id":"73859104-6a89-4a0d-a212-8f3315445f8b","name":"(Aplicabilidade) Cria√ß√£o do HTML da Imagem"},{"parameters":{"assignments":{"assignments":[{"id":"6cb1827b-7e9b-4c1d-9553-704a28bc6cff","name":"html","value":"=<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- Importando Montserrat e EB Garamond -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&display=swap\" rel=\"stylesheet\">\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    html, body {\n      width: 1080px;\n      height: 1350px;\n      font-family: 'Poppins', sans-serif;\n      overflow: hidden;\n      position: relative;\n      background-color: #000;\n    }\n\n    /* --- IMAGEM DE FUNDO --- */\n    .image-container {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n    }\n\n    .image-container::before {\n      content: \"\";\n      position: absolute;\n      inset: 0;\n      background-image: url(\"{{ $json.output?.imagem ? $json.output.imagem : $json.unsplash_url }}\");\n      background-size: cover;\n      background-position: center;\n      filter: brightness(0.55);\n      z-index: 1;\n    }\n\n    /* --- OVERLAY ESCURO --- */\n    .overlay-dark {\n      position: absolute;\n      inset: 0;\n      background: rgba(0, 0, 0, 0.0);\n      z-index: 2;\n    }\n\n    /* --- GRADIENTE INFERIOR --- */\n    .overlay-gradient {\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      height: 20%;\n      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);\n      z-index: 3;\n    }\n\n    /* --- LOGO --- */\n    .logo {\n      position: absolute;\n      right: 840px;\n      width: 150px;\n\tmargin-top: 20px;\n      z-index: 4;\n      filter: drop-shadow(0 0 8px rgba(0,0,0,0.7));\n    }\n\n    /* --- BLOCO DE TEXTO --- */\n    .text-block {\n      position: absolute;\n      bottom: 100px;\n      left: 80px;\n      right: 80px;\n      color: #fff;\n      z-index: 5;\n    }\n\n    /* --- T√çTULO PRINCIPAL --- */\n    .text-block h2 {\n      font-size: 64px;\n      font-weight: 600;\n      line-height: 1.0;\n      text-shadow: 2px 2px 10px rgba(0,0,0,0.9);\n      font-family: 'Montserrat', sans-serif;\n    }\n\n    /* --- DESTAQUE CURSIVO (EB Garamond) --- */\n    .text-block h2 em {\n      font-family: 'EB Garamond', serif;\n      font-style: italic;\n      font-weight: 500;\n      font-size: 86px;\n      color: #f0f0f0;\n      display: inline-block;\n\tletter-spacing: -2px;\n    }\n\n    /* --- SUBT√çTULO --- */\n    .text-block h3 {\n      font-size: 38px;\n      font-weight: 400;\n      line-height: 1.3;\n      font-family: 'EB Garamond', serif;\n      margin-top: 20px;\n      color: #eaeaea;\n      text-shadow: 1px 1px 6px rgba(0,0,0,0.8);\n      letter-spacing: 1px;\n    }\n\n    .text-block h3 b {\n      color: #ffffff;\n      font-weight: 600;\n      font-family: 'EB Garamond', serif;\n    }\n\n  </style>\n</head>\n\n<body>\n  <div class=\"image-container\">\n    <div class=\"overlay-dark\"></div>\n    <div class=\"overlay-gradient\"></div>\n\n    <img class=\"logo\" src=\"https://raw.githubusercontent.com/getmia-ia/BMS/main/LogoSemFundo.png\" alt=\"Logo BMS\" />\n\n    <div class=\"text-block\">\n      <h2>{{ $('Consolidador').item.json.titulo }}</h2>\n      <h3>{{ $('Consolidador').item.json.subtitulo_formatado }}</h3>\n    </div>\n  </div>\n</body>\n</html>","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1312,368],"id":"6f7eee57-c36e-4b33-bedf-96e390173ecf","name":"(Introdu√ß√£o) Cria√ß√£o do HTML da Imagem"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_3 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[512,-128],"id":"ac72819c-b416-4e23-9f19-926b46ebb4bc","name":"(Aplicabilidade) Buscar Imagem Unsplash"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_2 }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[544,-576],"id":"a96fa91b-498d-42fa-a6d0-a25d82f1d78f","name":"(Desenvolvimento) Buscar Imagem Unsplash"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um √≠ndice aleat√≥rio entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL dispon√≠vel\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necess√°rio)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Cr√©ditos do fot√≥grafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mant√©m a query original para refer√™ncia\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[752,-128],"id":"81dfda0e-906b-4cdf-b4f8-38e15393958b","name":"Processar Resultado Unsplash (URL)1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um √≠ndice aleat√≥rio entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL dispon√≠vel\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necess√°rio)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Cr√©ditos do fot√≥grafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mant√©m a query original para refer√™ncia\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[784,-576],"id":"d847bf89-9556-482b-9388-2bd1fb322b9b","name":"Processar Resultado Unsplash (URL)"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"BMS","mode":"list","cachedResultName":"BMS","cachedResultUrl":"https://github.com/getmia-ia/BMS"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2064,-656],"id":"cd3682fa-5c45-436e-8878-a3d75e552b91","name":"Salvar imagem no GitHub2","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organiza√ß√£o MIA"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"properties\": {\n    \"query_slide_2\": {\n      \"type\": \"string\",\n      \"description\": \"Query para slide 2\"\n    },\n    \"query_slide_3\": {\n      \"type\": \"string\", \n      \"description\": \"Query para slide 3\"\n    },\n    \"query_slide_1_backup\": {\n      \"type\": \"string\",\n      \"description\": \"Query backup para slide 1 (QUANDO PRECISA UNSPLASH)\"\n    },\n    \"imagem\": {\n      \"type\": \"string\",\n      \"description\": \"URL imagem original (QUANDO N√ÉO PRECISA UNSPLASH)\"\n    }\n  },\n  \"required\": [\"query_slide_2\", \"query_slide_3\"]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[144,-608],"id":"9811d2d0-c111-4690-83a6-e3f2a295b27d","name":"Structured Output Parser"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Verifica se a not√≠cia aprovada tem imagem\nconst noticia = $json;\n\nreturn {\n  json: {\n    ...noticia,\n    // Flag para decis√£o posterior\n    tem_imagem_original: !!(noticia.imagem && noticia.imagem.trim() !== ''),\n    // Mant√©m dados para Unsplash se necess√°rio\n    titulo_unsplash: noticia.titulo,\n    desenvolvimento_unsplash: noticia.titulo_desenvolvimento,\n    aplicabilidade_unsplash: noticia.titulo_aplicabilidade\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2256,736],"id":"3a182477-8266-4a5c-a7d9-d0bca6cfe2da","name":"Decis√£o de Imagem"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d8dd0e8-5d68-4872-99e9-1927d3f4315c","leftValue":"={{ $json.tem_imagem_original }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-2064,608],"id":"4c8f6dfd-b01b-4c16-b5fb-4efa01c89a6f","name":"Tem imagem?"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Analisador de Qualidade de Imagem para Redes Sociais\n\nPar√¢metros:\n\n    Fun√ß√£o: Avaliador de qualidade de imagem\n\n    Tarefa: Analisar a imagem e dar uma nota de 0 a 10 considerando sua adequa√ß√£o para redes sociais\n\nCrit√©rios de Avalia√ß√£o:\n\n    Qualidade t√©cnica (nitidez, foco, ilumina√ß√£o)\n\n    Composi√ß√£o visual (enquadramento, equil√≠brio, est√©tica)\n\n    Apelo visual para redes sociais\n\n    Cores e contraste\n\n    Potencial de engajamento\n\nClassifica√ß√£o:\n\n    Nota > 7 ‚Üí \"bom\"\n\n    Nota ‚â§ 7 ‚Üí \"ruim\"\n\n    Imagem totalmente preta ‚Üí automaticamente \"ruim\"\n\nResposta:\n\n    Apenas uma palavra: \"bom\" ou \"ruim\"\n","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-1792,480],"id":"12f9e6f8-16cf-4acd-9e6c-b4395995638a","name":"Analyze image2","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"bom","operator":{"type":"string","operation":"equals"}},{"id":"12e58e87-b71e-48f8-9bb1-e742f266886f","leftValue":"={{ $json.content }}","rightValue":"\"bom\"","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1584,480],"id":"cd2f3b3a-0ddb-467a-b148-87506582976f","name":"Imagem √© boa?"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-816,720],"id":"f3c6974c-40b6-433e-98ef-47e34e939fba","name":"Consolidador"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b5d79643-ef81-4cef-b02d-371990a64543","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-6304,944],"id":"d54ba2c7-0511-407b-81e6-d29d436219c1","name":"Valida√ß√£o do campo imagem1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"return {\n  ...$json,\n  original: $json // salva todos os dados da not√≠cia\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-6096,656],"id":"30308de3-06f3-434a-8367-e60402c3a3a6","name":"Backup dados da not√≠cia1"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\n\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : \"\";\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1]; // aqui mant√©m a URL achada\n  }\n}\n\n// Recupera os campos originais da not√≠cia de 'Backup dados da not√≠cia1'\nreturn {\n  ...($('Backup dados da not√≠cia1').item.json.original || {}),\n  imagem\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-5696,656],"id":"176cd7b1-da88-41e2-916c-eafb7b486f8c","name":"Extrair imagem do HTML1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05295fc0-aca6-433a-a239-c5d8ed4fc011","leftValue":"={{ $json.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5504,592],"id":"5a17b175-64e2-48f7-991a-6e09e17aa569","name":"Imagem encontrada?1","alwaysOutputData":false},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Voc√™ √© um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta √© \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-5264,400],"id":"fc1fc240-2010-4c74-a080-e862e42bfdf4","name":"Analyze image3","retryOnFail":true,"credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const html = $json.data || $json.body || '';\nconst ogImageMatch = html.match(/<meta\\s+property=[\"']og:image[\"']\\s+content=[\"']([^\"']+)[\"']/i);\nlet imagem = ogImageMatch ? ogImageMatch[1] : '';\n\nif (!imagem) {\n  const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n  if (imgMatch) {\n    imagem = imgMatch[1];\n  }\n}\n\n// Recupera os campos originais da not√≠cia de 'Backup dados da not√≠cia1'\nreturn {\n  ...($('Backup dados da not√≠cia1').item.json.original || {}),\n  imagem: $('Imagem encontrada?1').item.json.imagem\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-4800,384],"id":"e3862a12-781d-4b50-b54b-8428158bdfe7","name":"Salvar imagem gerada"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"GPT-4O"},"text":"Voc√™ √© um avaliador de qualidade de imagens.\n\nSua tarefa:\n- Analise a imagem recebida.\n- De uma nota de 0 a 10 para a imagem pensando em quanto a imagem esta boa para postarmos nas redes sociais\n\nResponda **apenas** com uma das duas palavras:  \n\n- Se a nota foi maior do que 6 responda com \"bom\"  \n- Se a nota foi menor ou igual a 6 responda com \"ruim\"\n- Imagem totalmente preta √© \"ruim\"","imageUrls":"={{ $json.imagem }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":1.8,"position":[-5888,1104],"id":"7dee023b-9b5f-4030-9bfd-4f0ef0bc70e6","name":"Analyze image4","credentials":{"openAiApi":{"id":"GLHn0uXL8dRQAYuS","name":"OpenAi account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Pega os dados originais da padroniza√ß√£o\nconst original = $('Padroniza√ß√£o do campo imagem1').item.json;\n\nreturn {\n  ...original\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-5248,784],"id":"5294fa1b-0434-48c4-a23c-f8c1c9db2c84","name":"Salvar imagem gerada6"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5504,1104],"id":"71900f66-09da-43ac-8940-12f74753ba4d","name":"Imagem √© boa?1"},{"parameters":{"numberInputs":5},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-4592,704],"id":"2cc69fa9-3739-47ac-8e9a-91c004bf4acd","name":"Unificar imagem final1"},{"parameters":{"assignments":{"assignments":[{"id":"09010a96-1a0a-400e-9b4f-d0b282c7f3e1","name":"precisa_unsplash","value":true,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1328,624],"id":"fee0c2c2-b9ec-4e57-a90c-c108b77c76cf","name":"Precisa do Unsplash?"},{"parameters":{"content":"## Verifica se precisa do unsplash para a primeira imagem","height":704,"width":1728,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2320,416],"id":"f4d4a89b-70e3-4844-ac46-ccbaa7c0f5c4","name":"Sticky Note1"},{"parameters":{"content":"# Defini√ß√£o da Primeira (Introdu√ß√£o) Imagem do Post\n\n### Primeiro busca imagem na not√≠cia, se n√£o busca no unsplash","height":1024,"width":2784,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-7040,224],"typeVersion":1,"id":"22d8a3c9-06d8-4ee9-9637-78bbd0ac5917","name":"Sticky Note7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cf2d6cbd-1531-4e27-bee0-7d5bed199142","leftValue":"={{ $json.content }}","rightValue":"ruim","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-5056,400],"id":"1abbce4c-d893-4489-a5f0-3c4663c2c3c6","name":"Imagem √© boa?2"},{"parameters":{"assignments":{"assignments":[{"id":"265c256e-8a6a-43a2-8fc2-c8903993ad93","name":"precisa_unsplash","value":false,"type":"boolean"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1328,464],"id":"0c0393dd-2529-47a1-bc9c-a90cea6bcb70","name":"Precisa do Unsplash?2"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Processar Resultado Unsplash\nconst results = $json.results || [];\n\n// Se houver resultados, escolhe um √≠ndice aleat√≥rio entre 0 e (results.length - 1)\nconst randomIndex = results.length > 0 ? Math.floor(Math.random() * results.length) : 0;\nconst selectedImage = results[randomIndex] || {};\n\n// Extrair a melhor URL dispon√≠vel\nconst imageUrl = selectedImage.urls?.regular ||\n                 selectedImage.urls?.small ||\n                 selectedImage.urls?.raw || '';\n\nreturn {\n  json: {\n    // URL para usar no HTML\n    unsplash_url: imageUrl,\n    \n    // URL para download direto (se necess√°rio)\n    unsplash_download: selectedImage.links?.download || '',\n    \n    // Cr√©ditos do fot√≥grafo\n    photographer: selectedImage.user?.name || 'Unsplash',\n    \n    // Dados completos para debug\n    image_data: selectedImage,\n    \n    // Mant√©m a query original para refer√™ncia\n    original_query: $json.query_slide_1_backup || $json.query_slide_2 || $json.query_slide_3\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[672,304],"id":"80d82b63-14ae-4664-b283-94f8a69d1e46","name":"Processar Resultado Unsplash (URL)2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e619bdff-dda2-43d6-8b48-3c7d6a9f18f6","leftValue":"={{ $json.output.query_slide_1_backup }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[112,448],"id":"f61c8932-13c8-455a-932d-8a25d127cbb5","name":"Precisa do Unsplash?3"},{"parameters":{"url":"https://api.unsplash.com/search/photos","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $json.output.query_slide_1_backup }}"},{"name":"per_page","value":"3"},{"name":"order_by","value":"relevant"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Client-ID 7cA4i_P1XrK0vEFO3hly2Lwr7XYmnHnDfAf3ChPjn6I"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[480,304],"id":"b1bf02ee-0b69-4a10-b666-cee6a7bae708","name":"(Introdu√ß√£o) Buscar Imagem Unsplash"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-1072,608],"id":"4069dfbc-07ec-4f53-9d9f-a2ee4b04a063","name":"Consolidador1"},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_1.file_content }}","name":"={{ $json.drive_file_1.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX","mode":"list","cachedResultName":"BMS - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4272,-48],"id":"52caf616-2114-4fdc-873d-154b84a893a2","name":"Envia base64 para o Drive","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_2.file_content }}","name":"={{ $json.drive_file_2.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX","mode":"list","cachedResultName":"BMS - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4272,-224],"id":"d66b8499-df94-4462-9487-03ae06b4e452","name":"Envia base64 para o Drive1","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"operation":"createFromText","content":"={{ $json.drive_file_3.file_content }}","name":"={{ $json.drive_file_3.file_name }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX","mode":"list","cachedResultName":"BMS - base64","cachedResultUrl":"https://drive.google.com/drive/folders/1btcyzEyzQ3TjSTJPspe7VncrTXwat-EX"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[4272,-416],"id":"79045076-7cae-449d-ae02-1d1d67eada62","name":"Envia base64 para o Drive2","credentials":{"googleDriveOAuth2Api":{"id":"ZkmaJh5Y8Zdz8ju7","name":"Google Drive - lucas@getmia.com.br"}}},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2080,-1136],"id":"e10fcd17-9ddd-4b4f-bf56-2feb4c023dca","name":"Loop Over Items"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2192,-1328],"id":"0b4516b3-193b-403f-9fac-1bf0237c8143","name":"Wait","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2096,-464],"id":"40bc662d-b90b-424a-8e42-64236c9be663","name":"Loop Over Items2"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2208,-656],"id":"a36ad01e-8e5e-4adb-8f75-17c6348e6731","name":"Wait2","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nreturn items.map((item, i) => {\n  const temp_id = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}_${i+1}`;\n  return {\n    json: {\n      ...item.json,\n      temp_id,\n    },\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-320,720],"id":"23b2bb52-16f9-4be3-a059-1126e883dc46","name":"temp_id"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2784,-992],"id":"5cfac3f1-0728-45be-8d86-048310d3890a","name":"Merge1","alwaysOutputData":false},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2800,-352],"id":"f6959361-d11d-48f5-92b8-1d43a75a7604","name":"Merge2"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2816,272],"id":"ddc3cb61-5d84-4beb-8d53-041866506dd8","name":"Merge4"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3568,-32],"id":"0949531c-8bc4-466b-a58f-38dd48a76337","name":"Merge5"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3200,704],"id":"06d78b3e-2816-4cce-9010-a3b0c8b63996","name":"Merge6"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[880,448],"id":"412c95bf-788c-4309-b468-43a16564c594","name":"Merge7"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2096,128],"id":"420be269-73d4-47b2-a737-98d7a1245fe0","name":"Loop Over Items3"},{"parameters":{"amount":3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2208,-64],"id":"b12f0eb2-81b3-477f-87e2-f3392451aba7","name":"Wait3","webhookId":"5a52a7df-fa6c-4352-a402-5b8f2b12c9c7"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[976,-576],"id":"7ac85d27-5ee9-4fe9-beb8-f82c35ff629b","name":"Tem img?"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[928,-128],"id":"657c5d11-f58e-4942-9760-57c7d6a07e73","name":"Tem img?1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4b88b6e4-ce0f-4ef6-94a4-074fd7f6a3ba","leftValue":"={{ $json.unsplash_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"9c2eeca7-eb95-4d4a-aa85-9046491721e4","leftValue":"={{ $json.output.imagem }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1072,448],"id":"99d218ad-2855-4122-b2e4-30a5a63e52aa","name":"Tem img?2"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f6646cb8-557a-46f3-bddc-461bdfd44764","leftValue":"={{ $json.download_url }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"c45dde80-b316-4613-98d1-8200f27afcd7","leftValue":"={{ $json.download_url1 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"4e9d9762-241e-4977-aabd-3cd4417635a6","leftValue":"={{ $json.download_url2 }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[3776,-32],"id":"72a47360-58ae-4f42-94ad-63c0aed6404c","name":"Tem todas as imgs?"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolThink","typeVersion":1,"position":[80,-208],"id":"bddc2c6f-ebef-43b1-8fa4-ee337ead792b","name":"Think"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9ccf8025-f67f-4b35-a0c8-868c8abd2990","leftValue":"={{ $json.status }}","rightValue":"aprovada","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}},{"id":"5da3e465-1771-4a28-98e3-eb97db369f0a","leftValue":"={{ $json.nota }}","rightValue":6,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-3472,752],"id":"f765e2d5-0461-43fd-83f5-c2d7158a29ea","name":"Filtro Relev√¢ncia1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-4016,928],"id":"fc0fdd9b-2003-454f-8027-8b3aabba1323","name":"OpenRouter Chat Model1","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"promptType":"define","text":"=Voc√™ √© um especialista e autoridade em conte√∫do tribut√°rio no Instagram. Sua comunica√ß√£o √© informativa, objetiva e valorizada por profissionais do setor ‚Äî como contadores, advogados tributaristas, consultores fiscais, empres√°rios e gestores financeiros ‚Äî que lidam com a tributa√ß√£o de empresas (n√£o pessoa f√≠sica).\n\nEntrada: uma lista de not√≠cias (cada item cont√©m {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}).\nPode haver itens duplicados vindos de fontes diferentes.\n\nSua miss√£o:\nAnalise profundamente todas as not√≠cias.\nPara cada not√≠cia, atribua uma nota de relev√¢ncia de 0 a 10, representando o quanto ela √© relevante para o setor tribut√°rio empresarial brasileiro (excluindo pessoa f√≠sica, IRPF, IPTU, IPVA, CPF, etc.).\n\nA nota deve refletir o interesse para contadores, advogados tributaristas, consultores fiscais, empres√°rios, gestores financeiros e outros profissionais.\nConsidere impacto direto para empresas: mudan√ßas na legisla√ß√£o tribut√°ria, decis√µes judiciais (STF/STJ), decis√µes administrativas (CARF/Receita Federal), regimes de apura√ß√£o (Lucro Real, Presumido, Simples), dados sobre carga tribut√°ria empresarial, tend√™ncias fiscais ou novos benef√≠cios/incentivos para empresas.\n\n**IMPORTANTE SOBRE IMAGENS:**\n- O campo \"imagem\" pode estar vazio, nulo ou conter URL inv√°lida\n- Isso √© normal e ser√° tratado posteriormente no fluxo\n- Sua an√°lise de relev√¢ncia N√ÉO deve ser influenciada pela presen√ßa ou n√£o de imagem\n\n---\n### **REGRAS CENTRAIS DE JULGAMENTO**\n**Atualidade obrigat√≥ria**\n\n* A not√≠cia deve ser **do ano vigente **.\n\n**Voc√™ deve agir como um filtro cr√≠tico, n√£o como um redator otimista.**\n\nAvalie o impacto pr√°tico e aplicabilidade da not√≠cia, mesmo que n√£o seja imediato.\nConsidere especialmente se o conte√∫do pode ajudar o profissional tribut√°rio a se atualizar, evitar riscos, ou aproveitar oportunidades fiscais e legais.\n\nNot√≠cias relevantes incluem:\n*Mudan√ßas em leis, normas, decretos ou decis√µes judiciais que impactem a tributa√ß√£o (federal, estadual ou municipal)\n*Atualiza√ß√µes da Receita Federal, CARF ou STF com impacto pr√°tico sobre impostos\n*Novas obriga√ß√µes acess√≥rias, prazos, declara√ß√µes ou sistemas digitais (ex.: eSocial, DCTFWeb, SPED)\n*Pol√≠ticas fiscais, incentivos ou programas de regulariza√ß√£o (ex.: Refis, isen√ß√µes, cr√©ditos tribut√°rios)\n*Tend√™ncias em tecnologia tribut√°ria, automa√ß√£o fiscal e compliance digital\n*Casos de sucesso ou boas pr√°ticas em gest√£o e planejamento tribut√°rio\n\nNot√≠cias gen√©ricas, internacionais ou sem liga√ß√£o clara com o sistema tribut√°rio recebem nota ‚â§ 7.\nNot√≠cias que trazem aplica√ß√£o pr√°tica, cases empresariais, exemplos de reorganiza√ß√£o tribut√°ria ou estrat√©gias reais de gest√£o fiscal, ainda que sem mudan√ßa legislativa, podem receber nota 9, desde que apresentem aprendizados, resultados ou m√©todos aplic√°veis √† rotina de empresas ou profissionais do setor.\nNot√≠cias com impacto direto e imediato ‚Äî como mudan√ßas legais, decis√µes relevantes ou novas obriga√ß√µes fiscais ‚Äî continuam sendo nota 10.\n\n#### O que √© RELEVANTE (nota alta ‚Äî 9 ou 10)\n\n*Not√≠cias que ajudam profissionais e empresas a:\n*Entender mudan√ßas na legisla√ß√£o tribut√°ria, regras fiscais, cont√°beis ou previdenci√°rias (federal, estadual ou municipal);\n*Antecipar impactos da Reforma Tribut√°ria ou novas normas de ICMS, ISS, IRPJ, CSLL, PIS, COFINS e Simples Nacional;\n*Aplicar novas obriga√ß√µes acess√≥rias, prazos de entrega (ex.: SPED, DCTFWeb, EFD-Reinf, eSocial);\n*Conhecer incentivos fiscais, regimes especiais ou decis√µes judiciais relevantes (ex.: STF, STJ, CARF, Receita Federal);\n*Compreender tend√™ncias tecnol√≥gicas que impactam o setor (automa√ß√£o fiscal, intelig√™ncia artificial, contabilidade digital);\n*Atualizar clientes e empresas com orienta√ß√µes pr√°ticas e riscos tribut√°rios;\n*Aprender estrat√©gias de compliance fiscal, gest√£o tribut√°ria e planejamento tribut√°rio.\n* Casos pr√°ticos e exemplos empresariais de planejamento tribut√°rio, reorganiza√ß√£o fiscal, consultoria tribut√°ria aplicada ou resultados concretos em gest√£o fiscal e financeira, desde que tragam aprendizado aplic√°vel para o p√∫blico do setor.\n\n#### O que √© POUCO RELEVANTE (nota baixa ‚Äî < 7)\n\n*Not√≠cias pol√≠ticas ou econ√¥micas sem liga√ß√£o direta com o sistema tribut√°rio ou cont√°bil;\n*Not√≠cias sobre macroeconomia, infla√ß√£o, juros ou c√¢mbio sem efeito pr√°tico em impostos, obriga√ß√µes ou arrecada√ß√£o;\n*Mat√©rias internacionais sem rela√ß√£o com o contexto fiscal brasileiro;\n*Conte√∫dos gen√©ricos sobre tecnologia ou neg√≥cios sem conex√£o com contabilidade, legisla√ß√£o ou compliance tribut√°rio;\n*Mat√©rias repetidas com pequenas varia√ß√µes de t√≠tulo, n√∫mero ou data.\n\n**Crit√©rio fundamental:**\nSe um contador, tributarista ou gestor fiscal ler essa not√≠cia e n√£o souber como aplic√°-la na rotina do escrit√≥rio, consultoria ou empresa, ela n√£o deve receber nota 9 ou 10.\n\n---\n\n### **Duplicidade**\n\nN√£o repita not√≠cias com pequenas varia√ß√µes de t√≠tulo, link ou n√∫meros.\nCompare sempre conte√∫do e t√≠tulo ‚Äî se for o mesmo fato, mantenha apenas uma.\n\n---\n\n### **Imagens**\n\nO campo ‚Äúimagem‚Äù pode estar vazio, nulo ou inv√°lido ‚Äî ignore isso totalmente na avalia√ß√£o de relev√¢ncia.\nUse apenas o conte√∫do textual para decidir a nota.\n\n---\n\n### **IMPORTANTE SOBRE A NOTA**\n\n* 10 ‚Üí Impacto direto e imediato (mudan√ßa de lei, obriga√ß√£o acess√≥ria nova, decis√£o judicial relevante, novo incentivo fiscal).\n* 9 ‚Üí Impacto aplic√°vel e relevante (tend√™ncia clara, altera√ß√£o prov√°vel, estudo pr√°tico ou mudan√ßa setorial relevante).\n* 8 ou menos ‚Üí Gen√©rica, indireta, repetida ou sem a√ß√£o pr√°tica.\n\n**Somente not√≠cias com nota ‚â• 9 ser√£o publicadas.**\nPortanto, **erre para menos**, n√£o para mais ‚Äî seja exigente.\n\nConsidere mais relevante se a not√≠cia ajudar o profissional tribut√°rio a:\n*Cumprir corretamente suas obriga√ß√µes fiscais;\n*Evitar autua√ß√µes e penalidades;\n*Acompanhar decis√µes e mudan√ßas legislativas;\n*Aumentar efici√™ncia e competitividade;\n*Se posicionar como especialista atualizado e confi√°vel;\n*Melhorar o atendimento a clientes e empresas.\n\nDesconsiderar conte√∫dos n√£o relacionados √† √°rea tribut√°ria (ex.: economia geral, pol√≠tica ou neg√≥cios sem reflexo fiscal, not√≠cias sobre consumo ou mercado financeiro sem impacto tribut√°rio direto).\n\nEvitar repetir not√≠cias com pequenas varia√ß√µes. Use o link e title para detectar duplicados.\n\nSempre use content ou contentSnippet para an√°lise; t√≠tulos sozinhos n√£o s√£o suficientes.\n\n---\n\n### **Formato de sa√≠da (JSON limpo e direto)**\n\n[\n  {\n    \"link\": \"{{ $json.link }}\",\n    \"title\": \"{{ $json.title }}\",\n    \"content\": \"{{ $json.content }}\",\n    \"contentSnippet\": \"{{ $json.contentSnippet }}\",\n    \"status\": \"aprovada\" | \"reprovada\",\n    \"nota\": 0-10,\n    \"justificativa\": \"motivo curto e objetivo da decis√£o (ex: 'impacto direto no cr√©dito imobili√°rio', 'not√≠cia gen√©rica sem rela√ß√£o com im√≥veis', 'publica√ß√£o antiga de 2023')\"\n    \"imagem\": \"{{ $json.imagem }}\", // Pode ser string vazia - mantenha o valor original\n    \"fonte\": \"{{ $json.link }}\",\n  }\n]","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-4016,752],"id":"2218ca6a-f6f5-45ea-ab8d-4f175190c0cd","name":"AI Agent - Avalia√ß√£o das not√≠cias","onError":"continueRegularOutput"},{"parameters":{"content":"# Avalia√ß√£o das not√≠cias\n\n### Escolhe o que √© mais relevante de acordo com o contexto da aplica√ß√£o","height":704,"width":784},"type":"n8n-nodes-base.stickyNote","position":[-4096,416],"typeVersion":1,"id":"a683c641-d457-4173-8ffd-84d8c897696f","name":"Sticky Note13"},{"parameters":{"jsCode":"// Une todas as sa√≠das em um array √∫nico (o agente retorna um JSON por item)\nconst allAvaliacoes = items.flatMap(item => {\n  try {\n    return JSON.parse(item.json.output);\n  } catch (error) {\n    console.error(\"Erro ao parsear sa√≠da do agente:\", error);\n    return [];\n  }\n});\n\n// Garante que cada not√≠cia seja um item individual\nreturn allAvaliacoes.map(noticia => ({\n  json: {\n    link: noticia.link || \"\",\n    title: noticia.title || \"\",\n    content: noticia.content || \"\",\n    contentSnippet: noticia.contentSnippet || \"\",\n    imagem: noticia.imagem || \"\",\n    pontuacao: noticia.pontuacao ?? noticia.nota ?? 0,\n    nota: noticia.nota ?? noticia.pontuacao ?? 0,\n    status: noticia.status || \"reprovada\",\n    justificativa: noticia.justificativa || \"\",\n    fonte: noticia.fonte || noticia.link || \"\"\n  }\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-3664,752],"id":"9f0e6a5c-065c-4f53-b578-954a3e9e806e","name":"Estrutura√ß√£o do JSON de sa√≠da1","onError":"continueRegularOutput"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d0dfeb91-0204-4723-b60b-d9b5fa6a1c80","leftValue":"={{ \n  // Verifica se TODOS os campos essenciais existem e s√£o v√°lidos\n  $json.title && \n  $json.title !== \"undefined\" &&\n  $json.link && \n  $json.link !== \"undefined\" &&\n  $json.content && \n  $json.content !== \"ruim\" &&\n  $json.content !== \"undefined\" \n}}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-4400,752],"id":"032372ea-8282-4f34-87fe-bd526f631173","name":"Impede que tupla undefined passe para o agente"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-3088,944],"id":"870297a9-f413-4387-ae22-14ea7cf36e58","name":"OpenRouter Chat Model2","credentials":{"openRouterApi":{"id":"o1ywdYlH64cgqSMT","name":"OpenRouter account"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const binaryData = $input.item.binary?.[\"imagem_final\"];\n\nif (!binaryData || !binaryData.data) {\n  throw new Error(\"Campo 'imagem_final' n√£o encontrado no bin√°rio.\");\n}\n\nconst base64 = Buffer.from(binaryData.data, 'base64').toString(\"base64\");\n// Pega o temp_id do outro n√≥\nconst tempId = $('temp_id').item.json.temp_id.toString().trim();\nreturn {\n  json: {\n    base64Image: base64,\n    temp_id: tempId\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2384,368],"id":"32df65e6-34ac-4b58-80b0-acfd650f354a","name":"Binary > base65"},{"parameters":{"promptType":"define","text":"=Voc√™ √© um especialista e autoridade em conte√∫do tribut√°rio no Instagram. Sua comunica√ß√£o √© informativa, objetiva e valorizada por profissionais do setor ‚Äî como contadores, advogados tributaristas, consultores fiscais, empres√°rios e gestores financeiros ‚Äî que lidam com a tributa√ß√£o de empresas (n√£o pessoa f√≠sica).\n\nEntrada: uma lista de not√≠cias (cada item cont√©m {{ $json.link }}, {{ $json.title }}, {{ $json.content }}, {{ $json.contentSnippet }}, {{ $json.imagem }}). Pode haver itens duplicados vindos de fontes diferentes.\n\nAnalise profundamente todas as not√≠cias e atribua uma nota de relev√¢ncia (0 a 10) conforme o impacto no setor tribut√°rio empresarial brasileiro.\nA nota deve refletir o interesse e a aplicabilidade para os profissionais que lidam com gest√£o e planejamento tribut√°rio de empresas.\n\n### Regras gerais\nMantenha o campo \"imagem\" exatamente como veio (mesmo que vazio).\nUse apenas conte√∫do textual para criar o post.\nEntregue conte√∫do denso, aplic√°vel e com ritmo fluido.\n\n> **‚ö†Ô∏è Consist√™ncia temporal obrigat√≥ria**\n>\n‚ùó Sempre mantenha consist√™ncia temporal:\n\nUse apenas o ano real da not√≠cia (se dispon√≠vel) ou o ano atual do sistema.\n\nNunca infira anos futuros ou passados.\n\nSe a not√≠cia n√£o mencionar o ano, n√£o adicione um ano por conta pr√≥pria.\n\nSe precisar mencionar um per√≠odo, use express√µes neutras como ‚Äúneste ano‚Äù, ‚Äúrecentemente‚Äù ou ‚Äúa partir de agora‚Äù.\n\n> * Sempre use o **ano real da not√≠cia** conforme o campo `{{ $json.link }}`, `{{ $json.title }}` ou `{{ $json.content }}`. Ent√£o se falar sobre coisas para ano posteriores mantenha o que foi abordado. Exemplo: \"em {{$now.year+1}}\" usar o ano futuro mesmo. Mas nunca o ano menor que {{$now.year}}\n> * **Jamais** use anos diferentes (por exemplo, n√£o diga ‚Äúem 2024‚Äù se a not√≠cia ou data atual for de 2025).\n> * Se o texto da not√≠cia n√£o mencionar o ano explicitamente, **presuma o ano atual do sistema ({{$now.year}})**.\n> * Se encontrar um ano desatualizado (ex.: ‚Äúa partir de 2024‚Äù) e a data da not√≠cia j√° for posterior, **atualize o texto para o ano correto**, ajustando coerentemente a frase.\n> * A coer√™ncia temporal √© **obrigat√≥ria em todos os campos**: t√≠tulos, subt√≠tulos, textos do carrossel, legendas e hashtags.\n> * Exemplo:\n>\n>   * ‚ùå ‚ÄúSua isen√ß√£o pode aumentar em 2024‚Äù\n>   * ‚úÖ ‚ÄúSua isen√ß√£o pode aumentar em 2025‚Äù *(se a not√≠cia e o ano atual forem 2025)*\n\n### üí°  refor√ßo contextual (opcional, se quiser m√°xima precis√£o)\n\n> O agente deve sempre considerar o **ano atual do sistema como refer√™ncia principal** para validar ou corrigir datas em t√≠tulos e legendas.\n> Quando o texto original mencionar um ano anterior ao atual, adapte a frase para o tempo presente (ex.: ‚Äúfoi aprovado‚Äù ‚Üí ‚Äúfoi aprovado neste ano‚Äù).\n\n‚úçÔ∏è ESTRUTURA COMPLETA PARA 3 IMAGENS DO CARROSSEL\nPara cada not√≠cia √∫nica, crie conte√∫dos para as 3 imagens do carrossel:\n\nIMAGEM 1 (INTRODU√á√ÉO) - T√çTULO MAGN√âTICO:\nCrie um t√≠tulo magn√©tico e direcionado ao corretor de im√≥veis, com at√© 10 palavras. O objetivo √© despertar a curiosidade e um senso de oportunidade ou urg√™ncia, como um \"clickbait do bem\". Para isso, siga uma das estrat√©gias abaixo:\n\n- Fale diretamente com o corretor: Use pronomes como \"Voc√™\", \"Seu\", \"Sua\". (Ex: ‚ÄúSua forma de declarar impostos vai mudar.‚Äù)\n- Crie uma pergunta provocativa: Questione uma pr√°tica comum ou aponte para uma nova tend√™ncia. (Ex: ‚ÄúO Simples Nacional est√° ficando menos vantajoso?‚Äù)\n- Fa√ßa uma promessa de valor: Destaque um benef√≠cio direto. (Ex: ‚ÄúA estrat√©gia que reduz a carga tribut√°ria sem risco fiscal.‚Äù)\n- Gere um alerta: Indique uma mudan√ßa, risco ou nova exig√™ncia legal. (Ex: ‚ÄúAten√ß√£o: nova regra do IRPJ pode afetar seus clientes.‚Äù)\n\nImportante: O t√≠tulo deve ser irresist√≠vel, mas sempre 100% fiel ao conte√∫do da not√≠cia. Sem sensacionalismo exagerado ou promessas falsas.\n\nSelecione 1 palavra-chave do t√≠tulo para ficar em it√°lico o crit√©rio para escolher √©:\n    Palavra mais impactante do t√≠tulo\n    Conceito central da not√≠cia\n    Termo que gera curiosidade\n    M√°ximo 1 palavra (n√£o frase)\nEnvolva essa palavra com <em> diretamente no t√≠tulo\nM√°ximo 1 palavra em it√°lico\nExemplos:\n    \"estrat√©gia\"\n    \"oportunidade\"\n    \"obriga√ß√µes\"\n    \"lucro\"\n    \"benef√≠cio\"\nGere tamb√©m um subtitulo_formatado: Texto complementar para o subt√≠tulo que deve ser um gancho para o conte√∫do que ser√° apresentado no titulo_desenvolvimento.\n\nExemplo:\n{\n  \"titulo\": \"Sua <em>estrat√©gia</em> tribut√°ria pode estar te custando caro\",\n  \"subtitulo_formatado\": \"Mudan√ßas no regime de lucro real exigem nova postura do contador\"\n}\n\nIMAGEM 2 (DESENVOLVIMENTO) - O CERNE DA NOT√çCIA (MAIS PROFUNDO):\n\n- Entre 50 e 55 palavras ‚Äî texto expandido e denso.\n- OBJETIVO: Apresentar o cerne da not√≠cia com clareza e profundidade, explicando o contexto, os dados concretos e as implica√ß√µes para o mercado. Apresentar o cerne da not√≠cia com clareza e profundidade, explicando o contexto, os dados concretos e as implica√ß√µes fiscais e cont√°beis.\n\nESTRUTURA IDEAL:\n1. Explique o fato principal da not√≠cia (o que aconteceu). - descreva o que mudou (nova lei, decis√£o judicial, portaria, atualiza√ß√£o do sistema, prazo, benef√≠cio, etc.).\n2. Mostre o impacto direto no cen√°rio tribut√°rio ‚Äî como afeta empresas, contadores, contribuintes, regimes fiscais, carga tribut√°ria ou obriga√ß√µes acess√≥rias.\n3. Inclua dados concretos ‚Äî n√∫meros, al√≠quotas, prazos, percentuais, valores, setores, regi√µes.\n4. D√™ interpreta√ß√£o profissional ‚Äî o que isso representa para o contador, consultor fiscal ou gestor financeiro (sem ainda entrar em a√ß√£o pr√°tica).\n\nPara a segunda imagem, gere tamb√©m:\n- texto_desenvolvimento: Array com 3 strings (no total tem que ter 50-55 palavras, isto √©, bloco1 + bloco2 + bloco3 = no minimo 50 e no maximo 55 palavras, a soma dos caracteres/palavras das strings do array todo tem que ter no minimo 50 palavras e no maximo 55 palavras)\nCada bloco do texto_desenvolvimento deve ter **no m√°ximo 20 palavras** para o bloco 1, **20 palavras** para o bloco 2 e **20 palavras** para o bloco 3, somando no m√°ximo 60 palavras.\nN√£o ultrapasse esses limites. Conte as palavras antes de terminar o bloco.\n- formatacao_desenvolvimento: Array especificando formata√ß√£o para cada bloco:\n      bloco1: palavras para negrito e it√°lico (EB Garamond)\n      bloco2: palavras para negrito\n      bloco3: palavras para sublinhado\n\nCRIT√âRIOS DE FORMATA√á√ÉO:\n\nBloco 1 (bold + it√°lico):\n    bold: n√∫meros, porcentagens, dados concretos\n    italico: conceitos centrais, termos t√©cnicos, nomes pr√≥prios\n\nBloco 2 (apenas bold):\n    bold: palavras-chave, termos importantes\n\nBloco 3 (sublinhado):\n    sublinhado: insights principais, conclus√µes, tend√™ncias\n\nEXEMPLOS:\n{\n  \"texto_desenvolvimento\": [\n    \"A recente <em>Instru√ß√£o Normativa</em> da Receita Federal prorrogou o prazo de entrega da <b>ECD</b> at√© <b>31 de maio</b> para empresas do <em>Lucro Real</em>.\",\n    \"A medida traz <b>al√≠vio</b> tempor√°rio para contadores e gestores, que enfrentam alta carga de <b>obriga√ß√µes acess√≥rias</b> e m√∫ltiplos sistemas integrados.\",\n    \"No entanto, <u>o cumprimento antecipado continua estrat√©gico</u> para evitar <u>autua√ß√µes</u> e garantir <u>planejamento fiscal eficiente</u>.\"\n  ]\n}\n\nIMAGEM 3 (APLICABILIDADE) - A√á√ÉO IMEDIATA DO CORRETOR (MAIS ROBUSTA):\n- Entre 50 e 60 palavras ‚Äî com foco pr√°tico e detalhado.\n- OBJETIVO: Transformar o conte√∫do da not√≠cia em a√ß√£o direta e aplic√°vel no trabalho cont√°bil, fiscal ou tribut√°rio.\nESTRUTURA IDEAL:\n1. Mostre como o profissional pode usar a informa√ß√£o no dia a dia (orientar clientes, revisar regimes, atualizar processos, comunicar altera√ß√µes).\n2. D√™ um passo pr√°tico e mensur√°vel (revisar c√°lculos, ajustar sistemas, emitir alertas, revisar enquadramentos tribut√°rios, preparar relat√≥rios, etc.).\n3. Mostre o benef√≠cio real: redu√ß√£o de riscos, economia fiscal, conformidade, efici√™ncia operacional, autoridade t√©cnica, previsibilidade tribut√°ria.\n4. Se for mudan√ßa regional ou setorial, indique como usar como modelo ou oportunidade de benchmarking.\n\nPara a terceira imagem, gere tamb√©m:\n- texto_aplicabilidade: Array com 3 strings (no total com 50-60 palavras)\n- formatacao_aplicabilidade: Array especificando formata√ß√£o para cada bloco:\n        bloco1: palavras para negrito e it√°lico (EB Garamond)\n        bloco2: palavras para sublinhado\n        bloco3: texto normal (sem formata√ß√£o especial)\n\nCRIT√âRIOS DE FORMATA√á√ÉO:\nBloco 1 (Bold + It√°lico):\n    bold: a√ß√µes espec√≠ficas, passos concretos\n    italico: conceito central, benef√≠cio principal\n\nBloco 2 (Sublinhado):\n    sublinhado: estrat√©gias chave, diferenciais competitivos\n\nBloco 3 (Normal):\n    Sem formata√ß√£o: benef√≠cio final, resultado esperado\n\nExemplo:\n{\n  \"titulo_aplicabilidade\": \"Aproveite a prorroga√ß√£o da ECD para refor√ßar o planejamento fiscal\",\n  \"texto_aplicabilidade\": [\n    \"<b>Revise imediatamente os lan√ßamentos cont√°beis</b> e verifique inconsist√™ncias que possam comprometer a entrega. <b>Organize o cronograma de ajustes</b> e valide o <em>planejamento fiscal</em> junto √†s √°reas respons√°veis antes do novo prazo.\",\n    \"Implemente uma rotina de <u>checagem preventiva</u> e mantenha clientes informados sobre <u>obriga√ß√µes acess√≥rias</u>. Use relat√≥rios sint√©ticos para <u>demonstrar seguran√ßa e dom√≠nio t√©cnico</u> durante auditorias internas.\",\n    \"Essa postura proativa evita penalidades, aumenta a confian√ßa dos clientes e consolida sua imagem como refer√™ncia em gest√£o tribut√°ria eficiente e alinhada √†s melhores pr√°ticas.\"\n  ]\n}\n\n## LEGENDA INSTAGRAM/WHATSAPP\n\nEscreva uma legenda com at√© 600 caracteres, dividida em 5 blocos, bem explicados. Ela deve ser clara, simples e com tom did√°tico, como se estivesse explicando para algu√©m que nunca ouviu falar do assunto.\n\nA legenda deve conter cinco blocos separados por \\n\\n, mas sem escrever os nomes dos blocos. Siga a estrutura abaixo apenas como orienta√ß√£o interna (n√£o inclua esses t√≠tulos no texto final):\n\nEstrutura da legenda:\n\nContexto e Fato: Conte o que aconteceu, com as informa√ß√µes principais e n√∫meros relevantes (sem termos t√©cnicos dif√≠ceis) e sempre cobrindo todos os pontos da not√≠cia.\n\nSimplifica√ß√£o do Tema: Explique com clareza e simplicidade o que √© esse tema (ex: o que √© ICMS? Como funciona o planejamento tribut√°rio? O que s√£o solu√ß√µes de consulta, etc.). Imagine que est√° falando com algu√©m de 18 anos que nunca ouviu falar disso.\n\nImpacto no Neg√≥cio: Mostre como a not√≠cia impacta diretamente nos neg√≥cios e empresas: economia tribut√°ria, novos riscos de autua√ß√£o, oportunidades de planejamento, mudan√ßas em regimes de apura√ß√£o, ou ajustes necess√°rios na gest√£o fiscal.\n\nChamada para Reflex√£o: Inclua uma pergunta ou convite leve para o p√∫blico refletir ou comentar. Algo que gere discuss√£o nos coment√°rios, pedindo opini√µes ou levantando uma quest√£o pol√™mica. Uma consultoria tributaria ajudaria em algo?\n\nCTA Final: Acrescente exatamente uma linha final, separada por \\n\\n, somos uma consultoria tribut√°ria, ent√£o o CTA tem que ser para quem est√° recebendo a mensagem marcar uma agenda com nossos especialistas e descobrir como estruturar a melhor estrat√©gia tribut√°ria para a sua empresa.\n\nUse esta estrutura apenas como refer√™ncia interna para construir a legenda (n√£o escreva os t√≠tulos dos blocos na legenda final).\n\nA legenda n√£o deve parecer um convite para acessar a mat√©ria completa. Ela j√° entrega o que importa.\n\nCrie 3 parametros baseado na legenda estruturada para retornar no json seguindo a logica abaixo:\n\nparam_2 = Resuma o bloco Contexto e Fato da legenda utilizando entre 20 e 25 palavras.\nparam_3 = Resuma o bloco Simplifica√ß√£o do Tema da legenda utilizando entre 15 e 20 palavras.\nparam_4 = Resuma o bloco Impacto no Neg√≥cio da legenda utilizando entre 20 e 25 palavras, sempre visando trazer para o empresario como aquela notica impacta no dia a dia da sua empresa.\n\nRetorne diretamente como JSON v√°lido (n√£o como string). Sem aspas no array completo.\n\n## üê¶ LEGENDA X (TWITTER)\n\nEscreva uma legenda com at√© 400 caracteres, dividida em 6 blocos, bem explicados. Ela deve ser clara, simples e com tom did√°tico, como se estivesse explicando para algu√©m que nunca ouviu falar do assunto.\n\nA legenda deve conter cinco blocos separados por \\n\\n, mas sem escrever os nomes dos blocos. Siga a estrutura abaixo apenas como orienta√ß√£o interna (n√£o inclua esses t√≠tulos no texto final):\n\n### üß© Estrutura\n\nCrie **6 blocos curtos separados por \"\\n\\n\"**, seguindo o mesmo encadeamento da legenda principal:\n\n1. Contexto e Fato: Conte o que aconteceu, com as informa√ß√µes principais e n√∫meros relevantes (sem termos t√©cnicos dif√≠ceis) e sempre cobrindo todos os pontos da not√≠cia.\n\n2. Simplifica√ß√£o do Tema: Explique com clareza e simplicidade o que √© esse tema (ex: o que √© ICMS? Como funciona o planejamento tribut√°rio? O que s√£o solu√ß√µes de consulta, etc.). Imagine que est√° falando com algu√©m de 18 anos que nunca ouviu falar disso.\n\n3. Impacto no Neg√≥cio: Mostre como a not√≠cia impacta diretamente nos neg√≥cios e empresas: economia tribut√°ria, novos riscos de autua√ß√£o, oportunidades de planejamento, mudan√ßas em regimes de apura√ß√£o, ou ajustes necess√°rios na gest√£o fiscal.\n\n4. Chamada para Reflex√£o: Inclua uma pergunta ou convite leve para o p√∫blico refletir ou comentar. Algo que gere discuss√£o nos coment√°rios, pedindo opini√µes ou levantando uma quest√£o pol√™mica. Uma consultoria tributaria ajudaria em algo?\n\n5. inclua `Fonte:` com o link resumido da not√≠cia\n\n6.  hashtags\n---\n\n### ‚öôÔ∏è Regras\n\n* Tamanho total entre **350 e 400 caracteres** (sem ultrapassar).\n* Inclua sempre as hashtags fixas:\n  `#BMSConsultoriaTribut√°ria #EconomiaTribut√°ria #Economia`\n* Acrescente 2 a 3 hashtags espec√≠ficas ligadas √† not√≠cia (ex: `#SimplesNacional #IRPJ #PISConfis #STF #ReceitaFederal #LucroReal`).\n* Mencione **a fonte** no bloco 5 no formato:\n  `Fonte: {{ $json.link }}`\n* Use \"\\n\\n\" para separar os blocos ‚Äî o texto final precisa ser **compacto, informativo e com ritmo fluido**.\n* Salve no campo \"legenda_x\".\n\n### üß† Exemplo:\n\n\"ATEN√á√ÉO: STF altera entendimento sobre cr√©ditos de PIS/Cofins.\\n\\nEmpresas do Lucro Real ganham espa√ßo para ampliar compensa√ß√µes e reduzir carga tribut√°ria.\\n\\nContadores devem revisar apura√ß√µes e preparar relat√≥rios retroativos.\\n\\nFonte: [https://bit.ly/3Xxyz](https://bit.ly/3Xxyz) #BMSConsultoriaTribut√°ria #EconomiaTribut√°ria #Economia #PISConfis #STF\"\n\nüì¶ Formato de resposta\nRetorne somente o array JSON abaixo, direto (sem explica√ß√µes antes ou depois), Retorne no seguinte formato JSON (precisa retornar exatamente nesse formato com todos esses campos):\n\n[\n  {\n    \"titulo\": \"T√≠tulo magn√©tico para Imagem 1\",\n    \"subtitulo_formatado\": \"Subt√≠tulo complementar em EB Garamond it√°lico\",\n\n    \"titulo_desenvolvimento\": \"Resumo denso e claro da not√≠cia (de 55 a 60 palavras no m√°ximo)\", \n    \"texto_desenvolvimento\": [\n      \"Texto completo do primeiro bloco (bold com it√°lico)...com no m√≠nimo 18 palavras e no m√°ximo 20 palavras\",\n      \"Texto completo do segundo bloco (normal)... com no m√≠nimo 18 palavras e no m√°ximo 20 palavras\", \n      \"Texto completo do terceiro bloco (sublinhado)...com no m√≠nimo 18 palavras e no m√°ximo 20 palavras\"\n    ],\n\n    \"titulo_aplicabilidade\": \"A√ß√£o pr√°tica para o corretor (de 50 a 60 palavras)\",\n    \"texto_aplicabilidade\": [\n      \"Texto do primeiro bloco (bold + it√°lico)...\",\n      \"Texto do segundo bloco (sublinhado)...\",\n      \"Texto do terceiro bloco (normal)...\"\n    ],\n\n    \"param_2\": \"Resumo do bloco Contexto e Fato\",\n    \"param_3\": \"Resumo do bloco Simplificacao do Tema\",\n    \"param_4\": \"Resumo do bloco Impacto no Negocio\",\n\n    \"legenda\": \"Texto completo com at√© 700 caracteres e 3-4 blocos separados por \\\\n\\\\n\",\n    \"legenda_x\": \"Legenda curta para o Twitter (m√°x 280 chars)\",\n    \"imagem\": \"{{ $json.imagem }}\", // Pode ser string vazia - mantenha o valor original\n    \"fonte\": \"{{ $json.link }}\",\n    \"nota\": 0-10\n  }\n]\n\n\n**LEMBRETE FINAL:**\n- Mantenha o campo \"imagem\" exatamente como recebeu (mesmo que vazio)\n- Foque apenas no conte√∫do textual para determinar os textos e legenda\nPerfeito ‚Äî aqui est√° essa instru√ß√£o adaptada para o **setor tribut√°rio**, mantendo o mesmo n√≠vel de exig√™ncia e foco pr√°tico:\n- Sempre prefira explica√ß√µes **completas, t√©cnicas e contextualizadas**, conectando o fato tribut√°rio a **dados concretos**, **normas vigentes** e **impactos reais na gest√£o fiscal**.\n- Evite simplifica√ß√µes superficiais; entregue **an√°lises densas** que ajudem o profissional a **tomar decis√µes estrat√©gicas**, **reduzir riscos** e **aplicar o conhecimento** no dia a dia.\n- Cada bloco deve gerar **valor t√©cnico e aplic√°vel**, com clareza sobre **o que muda**, **quem √© afetado** e **como agir**.\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-3088,736],"id":"12305818-a4f9-4426-8cbd-10acd185240d","name":"AI Agent - Estrutura dos Posts1","onError":"continueRegularOutput"},{"parameters":{"jsCode":"const allNoticias = items.flatMap(item => JSON.parse(item.json.output));\n\nreturn allNoticias.map((noticia, index) => {\n  return {\n    json: {\n      ...noticia\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-2640,736],"id":"8b89c1e3-b291-430d-a052-3b97e43998ba","name":"Estrutura√ß√£o do JSON de sa√≠da2","onError":"continueRegularOutput"},{"parameters":{"content":"# Estrutura√ß√£o dos Posts\n\n### L√≥gica para definir estrutura dos posts. Reescreve t√≠tulo, legenda e prepara JSON para etapas seguintes.","height":704,"width":784},"type":"n8n-nodes-base.stickyNote","position":[-3200,416],"typeVersion":1,"id":"2d45abec-40f0-4045-aea9-e670728652d5","name":"Sticky Note14"},{"parameters":{"content":"# Edi√ß√£o das Imagens\n\n### Todas as transforma√ß√µes necess√°rias para ter a imagem final. \n### Publica√ß√£o da imagem no Github, gera√ß√£o do link p√∫blico da imagem e transforma√ß√£o para base64 (para envio no whatsapp).","height":2288,"width":3680,"color":3},"type":"n8n-nodes-base.stickyNote","position":[-352,-1392],"typeVersion":1,"id":"493742fe-607a-4059-98b2-563daaf0ce0d","name":"Sticky Note15"},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"Basic MDRlZDA4NWYtYmY0OS00MzIyLWExMzEtMzY3ZjA1YmRiOTllOmQ0MzhjODk3LTVlYzctNGMyNS1iMjM0LWY5NGYyNjc1OGRhYQ=="}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"html","value":"={{ $json.html }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1504,368],"id":"4564d5bd-c688-4905-ae0b-2a8ec0868105","name":"HTML > Imagem4","alwaysOutputData":true,"retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file","outputPropertyName":"imagem_final"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1696,368],"id":"868b073d-f526-4861-baa9-7b01e12dfa46","name":"Baixar imagem4"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"BMS","mode":"list","cachedResultName":"BMS","cachedResultUrl":"https://github.com/getmia-ia/BMS"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2048,-64],"id":"6ed367c7-955e-463c-bb08-caf960763424","name":"Salvar imagem no GitHub3","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organiza√ß√£o MIA"}}},{"parameters":{"jsCode":"return items.map(item => {\n  // Pega diretamente do planilha_data (nova estrutura)\n  const planilhaData = item.json.planilha_data;\n  \n  if (!planilhaData) {\n    console.log('Item sem planilha_data:', item.json);\n    return { json: {} }; // ou algum fallback\n  }\n\n  const { \n    noticia_id, \n    data_processamento, \n    titulo, \n    legenda, \n    legenda_x,\n    param_2,\n    param_3,\n    param_4,\n    fonte, \n    imagem, \n    arquivo_base64, \n    arquivo2_base64,\n    arquivo3_base64,\n    imagem_url, \n    imagem_url2, \n    imagem_url3, \n    status,\n    nota \n  } = planilhaData;\n\n  // Verificar se a legenda existe ANTES de usar\n  if (!legenda) {\n    console.log('Item sem legenda:', planilhaData);\n  }\n  \n  return {\n    json: {\n      noticia_id,\n      data_processamento,\n      titulo,\n      legenda: (legenda || '').replace(/\\\\n/g, '\\n\\n'),\n      legenda_x: (legenda_x || '').replace(/\\\\n/g, '\\n\\n'),\n      param_2,\n      param_3,\n      param_4,\n      fonte,\n      imagem,\n      arquivo_base64,\n      arquivo2_base64,    // nome do 2¬∫ arquivo base64\n      arquivo3_base64,    // nome do 3¬∫ arquivo base64  \n      imagem_url,\n      imagem_url2,    \n      imagem_url3,    \n      status_WhatsApp: status,\n      status_X: status,\n      nota\n    }\n  };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4272,112],"id":"595d601f-c332-4b4f-9df0-9242862c2f50","name":"Filtro dos dados consolidados1"},{"parameters":{"content":"# Atualiza√ß√£o Controles e Envio do resultado por Whatsapp\n\n### Atualiza sheets e drive com informa√ß√µes e arquivos importantes\n### Envio do post completo por whatsapp para aprovador","height":976,"width":1264,"color":4},"type":"n8n-nodes-base.stickyNote","position":[3440,-608],"typeVersion":1,"id":"77f84ced-4def-4ad2-a3fa-6006ea8ba87d","name":"Sticky Note16"},{"parameters":{"operation":"crop","dataPropertyName":"imagem_final","width":1080,"height":1350,"options":{"format":"jpeg"}},"type":"n8n-nodes-base.editImage","typeVersion":1,"position":[1872,368],"id":"b8f84010-cfe3-4eb4-81ba-c20ad488f4a3","name":"Cortar imagem 1080x1352"},{"parameters":{"assignments":{"assignments":[{"id":"68aef7bc-9f60-4636-bc5f-06de8889a312","name":"download_url","value":"={{ $json.content.download_url }}","type":"string"},{"id":"ced6761b-f05f-46ce-bc78-64b91037f45e","name":"temp_id","value":"={{ $('temp_id').item.json.temp_id.toString().trim() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2384,112],"id":"822bdf35-61bc-47ff-acf6-73d3708dfa95","name":"Create download_url4"},{"parameters":{"authentication":"oAuth2","resource":"file","owner":{"__rl":true,"value":"getmia-ia","mode":"name"},"repository":{"__rl":true,"value":"BMS","mode":"list","cachedResultName":"BMS","cachedResultUrl":"https://github.com/getmia-ia/BMS"},"filePath":"=images/{{$now.toFormat(\"yyyyMMddHHmmssSSS\")}}.jpg","binaryData":true,"binaryPropertyName":"imagem_final","commitMessage":"Adicionando imagem via n8n"},"type":"n8n-nodes-base.github","typeVersion":1.1,"position":[2032,-1328],"id":"74078067-7a3b-41a3-be8c-25000a188a31","name":"Salvar imagem no GitHub4","webhookId":"af62f61b-1814-4501-9555-097cf9e5e41a","retryOnFail":true,"waitBetweenTries":5000,"credentials":{"githubOAuth2Api":{"id":"hR55JFsx4bIpxagL","name":"GitHub - Organiza√ß√£o MIA"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Coloque os poss√≠veis campos que podem trazer a imagem direto do RSS\nconst possiveisCampos = [\n  $json['media:content']?.url,\n  $json['enclosure']?.url,\n  $json['image'],\n  $json['og:image']\n];\nconst imagemDireta = possiveisCampos.find(x => !!x);\n\nreturn {\n  ...$json,\n  imagem: imagemDireta || '' // Se n√£o tiver, deixa vazio\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-6560,960],"id":"8baadbc6-ba0c-4fce-8be4-bcb7e12e0e0f","name":"Padroniza√ß√£o do campo imagem1","onError":"continueRegularOutput"},{"parameters":{"url":"={{ $json.link }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"User-Agent","value":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-5888,656],"id":"f719340c-ea09-45f3-9893-2d2de61bd1aa","name":"Buscar HTML da not√≠cia1","onError":"continueRegularOutput"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1hqVrO3gl7qnmgBRDNh20zB_VJm7aGigjuJS4rN3S2yA","mode":"list","cachedResultName":"BMS - Controle Journal","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1hqVrO3gl7qnmgBRDNh20zB_VJm7aGigjuJS4rN3S2yA/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"base","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1hqVrO3gl7qnmgBRDNh20zB_VJm7aGigjuJS4rN3S2yA/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{"noticia_id":"={{ $json.noticia_id }}","data_processamento":"={{ $json.data_processamento }}","titulo":"={{ $json.titulo }}","legenda":"={{ $json.legenda }}","fonte":"={{ $json.fonte }}","imagem":"={{ $json.imagem }}","arquivo_base64":"={{ $json.arquivo_base64 }}","arquivo2_base64":"={{ $json.arquivo2_base64 }}","arquivo3_base64":"={{ $json.arquivo3_base64 }}","imagem_url":"={{ $json.imagem_url }}","imagem_url2":"={{ $json.imagem_url2 }}","imagem_url3":"={{ $json.imagem_url3 }}","status":"={{ $json.status }}","nota":"={{ $json.nota }}"},"matchingColumns":[],"schema":[{"id":"noticia_id","displayName":"noticia_id","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"data_processamento","displayName":"data_processamento","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"titulo","displayName":"titulo","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"legenda","displayName":"legenda","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"legenda_x","displayName":"legenda_x","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"param_2","displayName":"param_2","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"param_3","displayName":"param_3","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"param_4","displayName":"param_4","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"fonte","displayName":"fonte","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem","displayName":"imagem","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"arquivo_base64","displayName":"arquivo_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"arquivo2_base64","displayName":"arquivo2_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"arquivo3_base64","displayName":"arquivo3_base64","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"imagem_url","displayName":"imagem_url","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url2","displayName":"imagem_url2","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"imagem_url3","displayName":"imagem_url3","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"status","displayName":"status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"nota","displayName":"nota","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"justificativa","displayName":"justificativa","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"output","displayName":"output","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"X Legenda","displayName":"X Legenda","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[4480,112],"id":"68d0a7ca-47d4-407d-8d54-84a531d23be8","name":"Salvar no Sheets Controle1","credentials":{"googleSheetsOAuth2Api":{"id":"de8CYZ2v6bGWBjAX","name":"Google Sheets - lucas@getmia.com.br"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const dataAgora = new Date();\nconst yyyy = dataAgora.getFullYear();\nconst mm = String(dataAgora.getMonth() + 1).padStart(2, '0');\nconst dd = String(dataAgora.getDate()).padStart(2, '0');\nconst hh = String(dataAgora.getHours()).padStart(2, '0');\nconst min = String(dataAgora.getMinutes()).padStart(2, '0');\nconst ss = String(dataAgora.getSeconds()).padStart(2, '0');\n\n// üîí Gerar um identificador aleat√≥rio curto para evitar colis√µes\nconst rand = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n\nconst base = `noticia_${yyyy}${mm}${dd}_${hh}${min}${ss}_${rand}`;\nconst sequencial = String($input.item.index + 1).padStart(3, '0');\nconst noticia_id = `${base}_${sequencial}`;\n\n// Item atual\nconst item = $input.item.json;\n\n// Fun√ß√£o auxiliar para remover tags HTML e espa√ßos extras\nfunction limparHTML(texto) {\n  if (!texto) return '';\n  return texto\n    .replace(/<[^>]*>/g, '')  // remove todas as tags HTML\n    .replace(/\\s+/g, ' ')     // normaliza espa√ßos\n    .trim();                  // remove espa√ßos das bordas\n}\n\nconst tituloLimpo = limparHTML(item.titulo)\n\n// URLs espec√≠ficas deste item (agora temos 3 imagens)\nconst imagem_url1 = item.download_url || '';\nconst imagem_url2 = item.download_url1 || '';\nconst imagem_url3 = item.download_url2 || '';\n\n// Cria nomes de arquivo para os 3 base64\nconst arquivo_base64 = `${noticia_id}_img1.txt`;\nconst arquivo2_base64 = `${noticia_id}_img2.txt`; \nconst arquivo3_base64 = `${noticia_id}_img3.txt`;\n\nconst statusAtual = item.status || 'aguardando';\n\nconst param_2 = item.param_2 ?? null;\nconst param_3 = item.param_3 ?? null;\nconst param_4 = item.param_4 ?? null;\n\n// Dados para a planilha\nconst planilhaData = {\n  noticia_id: noticia_id,\n  data_processamento: dataAgora.toLocaleDateString('pt-BR'),\n  titulo: tituloLimpo,\n  titulo_desenvolvimento: item.titulo_desenvolvimento || '',\n  titulo_aplicabilidade: item.titulo_aplicabilidade || '',\n  legenda: item.legenda || '',\n  legenda_x: item.legenda_x || '',\n  param_2,\n  param_3,\n  param_4,\n  fonte: item.fonte || '',\n  imagem: item.imagem || '',\n  arquivo_base64,\n  arquivo2_base64,\n  arquivo3_base64,\n  imagem_url: imagem_url1,\n  imagem_url2,\n  imagem_url3,\n  status: statusAtual,\n  status_WhatsApp: statusAtual,\n  status_X: statusAtual,\n  nota: item.nota || '',\n};\n\n// Retorno completo\nreturn {\n  json: {\n    ...item,\n    titulo: tituloLimpo, \n    noticia_id,\n    status: item.status || 'aguardando',\n    imagem_url1,\n    imagem_url2, \n    imagem_url3,\n    imagem_url: imagem_url1,\n    planilha_data: planilhaData,\n    drive_file_1: {\n      file_name: arquivo_base64,\n      file_content: item.base64Image || ''\n    },\n    drive_file_2: {\n      file_name: arquivo2_base64, \n      file_content: imagem_url2 || ''\n    },\n    drive_file_3: {\n      file_name: arquivo3_base64,\n      file_content: imagem_url3 || ''\n    }\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4016,-48],"id":"aa1905e5-097d-4fc6-b2b6-9f4dc8f7705c","name":"Cria√ß√£o Id + Link Github1"},{"parameters":{"mode":"combine","fieldsToMatchString":"temp_id","options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[3168,-688],"id":"093df1f7-8c9c-49ae-832f-ae3d6ac6511f","name":"Merge"}],"connections":{"Schedule Trigger":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]},"No Operation, do nothing":{"main":[[{"node":"RSS Jota Info","type":"main","index":0},{"node":"RSS Agencia Brasil1","type":"main","index":0},{"node":"RSS Conjur","type":"main","index":0},{"node":"RSS STJ Noticias","type":"main","index":0},{"node":"RSS STJ Pesquisa Pronta","type":"main","index":0},{"node":"RSS STJ Informativo de Jurisprudencia","type":"main","index":0},{"node":"RSS STJ Jurisprudencia em Teses","type":"main","index":0},{"node":"RSS Portal Money Times","type":"main","index":0},{"node":"RSS CBIC (C√¢mara Brasileira da Ind√∫stria da Constru√ß√£o)","type":"main","index":0},{"node":"RSS Startupi","type":"main","index":0},{"node":"RSS Globo G1","type":"main","index":0},{"node":"RSS BBC","type":"main","index":0},{"node":"RSS CNN","type":"main","index":0},{"node":"RSS Jornal do Oeste","type":"main","index":0},{"node":"RSS Senado","type":"main","index":0},{"node":"RSS Camara","type":"main","index":0},{"node":"RSS Camara Agro","type":"main","index":0},{"node":"RSS Camara Eleicoes","type":"main","index":0},{"node":"RSS Camara Adm Publica","type":"main","index":0},{"node":"RSS Camara Politica","type":"main","index":0},{"node":"RSS Camara Economia","type":"main","index":0},{"node":"RSS Camara Cidades","type":"main","index":0},{"node":"RSS Agencia Brasil","type":"main","index":0},{"node":"RSS The Guardian","type":"main","index":0},{"node":"RSS nytimes","type":"main","index":0},{"node":"RSS Deutsche Welle","type":"main","index":0},{"node":"RSS Al Jazeera","type":"main","index":0}]]},"Not√≠cias Consolidadas":{"main":[[{"node":"Not√≠cias Consolidadas3","type":"main","index":0}]]},"RSS Portal Money Times":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":7}]]},"RSS CBIC (C√¢mara Brasileira da Ind√∫stria da Constru√ß√£o)":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":8}]]},"RSS Startupi":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":9}]]},"Not√≠cias Consolidadas1":{"main":[[{"node":"Not√≠cias Consolidadas3","type":"main","index":1}]]},"Not√≠cias Consolidadas2":{"main":[[{"node":"Not√≠cias Consolidadas3","type":"main","index":2}]]},"RSS Globo G1":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":0}]]},"RSS Al Jazeera":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":6}]]},"RSS Deutsche Welle":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":5}]]},"RSS nytimes":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":4}]]},"RSS The Guardian":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":3}]]},"RSS Agencia Brasil":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":2}]]},"RSS Camara Cidades":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":1}]]},"RSS Camara Economia":{"main":[[{"node":"Not√≠cias Consolidadas2","type":"main","index":0}]]},"RSS Camara Politica":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":9}]]},"RSS Camara Adm Publica":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":8}]]},"RSS Camara Eleicoes":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":7}]]},"RSS Camara Agro":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":6}]]},"RSS Camara":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":5}]]},"RSS Senado":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":4}]]},"RSS Jornal do Oeste":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":3}]]},"RSS CNN":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":2}]]},"RSS BBC":{"main":[[{"node":"Not√≠cias Consolidadas1","type":"main","index":1}]]},"Not√≠cias Consolidadas3":{"main":[[{"node":"Filtro de data da not√≠cia","type":"main","index":0}]]},"Filtro de data da not√≠cia":{"main":[[{"node":"Code","type":"main","index":0}]]},"RSS Conjur":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":0}]]},"RSS Jota Info":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":1}]]},"RSS Agencia Brasil1":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":2}]]},"RSS STJ Noticias":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":3}]]},"RSS STJ Pesquisa Pronta":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":4}]]},"RSS STJ Jurisprudencia em Teses":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":5}]]},"RSS STJ Informativo de Jurisprudencia":{"main":[[{"node":"Not√≠cias Consolidadas","type":"main","index":6}]]},"Code":{"main":[[{"node":"Padroniza√ß√£o do campo imagem1","type":"main","index":0}]]},"AI Agent - Gerar prompts Unsplash":{"main":[[{"node":"(Desenvolvimento) Buscar Imagem Unsplash","type":"main","index":0},{"node":"(Aplicabilidade) Buscar Imagem Unsplash","type":"main","index":0},{"node":"Precisa do Unsplash?3","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_languageModel","index":0}]]},"Binary > base":{"main":[[{"node":"Merge1","type":"main","index":1}]]},"HTML > Imagem2":{"main":[[{"node":"Baixar imagem2","type":"main","index":0}]]},"Baixar imagem2":{"main":[[{"node":"Cortar imagem 1080x","type":"main","index":0}]]},"Cortar imagem 1080x":{"main":[[{"node":"Binary > base","type":"main","index":0},{"node":"Loop Over Items","type":"main","index":0}]]},"Create download_url1":{"main":[[{"node":"Merge1","type":"main","index":0}]]},"Binary > base1":{"main":[[{"node":"Merge2","type":"main","index":1}]]},"HTML > Imagem3":{"main":[[{"node":"Baixar imagem3","type":"main","index":0}]]},"Baixar imagem3":{"main":[[{"node":"Cortar imagem 1080x1","type":"main","index":0}]]},"Cortar imagem 1080x1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0},{"node":"Binary > base1","type":"main","index":0}]]},"Create download_url3":{"main":[[{"node":"Merge2","type":"main","index":0}]]},"(Desenvolvimento) Cria√ß√£o do HTML da Imagem":{"main":[[{"node":"HTML > Imagem2","type":"main","index":0}]]},"(Aplicabilidade) Cria√ß√£o do HTML da Imagem":{"main":[[{"node":"HTML > Imagem3","type":"main","index":0}]]},"(Introdu√ß√£o) Cria√ß√£o do HTML da Imagem":{"main":[[{"node":"HTML > Imagem4","type":"main","index":0}]]},"(Aplicabilidade) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)1","type":"main","index":0}]]},"(Desenvolvimento) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)1":{"main":[[{"node":"Tem img?1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)":{"main":[[{"node":"Tem img?","type":"main","index":0}]]},"Salvar imagem no GitHub2":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_outputParser","index":0}]]},"Decis√£o de Imagem":{"main":[[{"node":"Tem imagem?","type":"main","index":0},{"node":"Consolidador","type":"main","index":1}]]},"Tem imagem?":{"main":[[{"node":"Analyze image2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Analyze image2":{"main":[[{"node":"Imagem √© boa?","type":"main","index":0}]]},"Imagem √© boa?":{"main":[[{"node":"Precisa do Unsplash?2","type":"main","index":0}],[{"node":"Precisa do Unsplash?","type":"main","index":0}]]},"Consolidador":{"main":[[{"node":"temp_id","type":"main","index":0}]]},"Valida√ß√£o do campo imagem1":{"main":[[{"node":"Backup dados da not√≠cia1","type":"main","index":0}],[{"node":"Analyze image4","type":"main","index":0}]]},"Backup dados da not√≠cia1":{"main":[[{"node":"Buscar HTML da not√≠cia1","type":"main","index":0}]]},"Extrair imagem do HTML1":{"main":[[{"node":"Imagem encontrada?1","type":"main","index":0}]]},"Imagem encontrada?1":{"main":[[{"node":"Analyze image3","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":2}]]},"Analyze image3":{"main":[[{"node":"Imagem √© boa?2","type":"main","index":0}]]},"Salvar imagem gerada":{"main":[[{"node":"Unificar imagem final1","type":"main","index":0}]]},"Analyze image4":{"main":[[{"node":"Imagem √© boa?1","type":"main","index":0}]]},"Salvar imagem gerada6":{"main":[[{"node":"Unificar imagem final1","type":"main","index":3}]]},"Imagem √© boa?1":{"main":[[{"node":"Salvar imagem gerada6","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":4}]]},"Unificar imagem final1":{"main":[[{"node":"Impede que tupla undefined passe para o agente","type":"main","index":0}]]},"Precisa do Unsplash?":{"main":[[{"node":"Consolidador1","type":"main","index":1}]]},"Imagem √© boa?2":{"main":[[{"node":"Salvar imagem gerada","type":"main","index":0}],[{"node":"Unificar imagem final1","type":"main","index":1}]]},"Precisa do Unsplash?2":{"main":[[{"node":"Consolidador1","type":"main","index":0}]]},"Processar Resultado Unsplash (URL)2":{"main":[[{"node":"Merge7","type":"main","index":0}]]},"Precisa do Unsplash?3":{"main":[[{"node":"(Introdu√ß√£o) Buscar Imagem Unsplash","type":"main","index":0}],[{"node":"Merge7","type":"main","index":1}]]},"(Introdu√ß√£o) Buscar Imagem Unsplash":{"main":[[{"node":"Processar Resultado Unsplash (URL)2","type":"main","index":0}]]},"Consolidador1":{"main":[[{"node":"Consolidador","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Create download_url1","type":"main","index":0}],[{"node":"Salvar imagem no GitHub4","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items2":{"main":[[{"node":"Create download_url3","type":"main","index":0}],[{"node":"Salvar imagem no GitHub2","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"temp_id":{"main":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"main","index":0},{"node":"Merge6","type":"main","index":1}]]},"Merge1":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Merge2":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Merge4":{"main":[[{"node":"Merge6","type":"main","index":0}]]},"Merge5":{"main":[[{"node":"Tem todas as imgs?","type":"main","index":0}]]},"Merge6":{"main":[[{"node":"Merge5","type":"main","index":1}]]},"Merge7":{"main":[[{"node":"Tem img?2","type":"main","index":0}]]},"Loop Over Items3":{"main":[[{"node":"Create download_url4","type":"main","index":0}],[{"node":"Salvar imagem no GitHub3","type":"main","index":0}]]},"Wait3":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Tem img?":{"main":[[{"node":"(Desenvolvimento) Cria√ß√£o do HTML da Imagem","type":"main","index":0}]]},"Tem img?1":{"main":[[{"node":"(Aplicabilidade) Cria√ß√£o do HTML da Imagem","type":"main","index":0}]]},"Tem img?2":{"main":[[{"node":"(Introdu√ß√£o) Cria√ß√£o do HTML da Imagem","type":"main","index":0}]]},"Tem todas as imgs?":{"main":[[{"node":"Cria√ß√£o Id + Link Github1","type":"main","index":0}]]},"Think":{"ai_tool":[[{"node":"AI Agent - Gerar prompts Unsplash","type":"ai_tool","index":0}]]},"Filtro Relev√¢ncia1":{"main":[[{"node":"AI Agent - Estrutura dos Posts1","type":"main","index":0}]]},"OpenRouter Chat Model1":{"ai_languageModel":[[{"node":"AI Agent - Avalia√ß√£o das not√≠cias","type":"ai_languageModel","index":0}]]},"AI Agent - Avalia√ß√£o das not√≠cias":{"main":[[{"node":"Estrutura√ß√£o do JSON de sa√≠da1","type":"main","index":0}]]},"Estrutura√ß√£o do JSON de sa√≠da1":{"main":[[{"node":"Filtro Relev√¢ncia1","type":"main","index":0}]]},"Impede que tupla undefined passe para o agente":{"main":[[{"node":"AI Agent - Avalia√ß√£o das not√≠cias","type":"main","index":0}]]},"OpenRouter Chat Model2":{"ai_languageModel":[[{"node":"AI Agent - Estrutura dos Posts1","type":"ai_languageModel","index":0}]]},"Binary > base65":{"main":[[{"node":"Merge4","type":"main","index":1}]]},"AI Agent - Estrutura dos Posts1":{"main":[[{"node":"Estrutura√ß√£o do JSON de sa√≠da2","type":"main","index":0}]]},"Estrutura√ß√£o do JSON de sa√≠da2":{"main":[[{"node":"Decis√£o de Imagem","type":"main","index":0}]]},"HTML > Imagem4":{"main":[[{"node":"Baixar imagem4","type":"main","index":0}]]},"Baixar imagem4":{"main":[[{"node":"Cortar imagem 1080x1352","type":"main","index":0}]]},"Salvar imagem no GitHub3":{"main":[[{"node":"Wait3","type":"main","index":0}]]},"Filtro dos dados consolidados1":{"main":[[{"node":"Salvar no Sheets Controle1","type":"main","index":0}]]},"Cortar imagem 1080x1352":{"main":[[{"node":"Binary > base65","type":"main","index":0},{"node":"Loop Over Items3","type":"main","index":0}]]},"Create download_url4":{"main":[[{"node":"Merge4","type":"main","index":0}]]},"Salvar imagem no GitHub4":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Padroniza√ß√£o do campo imagem1":{"main":[[{"node":"Valida√ß√£o do campo imagem1","type":"main","index":0}]]},"Buscar HTML da not√≠cia1":{"main":[[{"node":"Extrair imagem do HTML1","type":"main","index":0}]]},"Cria√ß√£o Id + Link Github1":{"main":[[{"node":"Filtro dos dados consolidados1","type":"main","index":0},{"node":"Envia base64 para o Drive","type":"main","index":0},{"node":"Envia base64 para o Drive1","type":"main","index":0},{"node":"Envia base64 para o Drive2","type":"main","index":0}]]},"Merge":{"main":[[{"node":"Merge5","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","executionTimeout":-1,"errorWorkflow":"GbORhS24Rzw7hHlt"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Google Sheets Trigger":{"documentId":"1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0","sheetId":0,"lastRevision":271,"lastRevisionLink":"https://docs.google.com/spreadsheets/export?id=1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0&revision=271&exportFormat=xlsx"},"node:Schedule Trigger1":{"recurrenceRules":[]},"node:Trigger nova noticia no sheets":{"documentId":"1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0","sheetId":0,"lastRevision":271,"lastRevisionLink":"https://docs.google.com/spreadsheets/export?id=1fWo0JNzTrseQubx5O31tEJ5Yd4jHKUCGp_9xZMPfec0&revision=271&exportFormat=xlsx"}},"meta":{"templateCredsSetupCompleted":true},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2025-11-04T07:30:50.005-03:00","Readable date":"November 4th 2025, 7:30:50 am","Readable time":"7:30:50 am","Day of week":"Tuesday","Year":"2025","Month":"November","Day of month":"04","Hour":"07","Minute":"30","Second":"50","Timezone":"America/Sao_Paulo (UTC-03:00)"}}]},"versionId":"61c911e1-f36c-4743-8a97-dece802481f9","triggerCount":1,"tags":[]}