{"createdAt":"2025-09-23T19:11:15.982Z","updatedAt":"2025-09-23T19:51:56.443Z","id":"u5GQqFoa8CsR9bmr","name":"Agentes N8N - Finthrix - AI Agent Financeiro","active":false,"isArchived":false,"nodes":[{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Webhook EVO').item.json.body.data.key.id }}","contextWindowLength":100},"id":"b7225d0e-8753-438b-86e9-2a7ef57aeaa0","name":"Postgres Chat Memory","type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.1,"position":[2144,784],"credentials":{"postgres":{"id":"QgjuCQJgHbZ2Q1u8","name":"Postgres - Taysa"}}},{"parameters":{"assignments":{"assignments":[{"id":"6ff66583-af58-40f7-add5-5a911f8d7aa6","name":"Chat Context ","value":"=Entrada do usuário no chat:\n{{ $json.mensagem }}\n\nDetalhes do arquivo enviado:\n{{ $('Webhook EVO').item.json.body.data.message.documentMessage.fileName }}\n\nLegenda do envio do arquivo:\n{{ $('Webhook EVO').item.json.body.data.message.documentMessage.title }}","type":"string"},{"id":"cc079653-0a02-4504-9fe5-81b107fff043","name":"base64","value":"={{ $json.base64 }}","type":"string"}]},"options":{}},"id":"1459583f-3f59-4d16-b520-2d58ab566798","name":"Contexto","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1712,288]},{"parameters":{"content":"## Insere na pasta Extrato","height":300,"width":740,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2944,160],"typeVersion":1,"id":"08fa560e-094d-4534-b10d-6c449ba15d3e","name":"Sticky Note4"},{"parameters":{"content":"## Insere na pasta Conta","height":280,"width":740,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2944,-176],"typeVersion":1,"id":"4522dbec-e991-492b-bbfc-5a0406523891","name":"Sticky Note5"},{"parameters":{"content":"# Chain de Classificação de Tipo de Documento","height":600,"width":560,"color":2},"type":"n8n-nodes-base.stickyNote","position":[2352,-176],"typeVersion":1,"id":"adad8114-8cde-4c9c-92ff-0d5732539b82","name":"Sticky Note2"},{"parameters":{"content":"","height":220,"width":1000,"color":3},"type":"n8n-nodes-base.stickyNote","position":[1920,448],"typeVersion":1,"id":"333ce189-b976-4b5a-b270-cd4579339ce4","name":"Sticky Note8"},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $('Faz Upload do Arquivo Enviado para o Drive Google').item.json.id }}","mode":"id"},"driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"value":"1J6EJw7gph4CG31bG8LKywEtDg3l3t74m","mode":"list","cachedResultName":"Contas e Faturas","cachedResultUrl":"https://drive.google.com/drive/folders/1J6EJw7gph4CG31bG8LKywEtDg3l3t74m"}},"id":"bca658ad-8568-4cd0-ac16-ff7dc98d13db","name":"Envia para Pasta Conta","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3040,-96],"credentials":{"googleDriveOAuth2Api":{"id":"8G4VgOQRG6X5KJnF","name":"Google Drive account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4350c715-0610-4dfb-b727-1663d4866a62","leftValue":"={{ $json.telefone }}","rightValue":"553492150692@s.whatsapp.net","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1472,288],"id":"d9795235-5710-48f4-bccf-8cb2c20f5e53","name":"Verifica se sou Eu"},{"parameters":{"httpMethod":"POST","path":"finThrix","options":{}},"id":"73aa3d60-1e88-44f6-b433-bc5d04e26483","name":"Webhook EVO","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[784,288],"webhookId":"487f4c9f-b2ff-4f21-9600-5c1f463aaee4"},{"parameters":{"content":"# Entrada","height":300,"width":1160},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[720,208],"id":"4918ef3e-593c-47c6-85a3-93a342100226","name":"Sticky Note12"},{"parameters":{"content":"## Ferramentas","height":220,"width":620,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2320,720],"id":"d5500d03-1d1d-4b0a-b3c7-20d85afcdeac","name":"Sticky Note1"},{"parameters":{"content":"## LLM e Memória","height":220,"width":380,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1920,720],"id":"68adfb41-0812-4d6a-a281-867de7dc0687","name":"Sticky Note3"},{"parameters":{},"id":"447df6e0-a769-4a54-92fe-8d72a3b4985c","name":"Não fazer nada","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[2128,288]},{"parameters":{"name":"={{ $('Busca Base64 da Evo').item.json.fileName }}","driveId":{"__rl":true,"value":"My Drive","mode":"list","cachedResultName":"My Drive","cachedResultUrl":"https://drive.google.com/drive/my-drive"},"folderId":{"__rl":true,"value":"1dD-20isU0oweTt1QnHBlfag2EyFHXt_P","mode":"list","cachedResultName":"FinThrix","cachedResultUrl":"https://drive.google.com/drive/folders/1dD-20isU0oweTt1QnHBlfag2EyFHXt_P"},"options":{}},"id":"203da48c-4b59-45e1-a12c-e6ba6fd7dcf1","name":"Faz Upload do Arquivo Enviado para o Drive Google","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[2160,48],"credentials":{"googleDriveOAuth2Api":{"id":"8G4VgOQRG6X5KJnF","name":"Google Drive account"}},"onError":"continueRegularOutput"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.output.arquivo_enviado }}","rightValue":"conta","operator":{"type":"string","operation":"equals"},"id":"8e988440-dc02-42d0-b4ff-a1b460b2ca88"}],"combinator":"and"},"renameOutput":true,"outputKey":"Conta"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05535ced-ea7d-42ac-8cb3-ef4415425a56","leftValue":"={{ $json.output.arquivo_enviado }}","rightValue":"extrato","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Extrato"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[2784,48],"id":"f5a3fc6c-6461-41c5-8b3c-ca973c54c3b7","name":"Roteador"},{"parameters":{"content":"## Saída para o Usuário via WhatsApp","height":300,"width":420,"color":4},"type":"n8n-nodes-base.stickyNote","position":[2960,496],"typeVersion":1,"id":"97871450-d684-4217-b9b1-e41a352e04eb","name":"Sticky Note6"},{"parameters":{"content":"","height":1480,"width":3240,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[672,-480],"id":"0e76bb7c-ecf2-45ca-9c57-8d90fcfeca5b","name":"Sticky Note7"},{"parameters":{"promptType":"define","text":"=Seu papel é determinar a intenção da mensagem por meio das solicitações ou comandos na mensagem do usuário fornecida a você da seguinte forma:\n{{ $json['Chat Context '] }}\n\nSe o usuário não especificar um comando ou solicitação para executar alguma tarefa utilizável com as ferramentas disponíveis, mas apenas enviar um arquivo ou documento, responda que o arquivo ou documento foi enviado com sucesso para o repositório apropriado.\n\nSe o usuário não enviar nenhum arquivo ou documento, mas especificar um comando ou solicitação para executar uma tarefa, execute a solicitação ou comando utilizando as ferramentas disponíveis para você.\n\nPense cuidadosamente sobre quais ferramentas específicas utilizar com base no contexto fornecido pela entrada do usuário.\n\nLembre-se sempre de ser polido e falar com o usuário assumindo o seu papel como um contador.","options":{"systemMessage":"=**OBJETIVO**\n\nÉ um útil contador de IA chamado FinThrix. Está a falar com o utilizador chamado `{{ $('Webhook EVO').item.json.body.data.pushName }}`. Hoje é {{ $now.format('dd/MM/yyyy') }}\n\nChame sempre o utilizador pelo nome (se o nome do utilizador for fornecido).\n\nA sua função é interpretar as mensagens dos utilizadores de uma integração de chat do Telegram e executar tarefas com precisão, utilizando as ferramentas disponíveis. Determinará a intenção do utilizador e acionará as ações (tools) apropriadas, tais como: IncluirMovimentacao, IncluirConta, ResumidorFinanceiro e outras ferramentas personalizadas fornecidas.\n\nTambém pode capturar arquivos de transações bancárias ou documentos de contas/faturas quando o utilizador carregar qualquer fatura/conta válida ou documento de extrato bancário na interface de chat do WhatsApp.\n\n*Importante*:\nAo responder ao utilizador, mantenha uma atitude profissional e amigável. \nUse emojis caso achar necessário para deixar a conversa mais leve!\n\n---\n**PERSONALIDADE E COMPORTAMENTOS para o FinThrix**\n\n*Nome*: FinThrix\n*Função*: Assistente Pessoal\n*Sexo: Masculino\n*Traços de personalidade*: prestável, profissional, envolvente, organizado, empático\n\nO FinThrix é uma contabilista pessoal altamente eficiente e intuitiva. Mantém uma postura profissional, esforçando-se sempre para atender às necessidades dos seus utilizadores com um suporte rápido, preciso e personalizado. Embora seja detalhista e metódico na sua abordagem, FinThrix acrescenta um toque caloroso e envolvente a cada interação, fazendo com que os seus utilizadores se sintam valorizados e compreendidos.\n\nFinThrix é proativo na antecipação de necessidades, organizado na gestão de tarefas e empático na abordagem das preocupações dos utilizadores. Seja para resumir registos financeiros, registar novas movimentações e faturas ou fornecer relatórios e atualizações financeiras, ele equilibra o profissionalismo com uma atitude amigável e acessível. Os utilizadores devem sentir que não têm apenas um assistente capaz, mas um parceiro que realmente compreende os seus objetivos e necessidades.\n\n*Características principais*:\n- Altamente organizado e focado nos detalhes\n- Estilo de comunicação amigável e acessível\n- Profissional, mas identificável\n- Antecipa as necessidades do utilizador e oferece suporte proativamente\n- Empático e atento às preocupações ou preferências do utilizador\n\n---\n**INTEGRAÇÃO DE FERRAMENTAS**\nPode executar diversas ações através das seguintes ferramentas:\n\n - IncluirMovimentacao: captura detalhes de transações recentes efetuadas pelo utilizador envolvendo compras, PIX, pagamentos e outras atividades financeiras e regista a informação numa base de dados de registos de transações do Google Sheets.\n - IncluirConta: Adiciona um novo registo de fatura ou conta à base de dados de faturas/contas do Google Sheets.\n - ResumidorFinanceiro: Gera relatórios financeiros que resumem a saúde financeira do cliente, como atualizações de receitas e despesas para uma data ou período especificado.\n\n---\n\n**CONTEÚDO**\nEstá integrado num fluxo de trabalho onde os utilizadores interagem via WhatsApp para automatizar diversas tarefas. Tem acesso a diversas ferramentas, tais como:\n\n- **IncluirMovimentacao**: utilize para atualizar o registo de transações e movimentações, seja de dinheiro, PIX ou cartão de crédito de uma base de dados do Google Sheets que rastreia as atividades financeiras.\n\nO Agente de IA deve fornecer saída no seguinte formato com base na mensagem do utilizador:\n - data: data da transação/movimentação\n - descrição: Descrição da transação/movimentação ou detalhes\n - categoria: categoriza cada transação em dois tipos: entrada ou saída\n - crédito: Valor total da receita ou do fluxo de caixa recebido\n - débito: Valor total das Despesas efetuadas\n\n- **IncluirConta**: recupera os dados da fatura da mensagem do utilizador, como a data da fatura, o número da fatura, o valor da fatura e as informações de fatura que são enviadas via PDF, e regista os dados na base de dados do Google Sheets para faturas.\n\n- **ResumidorFinanceiro**: gera um resumo das transações para uma data específica. O Agente de IA deve fornecer saída no seguinte formato para ser utilizado no nó de ferramenta para gerar a resposta:\n** - data: data ou período da transação sempre no formato mm/yyyy**\n - categoria: a categoria utilizada para filtrar o relatório (por exemplo, entradas no mês de novembro de 2024). Importante: Caso a informação venha apenas para fazer um resumo do mês vc deve colocar a categoria como null. Caso seja solicitada, informações de entradas ou saídas, categorize.\n\n- **Processar documentos financeiros**: automatize a captura de dados e o registo de extratos bancários e faturas enviados pelo utilizador através da interface de chat.\n\n- **Outras ferramentas personalizadas**: Podem ser adicionadas novas ferramentas para lidar com tarefas adicionais.\n\nAs intenções do utilizador podem incluir o registo de uma transação recente, o registo de uma nova fatura e a anexação dos novos dados à base de dados de faturas ou o pedido de resumos financeiros de receitas e despesas. O chat do WhatsApp é a interface principal para receber estes pedidos.\n\n---\n\n**INSTRUÇÕES**\n1. **Análise de intenções**: analise as mensagens recebidas dos utilizadores do WhatsApp para compreender a sua intenção.\n2. **Integração de ferramentas**: Com base na intenção, escolha a ferramenta mais adequada que recebeu ou tem acesso para executar várias ações.\n - Se o utilizador solicitar a adição de uma nova transação, PIX ou atividade de despesa, acione a ferramenta IncluirMovimentacao e certifique-se de que o utilizador especificou as seguintes informações necessárias: Data da transação, Descrição da transação, Categoria da transação (Rendimento, Despesas essenciais ou Despesas não essenciais), Valor do crédito (se for uma transação de rendimento), Valor do débito (se forem compras ou transações relacionadas com despesas)\n - Caso o utilizador solicite o registo de uma nova fatura, acione a ferramenta IncluirConta.\n - Caso o utilizador solicite o resumo das suas despesas de um mês ou período específico, acione a ferramenta ResumidorFinanceiro.\n\nIMPORTANTE: Quando o utilizador não fornece informação suficiente para executar uma determinada tarefa, oriente-o e peça-lhe que forneça mais informação necessária para completar cada tarefa.\n3. **Executar ações**: execute a ferramenta selecionada com precisão e eficiência com base no pedido do utilizador.\n4. **Confirmação e feedback**: forneça feedback claro ao utilizador após a conclusão de cada tarefa, confirmando as ações ou resumindo os resultados utilizando as respostas das ferramentas chamadas.\n5. **Tratamento de erros**: se o pedido do utilizador não puder ser atendido ou a intenção não for clara, peça esclarecimentos e oriente o utilizador para reformular o seu pedido.\n\n6. **Instruções de formatação**\n - Na sua resposta, envie sempre uma mensagem no formato suportado pelo WhatsApp.\n - As seguintes tags são atualmente suportadas:\n*Negrito*: *negrito*\n_Itálico_: _itálico_\n~Tachado~: ~tachado~\n\nSublinhado não é suportado no WhatsApp.\nSpoiler não é suportado no WhatsApp.\nHTML não é suportado.\n\nExemplo combinado de formatação:\n*negrito _itálico negrito ~itálico negrito tachado~_ negrito*\n\nLink direto (sem texto personalizado):\nhttps://www.exemplo.com\n\nCódigo em linha:\n`código de largura fixa`\n\nBloco de código:\nObservações:\n- Qualquer código que você queira mostrar deve ser enviado entre três crases (\\`\\`\\`) para aparecer formatado.\n- No WhatsApp, não é possível usar tags HTML como <b>, <i>, <s> etc.\n- Use apenas *asteriscos*, _underscores_, ~tils~ e crases \\` para formatações básicas.\n- Sempre substitua os caracteres especiais (<, >, &) pelas versões literais se quiser mostrá-los como texto.\n\n---\n\n**REQUISITOS DE SAÍDA**\n- Executar tarefas solicitadas pelo utilizador com as ferramentas adequadas, concluindo as ações com eficiência.\n- Forneça resumos concisos ou confirmações ao utilizador através do WhatsApp.\n- Se alguma tarefa não for bem-sucedida, forneça uma mensagem de erro útil e acionável.\n- Garanta que o histórico de chat é registado e armazenado no armazenamento de memória disponível que lhe é fornecido\n\n---\n\n**EXEMPLOS**\n\n1. **Mensagem do utilizador**: \"carregue este documento para mim.\"\n **Ações**:\n - Intenção: Carregar um documento ou um arquivo\n - Ferramenta:\n - Saída: É enviada uma confirmação ao utilizador de que o arquivo ou documento foi carregado para a pasta correta.\n\n2. **Mensagem do utilizador**: \"Fiz uma compra de 3 donuts que me custaram 25,00 reais esta manhã. Podem registar esta transação para mim?.\"\n **Ações**:\n- Envia nesse formato: \n\n{\n\"data_transacao\": \"01/05/2024\",\n\"transacao\": \"Almoço\",\n\"categoria\": \"saída\",\n\"entrada\": 0,\n\"saida\": 25\n}\n\n- Quando informado: gasto, perda, prejuizo ou negativos, envio de PIX, passei o cartão de crédito, paguei uma conta ou um boleto adicione como saida\n- Quando informado: ganho, lucro, recebimentos, adicione como entrada\n- Intenção: Registar nova transação de despesa.\n - Ferramenta: IncluirMovimentacao.\n - Saída: É enviada uma confirmação ao utilizador de que a compra recente de donuts foi adicionada ao registo da transação.\n\n3. **Mensagem do utilizador**: \"Adicione esta fatura ao nosso registo com os seguintes dados: a data da fatura é 1 de outubro de 2024, o número da fatura é 123456, no valor de 500,00 reais e faturada à Synthrop AI\"\n **Ações**:\n - Intenção: Adicionar um novo registo de fatura.\n - Ferramenta: IncluirConta.\n - Saída: É enviada uma confirmação ao utilizador de que foi adicionada uma nova fatura.\n\n4. **Mensagem do utilizador**: \"Quanto gastei no mês passado?\"\n **Ações**:\n- Envia nesse formato: \n\n{\n  \"data\": \"01/2024\",\n  \"categoria\": \"saída\"\n}\n - Intenção: Resumir as Despesas.\n - Ferramenta: ResumidorFinanceiro.\n - Output: Retorna a resposta do workflow da ferramenta ResumidorFinanceiro.\nImportante: Caso a informação venha apenas para fazer um resumo do mês vc deve colocar a categoria como null.Caso seja informado se seja informações de entradas ou saídas, categorize.","returnIntermediateSteps":true}},"id":"3404dfaa-cba0-48ba-942e-e1af8268f1b5","name":"🤖 FinThrix💰📊","type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.6,"position":[2240,496]},{"parameters":{"promptType":"define","text":"={{ $('Seta os dados de Entrada1').item.json.mensagem }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"Seu papel é identificar a intenção do usuário com base em duas categorias:  atualizar_fatura: Se o usuário explicitamente indicar que deseja enviar um documento de conta ou fatura na mensagem ou interação atual do chat, ou se o nome do arquivo do documento contiver 'conta' ou 'fatura'. atualiza_extrato_bancario: Se o usuário explicitamente indicar que deseja enviar um documento de extrato bancário na mensagem ou interação atual do chat, ou se o nome do arquivo do documento contiver 'extrato bancario'."},{"type":"HumanMessagePromptTemplate","message":"=Identifique a intenção usando as seguintes informações recebidas do usuário:\n\nMensagem do usuário no chat: {{ $('Seta os dados de Entrada1').item.json.mensagem }}\nNome do arquivo: {{ $json.name }}\nLegenda do envio do arquivo: {{ $('Webhook EVO').item.json.body.data.message.documentMessage.title }}\n\nLembre-se que quando vier uma fatura, boleto conta, vc deve assumir que é uma conta.\nE quando vier algo como extrato vc deve assumir que é um extrato bancário"}]}},"id":"730132f4-a268-4317-8cc7-669f53b18344","name":"📑Identificador 🤑","type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.4,"position":[2432,48]},{"parameters":{"name":"IncluirMovimentacao","description":"Chame essa tool para atualizar a planilha do google sheets com todas as entradas e saídas, gastos ou ganhos, perdas ou lucros. ","workflowId":{"__rl":true,"value":"L4CoBclNyB3SP5AH","mode":"list","cachedResultName":"Agentes N8N - FinThrix - Inclui Movimentacao"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n\t\"data_transacao\": {\n\t\t\"type\": \"date\"\n    },\n   \"transacao\": {\n       \"type\": \"string\"\n    },\n   \"categoria\": {\n       \"type\": \"string\"\n    },\n    \"entrada\": {\n      \"type\": \"number\"\n    },\n    \"saida\": {\n      \"type\": \"number\"\n    }\n  }\n}"},"id":"0e8e91c7-d15e-43fd-bd67-fb8bdae8fa5f","name":"IncluiMovimentacao","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[2512,800]},{"parameters":{"name":"IncluirConta","description":"Chame esta ferramenta para registrar uma conta e atualizar um banco de dados do Google Sheets chamado Contas.\n\n","workflowId":{"__rl":true,"value":"zne6ueFf5xBpLh3H","mode":"list","cachedResultName":"Agentes N8N - FinThrix - Inclui Conta"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n\t\"data_fatura\": {\n\t\t\"type\": \"date\"\n    },\n    \"numero_fatura\": {\n        \"type\": \"number\"\n    },\n    \"valor_total\": {\n        \"type\": \"number\"\n    },\n    \"destinatario\": {\n        \"type\": \"string\"\n    }\n  }\n}"},"id":"1a0a7219-fa90-4119-b2de-6cac30b50900","name":"IncluiConta","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[2656,800]},{"parameters":{"name":"ResumidorFinanceiro","description":"Chame esta ferramenta para gerar um relatório ou resumo das informações financeiras a partir de um banco de dados do Google Sheets com registros de transações.\n\nutilize apenas o formato mm/yyyy","workflowId":{"__rl":true,"value":"KryhuPU8sL8bzu6q","mode":"list","cachedResultName":"Agentes N8N - FinThrix - Resumidor Relatorio Financeiro"},"specifyInputSchema":true,"schemaType":"manual","inputSchema":"{\n\"type\": \"object\",\n\"properties\": {\n  \"data\": \"02/2024\",\n  \"categoria\": \"Saída\"\n}\n}"},"id":"e09b70f7-d8a6-448a-9e21-2e439b50b639","name":"ResumidorFinanceiro","type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":1.2,"position":[2800,800]},{"parameters":{"resource":"messages-api","instanceName":"pessoal-taysa","remoteJid":"={{ $('Seta os dados de Entrada1').first().json.telefone }}","messageText":"={{ $json.output }}","options_message":{"linkPreview":false}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[3120,592],"id":"f40c855e-1533-407a-8a17-8f842cb2d191","name":"Envia mensagem no WhatsApp","credentials":{"evolutionApi":{"id":"C4D933bAuIRLg3yb","name":"Evolution account 2"}}},{"parameters":{"resource":"messages-api","instanceName":"pessoal-taysa","remoteJid":"={{ $('Seta os dados de Entrada1').first().json.telefone }}","messageText":"={{ $json.response }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[3712,96],"id":"c20357c6-993d-4750-adde-a39fa074851b","name":"Informa Retorno via WhatsApp","credentials":{"evolutionApi":{"id":"C4D933bAuIRLg3yb","name":"Evolution account 2"}}},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $('Faz Upload do Arquivo Enviado para o Drive Google').item.json.id }}","mode":"id"},"driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"value":"1XC7oKSUmvkApTbqVcDPkZPJh9nAawKDb","mode":"list","cachedResultName":"Extratos","cachedResultUrl":"https://drive.google.com/drive/folders/1XC7oKSUmvkApTbqVcDPkZPJh9nAawKDb"}},"id":"d3f2937b-6020-4af0-b1ed-898f7ac3cc82","name":"Envia para Pasta Extratos","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[3040,256],"credentials":{"googleDriveOAuth2Api":{"id":"8G4VgOQRG6X5KJnF","name":"Google Drive account"}}},{"parameters":{"assignments":{"assignments":[{"id":"adeaacb1-54f2-48db-b107-5bf2a55da53a","name":"response","value":"Arquivo enviado para a pasta 🗂️ de Contas e Faturas no Google Drive","type":"string"}]},"options":{}},"id":"0ef7aa9a-2919-4f84-a8a3-66287da1ed4a","name":"Seta Mensagem de Retorno","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[3264,-96]},{"parameters":{"assignments":{"assignments":[{"id":"29b48128-1e96-4ce3-9979-d9c1a7e442cf","name":"response","value":"Arquivo enviado para a pasta 🗂️ de Extratos no Google Drive.","type":"string"}]},"options":{}},"id":"dbdbfe17-b0fe-430d-8250-03e830e65467","name":"Seta Mensagem de Retorno1","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[3280,256]},{"parameters":{"schemaType":"manual","inputSchema":"{\n    \"type\": \"object\",\n    \"properties\": {\n        \"arquivo_enviado\": {\n            \"type\": \"string\",\n            \"enum\": [\"conta\", \"extrato\"]\n        }\n    }\n}\n"},"id":"4859b10a-103f-4323-a572-776ef0d394c8","name":"Estrutura do Retorno","type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[2624,256]},{"parameters":{},"id":"ba3c3f8e-ec5b-48bf-b008-2d8fb29dc084","name":"Calculadora","type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[2352,800]},{"parameters":{"method":"POST","url":"={{ $json.body.server_url }}/chat/getBase64FromMediaMessage/{{ $json.body.instance }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"={{ $json.body.apikey }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"message\": {\n    \"key\": {\n      \"id\": \"{{ $json.body.data.key.id }}\"\n    }\n  }\n} ","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1024,288],"id":"63a0829a-c371-4f1c-8602-d5933c9c002e","name":"Busca Base64 da Evo","onError":"continueRegularOutput"},{"parameters":{"operation":"toBinary","sourceProperty":"base64","binaryPropertyName":"=data","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1984,48],"id":"acf4bb6e-f439-444f-b848-7c33c767901c","name":"Convert to File","onError":"continueRegularOutput"},{"parameters":{"operation":"executeQuery","query":"DELETE FROM N8N_CHAT_HISTORIES","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1536,-48],"id":"c482246c-d714-48cc-ae70-b8a948df46d6","name":"Limpa - chat_histories","credentials":{"postgres":{"id":"QgjuCQJgHbZ2Q1u8","name":"Postgres - Taysa"}},"disabled":true},{"parameters":{"content":"## Limpa históricos","height":300,"width":320,"color":7},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1456,-160],"id":"7b3f2891-9e7d-4471-b556-a9721905dcd2","name":"Sticky Note10"},{"parameters":{"content":"# Tratamento quando recebe arquivo","height":600,"width":420,"color":5},"type":"n8n-nodes-base.stickyNote","position":[1920,-176],"typeVersion":1,"id":"22ce4b98-a983-44ab-915b-1f2778da4bb0","name":"Sticky Note11"},{"parameters":{"assignments":{"assignments":[{"id":"23696d7e-9eef-4ee6-8f3e-f8edb8ab8336","name":"telefone","value":"={{ $('Webhook EVO').item.json.body.data.key.remoteJid }}","type":"string"},{"id":"0ff79119-7dc9-40fa-a31a-babe42b91e41","name":"mensagem","value":"={{ $('Webhook EVO').item.json.body.data.message.conversation }}","type":"string"},{"id":"0c497e70-deb4-4278-b613-d87127bbf972","name":"base64","value":"={{ $json.base64 }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1264,288],"id":"cefa70be-dcb6-46a1-9b15-42e026f0a71c","name":"Seta os dados de Entrada1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[2416,240],"id":"922ce311-f9fa-4d71-8f65-a55ddc78caf7","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"v6lUW97jyBi9uG5M","name":"Google Gemini(PaLM) Api - Taysa"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[1984,800],"id":"19c83262-5dd7-4483-8117-2fdfcde583c4","name":"Google Gemini Chat Model1","credentials":{"googlePalmApi":{"id":"v6lUW97jyBi9uG5M","name":"Google Gemini(PaLM) Api - Taysa"}}},{"parameters":{"content":"███████╗██╗███╗░░██╗████████╗██╗░░██╗██████╗░██╗██╗░░██╗  ░░░░░░  ░█████╗░██╗  ░█████╗░░██████╗░███████╗███╗░░██╗████████╗  ███████╗██╗███╗░░██╗░█████╗░███╗░░██╗░█████╗░███████╗██╗██████╗░░█████╗░\n██╔════╝██║████╗░██║╚══██╔══╝██║░░██║██╔══██╗██║╚██╗██╔╝  ░░░░░░  ██╔══██╗██║  ██╔══██╗██╔════╝░██╔════╝████╗░██║╚══██╔══╝  ██╔════╝██║████╗░██║██╔══██╗████╗░██║██╔══██╗██╔════╝██║██╔══██╗██╔══██╗\n█████╗░░██║██╔██╗██║░░░██║░░░███████║██████╔╝██║░╚███╔╝░  █████╗  ███████║██║  ███████║██║░░██╗░█████╗░░██╔██╗██║░░░██║░░░  █████╗░░██║██╔██╗██║███████║██╔██╗██║██║░░╚═╝█████╗░░██║██████╔╝██║░░██║\n██╔══╝░░██║██║╚████║░░░██║░░░██╔══██║██╔══██╗██║░██╔██╗░  ╚════╝  ██╔══██║██║  ██╔══██║██║░░╚██╗██╔══╝░░██║╚████║░░░██║░░░  ██╔══╝░░██║██║╚████║██╔══██║██║╚████║██║░░██╗██╔══╝░░██║██╔══██╗██║░░██║\n██║░░░░░██║██║░╚███║░░░██║░░░██║░░██║██║░░██║██║██╔╝╚██╗  ░░░░░░  ██║░░██║██║  ██║░░██║╚██████╔╝███████╗██║░╚███║░░░██║░░░  ██║░░░░░██║██║░╚███║██║░░██║██║░╚███║╚█████╔╝███████╗██║██║░░██║╚█████╔╝\n╚═╝░░░░░╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚═╝░░╚═╝╚═╝░░╚═╝╚═╝╚═╝░░╚═╝  ░░░░░░  ╚═╝░░╚═╝╚═╝  ╚═╝░░╚═╝░╚═════╝░╚══════╝╚═╝░░╚══╝░░░╚═╝░░░  ╚═╝░░░░░╚═╝╚═╝░░╚══╝╚═╝░░╚═╝╚═╝░░╚══╝░╚════╝░╚══════╝╚═╝╚═╝░░╚═╝░╚════╝░","width":2020},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1232,-416],"id":"3f3b55a9-521b-49cf-b5ba-39c6acbbc665","name":"Sticky Note9"}],"connections":{"Postgres Chat Memory":{"ai_memory":[[{"node":"🤖 FinThrix💰📊","type":"ai_memory","index":0}]]},"Contexto":{"main":[[{"node":"🤖 FinThrix💰📊","type":"main","index":0},{"node":"Convert to File","type":"main","index":0}]]},"Envia para Pasta Conta":{"main":[[{"node":"Seta Mensagem de Retorno","type":"main","index":0}]]},"Verifica se sou Eu":{"main":[[{"node":"Contexto","type":"main","index":0}]]},"Webhook EVO":{"main":[[{"node":"Busca Base64 da Evo","type":"main","index":0}]]},"Faz Upload do Arquivo Enviado para o Drive Google":{"main":[[{"node":"📑Identificador 🤑","type":"main","index":0}],[{"node":"Não fazer nada","type":"main","index":0}]]},"Roteador":{"main":[[{"node":"Envia para Pasta Conta","type":"main","index":0}],[{"node":"Envia para Pasta Extratos","type":"main","index":0}]]},"🤖 FinThrix💰📊":{"main":[[{"node":"Envia mensagem no WhatsApp","type":"main","index":0}]]},"📑Identificador 🤑":{"main":[[{"node":"Roteador","type":"main","index":0}]]},"IncluiMovimentacao":{"ai_tool":[[{"node":"🤖 FinThrix💰📊","type":"ai_tool","index":0}]]},"IncluiConta":{"ai_tool":[[{"node":"🤖 FinThrix💰📊","type":"ai_tool","index":0}]]},"ResumidorFinanceiro":{"ai_tool":[[{"node":"🤖 FinThrix💰📊","type":"ai_tool","index":0}]]},"Envia para Pasta Extratos":{"main":[[{"node":"Seta Mensagem de Retorno1","type":"main","index":0}]]},"Seta Mensagem de Retorno":{"main":[[{"node":"Informa Retorno via WhatsApp","type":"main","index":0}]]},"Seta Mensagem de Retorno1":{"main":[[{"node":"Informa Retorno via WhatsApp","type":"main","index":0}]]},"Estrutura do Retorno":{"ai_outputParser":[[{"node":"📑Identificador 🤑","type":"ai_outputParser","index":0}]]},"Calculadora":{"ai_tool":[[{"node":"🤖 FinThrix💰📊","type":"ai_tool","index":0}]]},"Busca Base64 da Evo":{"main":[[{"node":"Seta os dados de Entrada1","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Faz Upload do Arquivo Enviado para o Drive Google","type":"main","index":0}]]},"Seta os dados de Entrada1":{"main":[[{"node":"Verifica se sou Eu","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"📑Identificador 🤑","type":"ai_languageModel","index":0}]]},"Google Gemini Chat Model1":{"ai_languageModel":[[{"node":"🤖 FinThrix💰📊","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"e9f27d69-88a4-4403-a62a-d0c653625c61","triggerCount":0,"tags":[]}